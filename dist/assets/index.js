var wc=Object.defineProperty,Ec=Object.defineProperties;var Cc=Object.getOwnPropertyDescriptors;var kr=Object.getOwnPropertySymbols;var Sc=Object.prototype.hasOwnProperty,kc=Object.prototype.propertyIsEnumerable;var Tr=(re,V,q)=>V in re?wc(re,V,{enumerable:!0,configurable:!0,writable:!0,value:q}):re[V]=q,Bn=(re,V)=>{for(var q in V||(V={}))Sc.call(V,q)&&Tr(re,q,V[q]);if(kr)for(var q of kr(V))kc.call(V,q)&&Tr(re,q,V[q]);return re},Dr=(re,V)=>Ec(re,Cc(V));var g=(re,V,q)=>new Promise((xe,G)=>{var Z=U=>{try{Pe(q.next(U))}catch(M){G(M)}},yt=U=>{try{Pe(q.throw(U))}catch(M){G(M)}},Pe=U=>U.done?xe(U.value):Promise.resolve(U.value).then(Z,yt);Pe((q=q.apply(re,V)).next())});(function(){"use strict";function re(n,t){for(var e=0;e<t.length;e++){const i=t[e];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in n)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}var V=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],q={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(n){return typeof console!="undefined"&&console.warn(n)},getWeek:function(n){var t=new Date(n.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var e=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-e.getTime())/864e5-3+(e.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},xe={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(n){var t=n%100;if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},G=function(n,t){return t===void 0&&(t=2),("000"+n).slice(t*-1)},Z=function(n){return n===!0?1:0};function yt(n,t){var e;return function(){var i=this,r=arguments;clearTimeout(e),e=setTimeout(function(){return n.apply(i,r)},t)}}var Pe=function(n){return n instanceof Array?n:[n]};function U(n,t,e){if(e===!0)return n.classList.add(t);n.classList.remove(t)}function M(n,t,e){var i=window.document.createElement(n);return t=t||"",e=e||"",i.className=t,e!==void 0&&(i.textContent=e),i}function bt(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function qn(n,t){if(t(n))return n;if(n.parentNode)return qn(n.parentNode,t)}function wt(n,t){var e=M("div","numInputWrapper"),i=M("input","numInput "+n),r=M("span","arrowUp"),s=M("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?i.type="number":(i.type="text",i.pattern="\\d*"),t!==void 0)for(var a in t)i.setAttribute(a,t[a]);return e.appendChild(i),e.appendChild(r),e.appendChild(s),e}function se(n){try{if(typeof n.composedPath=="function"){var t=n.composedPath();return t[0]}return n.target}catch(e){return n.target}}var zt=function(){},Et=function(n,t,e){return e.months[t?"shorthand":"longhand"][n]},Ar={D:zt,F:function(n,t,e){n.setMonth(e.months.longhand.indexOf(t))},G:function(n,t){n.setHours((n.getHours()>=12?12:0)+parseFloat(t))},H:function(n,t){n.setHours(parseFloat(t))},J:function(n,t){n.setDate(parseFloat(t))},K:function(n,t,e){n.setHours(n.getHours()%12+12*Z(new RegExp(e.amPM[1],"i").test(t)))},M:function(n,t,e){n.setMonth(e.months.shorthand.indexOf(t))},S:function(n,t){n.setSeconds(parseFloat(t))},U:function(n,t){return new Date(parseFloat(t)*1e3)},W:function(n,t,e){var i=parseInt(t),r=new Date(n.getFullYear(),0,2+(i-1)*7,0,0,0,0);return r.setDate(r.getDate()-r.getDay()+e.firstDayOfWeek),r},Y:function(n,t){n.setFullYear(parseFloat(t))},Z:function(n,t){return new Date(t)},d:function(n,t){n.setDate(parseFloat(t))},h:function(n,t){n.setHours((n.getHours()>=12?12:0)+parseFloat(t))},i:function(n,t){n.setMinutes(parseFloat(t))},j:function(n,t){n.setDate(parseFloat(t))},l:zt,m:function(n,t){n.setMonth(parseFloat(t)-1)},n:function(n,t){n.setMonth(parseFloat(t)-1)},s:function(n,t){n.setSeconds(parseFloat(t))},u:function(n,t){return new Date(parseFloat(t))},w:zt,y:function(n,t){n.setFullYear(2e3+parseFloat(t))}},Me={D:"",F:"",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},it={Z:function(n){return n.toISOString()},D:function(n,t,e){return t.weekdays.shorthand[it.w(n,t,e)]},F:function(n,t,e){return Et(it.n(n,t,e)-1,!1,t)},G:function(n,t,e){return G(it.h(n,t,e))},H:function(n){return G(n.getHours())},J:function(n,t){return t.ordinal!==void 0?n.getDate()+t.ordinal(n.getDate()):n.getDate()},K:function(n,t){return t.amPM[Z(n.getHours()>11)]},M:function(n,t){return Et(n.getMonth(),!0,t)},S:function(n){return G(n.getSeconds())},U:function(n){return n.getTime()/1e3},W:function(n,t,e){return e.getWeek(n)},Y:function(n){return G(n.getFullYear(),4)},d:function(n){return G(n.getDate())},h:function(n){return n.getHours()%12?n.getHours()%12:12},i:function(n){return G(n.getMinutes())},j:function(n){return n.getDate()},l:function(n,t){return t.weekdays.longhand[n.getDay()]},m:function(n){return G(n.getMonth()+1)},n:function(n){return n.getMonth()+1},s:function(n){return n.getSeconds()},u:function(n){return n.getTime()},w:function(n){return n.getDay()},y:function(n){return String(n.getFullYear()).substring(2)}},Kn=function(n){var t=n.config,e=t===void 0?q:t,i=n.l10n,r=i===void 0?xe:i,s=n.isMobile,a=s===void 0?!1:s;return function(o,l,h){var c=h||r;return e.formatDate!==void 0&&!a?e.formatDate(o,l,c):l.split("").map(function(f,m,y){return it[f]&&y[m-1]!=="\\"?it[f](o,c,e):f!=="\\"?f:""}).join("")}},Jt=function(n){var t=n.config,e=t===void 0?q:t,i=n.l10n,r=i===void 0?xe:i;return function(s,a,o,l){if(!(s!==0&&!s)){var h=l||r,c,f=s;if(s instanceof Date)c=new Date(s.getTime());else if(typeof s!="string"&&s.toFixed!==void 0)c=new Date(s);else if(typeof s=="string"){var m=a||(e||q).dateFormat,y=String(s).trim();if(y==="today")c=new Date,o=!0;else if(e&&e.parseDate)c=e.parseDate(s,m);else if(/Z$/.test(y)||/GMT$/.test(y))c=new Date(s);else{for(var b=void 0,_=[],C=0,T=0,j="";C<m.length;C++){var R=m[C],$=R==="\\",z=m[C-1]==="\\"||$;if(Me[R]&&!z){j+=Me[R];var me=new RegExp(j).exec(s);me&&(b=!0)&&_[R!=="Y"?"push":"unshift"]({fn:Ar[R],val:me[++T]})}else $||(j+=".")}c=!e||!e.noCalendar?new Date(new Date().getFullYear(),0,1,0,0,0,0):new Date(new Date().setHours(0,0,0,0)),_.forEach(function(W){var X=W.fn,de=W.val;return c=X(c,de,h)||c}),c=b?c:void 0}}if(!(c instanceof Date&&!isNaN(c.getTime()))){e.errorHandler(new Error("Invalid date provided: "+f));return}return o===!0&&c.setHours(0,0,0,0),c}}};function ae(n,t,e){return e===void 0&&(e=!0),e!==!1?new Date(n.getTime()).setHours(0,0,0,0)-new Date(t.getTime()).setHours(0,0,0,0):n.getTime()-t.getTime()}var Or=function(n,t,e){return n>Math.min(t,e)&&n<Math.max(t,e)},Qt=function(n,t,e){return n*3600+t*60+e},xr=function(n){var t=Math.floor(n/3600),e=(n-t*3600)/60;return[t,e,n-t*3600-e*60]},Pr={DAY:864e5};function Xt(n){var t=n.defaultHour,e=n.defaultMinute,i=n.defaultSeconds;if(n.minDate!==void 0){var r=n.minDate.getHours(),s=n.minDate.getMinutes(),a=n.minDate.getSeconds();t<r&&(t=r),t===r&&e<s&&(e=s),t===r&&e===s&&i<a&&(i=n.minDate.getSeconds())}if(n.maxDate!==void 0){var o=n.maxDate.getHours(),l=n.maxDate.getMinutes();t=Math.min(t,o),t===o&&(e=Math.min(l,e)),t===o&&e===l&&(i=n.maxDate.getSeconds())}return{hours:t,minutes:e,seconds:i}}typeof Object.assign!="function"&&(Object.assign=function(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];if(!n)throw TypeError("Cannot convert undefined or null to object");for(var i=function(o){o&&Object.keys(o).forEach(function(l){return n[l]=o[l]})},r=0,s=t;r<s.length;r++){var a=s[r];i(a)}return n});var J=globalThis&&globalThis.__assign||function(){return J=Object.assign||function(n){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},J.apply(this,arguments)},Wn=globalThis&&globalThis.__spreadArrays||function(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;for(var i=Array(n),r=0,t=0;t<e;t++)for(var s=arguments[t],a=0,o=s.length;a<o;a++,r++)i[r]=s[a];return i},Mr=300;function Lr(n,t){var e={config:J(J({},q),H.defaultConfig),l10n:xe};e.parseDate=Jt({config:e.config,l10n:e.l10n}),e._handlers=[],e.pluginElements=[],e.loadedPlugins=[],e._bind=_,e._setHoursFromDate=m,e._positionCalendar=Vt,e.changeMonth=jn,e.changeYear=qt,e.clear=Gl,e.close=zl,e.onMouseOver=Wt,e._createElement=M,e.createDay=me,e.destroy=Jl,e.isEnabled=Ke,e.jumpToDate=j,e.updateValue=Ce,e.open=Zl,e.redraw=br,e.set=ic,e.setDate=rc,e.toggle=lc;function i(){e.utils={getDaysInMonth:function(u,d){return u===void 0&&(u=e.currentMonth),d===void 0&&(d=e.currentYear),u===1&&(d%4===0&&d%100!==0||d%400===0)?29:e.l10n.daysInMonth[u]}}}function r(){e.element=e.input=n,e.isOpen=!1,ec(),yr(),ac(),sc(),i(),e.isMobile||z(),T(),(e.selectedDates.length||e.config.noCalendar)&&(e.config.enableTime&&m(e.config.noCalendar?e.latestSelectedDateObj:void 0),Ce(!1)),o();var u=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!e.isMobile&&u&&Vt(),B("onReady")}function s(){var u;return((u=e.calendarContainer)===null||u===void 0?void 0:u.getRootNode()).activeElement||document.activeElement}function a(u){return u.bind(e)}function o(){var u=e.config;u.weekNumbers===!1&&u.showMonths===1||u.noCalendar!==!0&&window.requestAnimationFrame(function(){if(e.calendarContainer!==void 0&&(e.calendarContainer.style.visibility="hidden",e.calendarContainer.style.display="block"),e.daysContainer!==void 0){var d=(e.days.offsetWidth+1)*u.showMonths;e.daysContainer.style.width=d+"px",e.calendarContainer.style.width=d+(e.weekWrapper!==void 0?e.weekWrapper.offsetWidth:0)+"px",e.calendarContainer.style.removeProperty("visibility"),e.calendarContainer.style.removeProperty("display")}})}function l(u){if(e.selectedDates.length===0){var d=e.config.minDate===void 0||ae(new Date,e.config.minDate)>=0?new Date:new Date(e.config.minDate.getTime()),p=Xt(e.config);d.setHours(p.hours,p.minutes,p.seconds,d.getMilliseconds()),e.selectedDates=[d],e.latestSelectedDateObj=d}u!==void 0&&u.type!=="blur"&&hc(u);var v=e._input.value;f(),Ce(),e._input.value!==v&&e._debouncedChange()}function h(u,d){return u%12+12*Z(d===e.l10n.amPM[1])}function c(u){switch(u%24){case 0:case 12:return 12;default:return u%12}}function f(){if(!(e.hourElement===void 0||e.minuteElement===void 0)){var u=(parseInt(e.hourElement.value.slice(-2),10)||0)%24,d=(parseInt(e.minuteElement.value,10)||0)%60,p=e.secondElement!==void 0?(parseInt(e.secondElement.value,10)||0)%60:0;e.amPM!==void 0&&(u=h(u,e.amPM.textContent));var v=e.config.minTime!==void 0||e.config.minDate&&e.minDateHasTime&&e.latestSelectedDateObj&&ae(e.latestSelectedDateObj,e.config.minDate,!0)===0,w=e.config.maxTime!==void 0||e.config.maxDate&&e.maxDateHasTime&&e.latestSelectedDateObj&&ae(e.latestSelectedDateObj,e.config.maxDate,!0)===0;if(e.config.maxTime!==void 0&&e.config.minTime!==void 0&&e.config.minTime>e.config.maxTime){var E=Qt(e.config.minTime.getHours(),e.config.minTime.getMinutes(),e.config.minTime.getSeconds()),O=Qt(e.config.maxTime.getHours(),e.config.maxTime.getMinutes(),e.config.maxTime.getSeconds()),k=Qt(u,d,p);if(k>O&&k<E){var P=xr(E);u=P[0],d=P[1],p=P[2]}}else{if(w){var S=e.config.maxTime!==void 0?e.config.maxTime:e.config.maxDate;u=Math.min(u,S.getHours()),u===S.getHours()&&(d=Math.min(d,S.getMinutes())),d===S.getMinutes()&&(p=Math.min(p,S.getSeconds()))}if(v){var D=e.config.minTime!==void 0?e.config.minTime:e.config.minDate;u=Math.max(u,D.getHours()),u===D.getHours()&&d<D.getMinutes()&&(d=D.getMinutes()),d===D.getMinutes()&&(p=Math.max(p,D.getSeconds()))}}y(u,d,p)}}function m(u){var d=u||e.latestSelectedDateObj;d&&d instanceof Date&&y(d.getHours(),d.getMinutes(),d.getSeconds())}function y(u,d,p){e.latestSelectedDateObj!==void 0&&e.latestSelectedDateObj.setHours(u%24,d,p||0,0),!(!e.hourElement||!e.minuteElement||e.isMobile)&&(e.hourElement.value=G(e.config.time_24hr?u:(12+u)%12+12*Z(u%12===0)),e.minuteElement.value=G(d),e.amPM!==void 0&&(e.amPM.textContent=e.l10n.amPM[Z(u>=12)]),e.secondElement!==void 0&&(e.secondElement.value=G(p)))}function b(u){var d=se(u),p=parseInt(d.value)+(u.delta||0);(p/1e3>1||u.key==="Enter"&&!/[^\d]/.test(p.toString()))&&qt(p)}function _(u,d,p,v){if(d instanceof Array)return d.forEach(function(w){return _(u,w,p,v)});if(u instanceof Array)return u.forEach(function(w){return _(w,d,p,v)});u.addEventListener(d,p,v),e._handlers.push({remove:function(){return u.removeEventListener(d,p,v)}})}function C(){B("onChange")}function T(){if(e.config.wrap&&["open","close","toggle","clear"].forEach(function(p){Array.prototype.forEach.call(e.element.querySelectorAll("[data-"+p+"]"),function(v){return _(v,"click",e[p])})}),e.isMobile){oc();return}var u=yt(Xl,50);if(e._debouncedChange=yt(C,Mr),e.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&_(e.daysContainer,"mouseover",function(p){e.config.mode==="range"&&Wt(se(p))}),_(e._input,"keydown",gr),e.calendarContainer!==void 0&&_(e.calendarContainer,"keydown",gr),!e.config.inline&&!e.config.static&&_(window,"resize",u),window.ontouchstart!==void 0?_(window.document,"touchstart",Rn):_(window.document,"mousedown",Rn),_(window.document,"focus",Rn,{capture:!0}),e.config.clickOpens===!0&&(_(e._input,"focus",e.open),_(e._input,"click",e.open)),e.daysContainer!==void 0&&(_(e.monthNav,"click",uc),_(e.monthNav,["keyup","increment"],b),_(e.daysContainer,"click",wr)),e.timeContainer!==void 0&&e.minuteElement!==void 0&&e.hourElement!==void 0){var d=function(p){return se(p).select()};_(e.timeContainer,["increment"],l),_(e.timeContainer,"blur",l,{capture:!0}),_(e.timeContainer,"click",R),_([e.hourElement,e.minuteElement],["focus","click"],d),e.secondElement!==void 0&&_(e.secondElement,"focus",function(){return e.secondElement&&e.secondElement.select()}),e.amPM!==void 0&&_(e.amPM,"click",function(p){l(p)})}e.config.allowInput&&_(e._input,"blur",Ql)}function j(u,d){var p=u!==void 0?e.parseDate(u):e.latestSelectedDateObj||(e.config.minDate&&e.config.minDate>e.now?e.config.minDate:e.config.maxDate&&e.config.maxDate<e.now?e.config.maxDate:e.now),v=e.currentYear,w=e.currentMonth;try{p!==void 0&&(e.currentYear=p.getFullYear(),e.currentMonth=p.getMonth())}catch(E){E.message="Invalid date supplied: "+p,e.config.errorHandler(E)}d&&e.currentYear!==v&&(B("onYearChange"),Be()),d&&(e.currentYear!==v||e.currentMonth!==w)&&B("onMonthChange"),e.redraw()}function R(u){var d=se(u);~d.className.indexOf("arrow")&&$(u,d.classList.contains("arrowUp")?1:-1)}function $(u,d,p){var v=u&&se(u),w=p||v&&v.parentNode&&v.parentNode.firstChild,E=Fn("increment");E.delta=d,w&&w.dispatchEvent(E)}function z(){var u=window.document.createDocumentFragment();if(e.calendarContainer=M("div","flatpickr-calendar"),e.calendarContainer.tabIndex=-1,!e.config.noCalendar){if(u.appendChild(Bt()),e.innerContainer=M("div","flatpickr-innerContainer"),e.config.weekNumbers){var d=Yl(),p=d.weekWrapper,v=d.weekNumbers;e.innerContainer.appendChild(p),e.weekNumbers=v,e.weekWrapper=p}e.rContainer=M("div","flatpickr-rContainer"),e.rContainer.appendChild(pr()),e.daysContainer||(e.daysContainer=M("div","flatpickr-days"),e.daysContainer.tabIndex=-1),ge(),e.rContainer.appendChild(e.daysContainer),e.innerContainer.appendChild(e.rContainer),u.appendChild(e.innerContainer)}e.config.enableTime&&u.appendChild(Vl()),U(e.calendarContainer,"rangeMode",e.config.mode==="range"),U(e.calendarContainer,"animate",e.config.animate===!0),U(e.calendarContainer,"multiMonth",e.config.showMonths>1),e.calendarContainer.appendChild(u);var w=e.config.appendTo!==void 0&&e.config.appendTo.nodeType!==void 0;if((e.config.inline||e.config.static)&&(e.calendarContainer.classList.add(e.config.inline?"inline":"static"),e.config.inline&&(!w&&e.element.parentNode?e.element.parentNode.insertBefore(e.calendarContainer,e._input.nextSibling):e.config.appendTo!==void 0&&e.config.appendTo.appendChild(e.calendarContainer)),e.config.static)){var E=M("div","flatpickr-wrapper");e.element.parentNode&&e.element.parentNode.insertBefore(E,e.element),E.appendChild(e.element),e.altInput&&E.appendChild(e.altInput),E.appendChild(e.calendarContainer)}!e.config.static&&!e.config.inline&&(e.config.appendTo!==void 0?e.config.appendTo:window.document.body).appendChild(e.calendarContainer)}function me(u,d,p,v){var w=Ke(d,!0),E=M("span",u,d.getDate().toString());return E.dateObj=d,E.$i=v,E.setAttribute("aria-label",e.formatDate(d,e.config.ariaDateFormat)),u.indexOf("hidden")===-1&&ae(d,e.now)===0&&(e.todayDateElem=E,E.classList.add("today"),E.setAttribute("aria-current","date")),w?(E.tabIndex=-1,$n(d)&&(E.classList.add("selected"),e.selectedDateElem=E,e.config.mode==="range"&&(U(E,"startRange",e.selectedDates[0]&&ae(d,e.selectedDates[0],!0)===0),U(E,"endRange",e.selectedDates[1]&&ae(d,e.selectedDates[1],!0)===0),u==="nextMonthDay"&&E.classList.add("inRange")))):E.classList.add("flatpickr-disabled"),e.config.mode==="range"&&cc(d)&&!$n(d)&&E.classList.add("inRange"),e.weekNumbers&&e.config.showMonths===1&&u!=="prevMonthDay"&&v%7===6&&e.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+e.config.getWeek(d)+"</span>"),B("onDayCreate",E),E}function W(u){u.focus(),e.config.mode==="range"&&Wt(u)}function X(u){for(var d=u>0?0:e.config.showMonths-1,p=u>0?e.config.showMonths:-1,v=d;v!=p;v+=u)for(var w=e.daysContainer.children[v],E=u>0?0:w.children.length-1,O=u>0?w.children.length:-1,k=E;k!=O;k+=u){var P=w.children[k];if(P.className.indexOf("hidden")===-1&&Ke(P.dateObj))return P}}function de(u,d){for(var p=u.className.indexOf("Month")===-1?u.dateObj.getMonth():e.currentMonth,v=d>0?e.config.showMonths:-1,w=d>0?1:-1,E=p-e.currentMonth;E!=v;E+=w)for(var O=e.daysContainer.children[E],k=p-e.currentMonth===E?u.$i+d:d<0?O.children.length-1:0,P=O.children.length,S=k;S>=0&&S<P&&S!=(d>0?P:-1);S+=w){var D=O.children[S];if(D.className.indexOf("hidden")===-1&&Ke(D.dateObj)&&Math.abs(u.$i-S)>=Math.abs(d))return W(D)}e.changeMonth(w),Oe(X(w),0)}function Oe(u,d){var p=s(),v=Kt(p||document.body),w=u!==void 0?u:v?p:e.selectedDateElem!==void 0&&Kt(e.selectedDateElem)?e.selectedDateElem:e.todayDateElem!==void 0&&Kt(e.todayDateElem)?e.todayDateElem:X(d>0?1:-1);w===void 0?e._input.focus():v?de(w,d):W(w)}function gt(u,d){for(var p=(new Date(u,d,1).getDay()-e.l10n.firstDayOfWeek+7)%7,v=e.utils.getDaysInMonth((d-1+12)%12,u),w=e.utils.getDaysInMonth(d,u),E=window.document.createDocumentFragment(),O=e.config.showMonths>1,k=O?"prevMonthDay hidden":"prevMonthDay",P=O?"nextMonthDay hidden":"nextMonthDay",S=v+1-p,D=0;S<=v;S++,D++)E.appendChild(me("flatpickr-day "+k,new Date(u,d-1,S),S,D));for(S=1;S<=w;S++,D++)E.appendChild(me("flatpickr-day",new Date(u,d,S),S,D));for(var N=w+1;N<=42-p&&(e.config.showMonths===1||D%7!==0);N++,D++)E.appendChild(me("flatpickr-day "+P,new Date(u,d+1,N%w),N,D));var be=M("div","dayContainer");return be.appendChild(E),be}function ge(){if(e.daysContainer!==void 0){bt(e.daysContainer),e.weekNumbers&&bt(e.weekNumbers);for(var u=document.createDocumentFragment(),d=0;d<e.config.showMonths;d++){var p=new Date(e.currentYear,e.currentMonth,1);p.setMonth(e.currentMonth+d),u.appendChild(gt(p.getFullYear(),p.getMonth()))}e.daysContainer.appendChild(u),e.days=e.daysContainer.firstChild,e.config.mode==="range"&&e.selectedDates.length===1&&Wt()}}function Be(){if(!(e.config.showMonths>1||e.config.monthSelectorType!=="dropdown")){var u=function(v){return e.config.minDate!==void 0&&e.currentYear===e.config.minDate.getFullYear()&&v<e.config.minDate.getMonth()?!1:!(e.config.maxDate!==void 0&&e.currentYear===e.config.maxDate.getFullYear()&&v>e.config.maxDate.getMonth())};e.monthsDropdownContainer.tabIndex=-1,e.monthsDropdownContainer.innerHTML="";for(var d=0;d<12;d++)if(u(d)){var p=M("option","flatpickr-monthDropdown-month");p.value=new Date(e.currentYear,d).getMonth().toString(),p.textContent=Et(d,e.config.shorthandCurrentMonth,e.l10n),p.tabIndex=-1,e.currentMonth===d&&(p.selected=!0),e.monthsDropdownContainer.appendChild(p)}}}function ce(){var u=M("div","flatpickr-month"),d=window.document.createDocumentFragment(),p;e.config.showMonths>1||e.config.monthSelectorType==="static"?p=M("span","cur-month"):(e.monthsDropdownContainer=M("select","flatpickr-monthDropdown-months"),e.monthsDropdownContainer.setAttribute("aria-label",e.l10n.monthAriaLabel),_(e.monthsDropdownContainer,"change",function(O){var k=se(O),P=parseInt(k.value,10);e.changeMonth(P-e.currentMonth),B("onMonthChange")}),Be(),p=e.monthsDropdownContainer);var v=wt("cur-year",{tabindex:"-1"}),w=v.getElementsByTagName("input")[0];w.setAttribute("aria-label",e.l10n.yearAriaLabel),e.config.minDate&&w.setAttribute("min",e.config.minDate.getFullYear().toString()),e.config.maxDate&&(w.setAttribute("max",e.config.maxDate.getFullYear().toString()),w.disabled=!!e.config.minDate&&e.config.minDate.getFullYear()===e.config.maxDate.getFullYear());var E=M("div","flatpickr-current-month");return E.appendChild(p),E.appendChild(v),d.appendChild(E),u.appendChild(d),{container:u,yearElement:w,monthElement:p}}function qe(){bt(e.monthNav),e.monthNav.appendChild(e.prevMonthNav),e.config.showMonths&&(e.yearElements=[],e.monthElements=[]);for(var u=e.config.showMonths;u--;){var d=ce();e.yearElements.push(d.yearElement),e.monthElements.push(d.monthElement),e.monthNav.appendChild(d.container)}e.monthNav.appendChild(e.nextMonthNav)}function Bt(){return e.monthNav=M("div","flatpickr-months"),e.yearElements=[],e.monthElements=[],e.prevMonthNav=M("span","flatpickr-prev-month"),e.prevMonthNav.innerHTML=e.config.prevArrow,e.nextMonthNav=M("span","flatpickr-next-month"),e.nextMonthNav.innerHTML=e.config.nextArrow,qe(),Object.defineProperty(e,"_hidePrevMonthArrow",{get:function(){return e.__hidePrevMonthArrow},set:function(u){e.__hidePrevMonthArrow!==u&&(U(e.prevMonthNav,"flatpickr-disabled",u),e.__hidePrevMonthArrow=u)}}),Object.defineProperty(e,"_hideNextMonthArrow",{get:function(){return e.__hideNextMonthArrow},set:function(u){e.__hideNextMonthArrow!==u&&(U(e.nextMonthNav,"flatpickr-disabled",u),e.__hideNextMonthArrow=u)}}),e.currentYearElement=e.yearElements[0],Gt(),e.monthNav}function Vl(){e.calendarContainer.classList.add("hasTime"),e.config.noCalendar&&e.calendarContainer.classList.add("noCalendar");var u=Xt(e.config);e.timeContainer=M("div","flatpickr-time"),e.timeContainer.tabIndex=-1;var d=M("span","flatpickr-time-separator",":"),p=wt("flatpickr-hour",{"aria-label":e.l10n.hourAriaLabel});e.hourElement=p.getElementsByTagName("input")[0];var v=wt("flatpickr-minute",{"aria-label":e.l10n.minuteAriaLabel});if(e.minuteElement=v.getElementsByTagName("input")[0],e.hourElement.tabIndex=e.minuteElement.tabIndex=-1,e.hourElement.value=G(e.latestSelectedDateObj?e.latestSelectedDateObj.getHours():e.config.time_24hr?u.hours:c(u.hours)),e.minuteElement.value=G(e.latestSelectedDateObj?e.latestSelectedDateObj.getMinutes():u.minutes),e.hourElement.setAttribute("step",e.config.hourIncrement.toString()),e.minuteElement.setAttribute("step",e.config.minuteIncrement.toString()),e.hourElement.setAttribute("min",e.config.time_24hr?"0":"1"),e.hourElement.setAttribute("max",e.config.time_24hr?"23":"12"),e.hourElement.setAttribute("maxlength","2"),e.minuteElement.setAttribute("min","0"),e.minuteElement.setAttribute("max","59"),e.minuteElement.setAttribute("maxlength","2"),e.timeContainer.appendChild(p),e.timeContainer.appendChild(d),e.timeContainer.appendChild(v),e.config.time_24hr&&e.timeContainer.classList.add("time24hr"),e.config.enableSeconds){e.timeContainer.classList.add("hasSeconds");var w=wt("flatpickr-second");e.secondElement=w.getElementsByTagName("input")[0],e.secondElement.value=G(e.latestSelectedDateObj?e.latestSelectedDateObj.getSeconds():u.seconds),e.secondElement.setAttribute("step",e.minuteElement.getAttribute("step")),e.secondElement.setAttribute("min","0"),e.secondElement.setAttribute("max","59"),e.secondElement.setAttribute("maxlength","2"),e.timeContainer.appendChild(M("span","flatpickr-time-separator",":")),e.timeContainer.appendChild(w)}return e.config.time_24hr||(e.amPM=M("span","flatpickr-am-pm",e.l10n.amPM[Z((e.latestSelectedDateObj?e.hourElement.value:e.config.defaultHour)>11)]),e.amPM.title=e.l10n.toggleTitle,e.amPM.tabIndex=-1,e.timeContainer.appendChild(e.amPM)),e.timeContainer}function pr(){e.weekdayContainer?bt(e.weekdayContainer):e.weekdayContainer=M("div","flatpickr-weekdays");for(var u=e.config.showMonths;u--;){var d=M("div","flatpickr-weekdaycontainer");e.weekdayContainer.appendChild(d)}return mr(),e.weekdayContainer}function mr(){if(e.weekdayContainer){var u=e.l10n.firstDayOfWeek,d=Wn(e.l10n.weekdays.shorthand);u>0&&u<d.length&&(d=Wn(d.splice(u,d.length),d.splice(0,u)));for(var p=e.config.showMonths;p--;)e.weekdayContainer.children[p].innerHTML=`
      <span class='flatpickr-weekday'>
        `+d.join("</span><span class='flatpickr-weekday'>")+`
      </span>
      `}}function Yl(){e.calendarContainer.classList.add("hasWeeks");var u=M("div","flatpickr-weekwrapper");u.appendChild(M("span","flatpickr-weekday",e.l10n.weekAbbreviation));var d=M("div","flatpickr-weeks");return u.appendChild(d),{weekWrapper:u,weekNumbers:d}}function jn(u,d){d===void 0&&(d=!0);var p=d?u:u-e.currentMonth;p<0&&e._hidePrevMonthArrow===!0||p>0&&e._hideNextMonthArrow===!0||(e.currentMonth+=p,(e.currentMonth<0||e.currentMonth>11)&&(e.currentYear+=e.currentMonth>11?1:-1,e.currentMonth=(e.currentMonth+12)%12,B("onYearChange"),Be()),ge(),B("onMonthChange"),Gt())}function Gl(u,d){if(u===void 0&&(u=!0),d===void 0&&(d=!0),e.input.value="",e.altInput!==void 0&&(e.altInput.value=""),e.mobileInput!==void 0&&(e.mobileInput.value=""),e.selectedDates=[],e.latestSelectedDateObj=void 0,d===!0&&(e.currentYear=e._initialDate.getFullYear(),e.currentMonth=e._initialDate.getMonth()),e.config.enableTime===!0){var p=Xt(e.config),v=p.hours,w=p.minutes,E=p.seconds;y(v,w,E)}e.redraw(),u&&B("onChange")}function zl(){e.isOpen=!1,e.isMobile||(e.calendarContainer!==void 0&&e.calendarContainer.classList.remove("open"),e._input!==void 0&&e._input.classList.remove("active")),B("onClose")}function Jl(){e.config!==void 0&&B("onDestroy");for(var u=e._handlers.length;u--;)e._handlers[u].remove();if(e._handlers=[],e.mobileInput)e.mobileInput.parentNode&&e.mobileInput.parentNode.removeChild(e.mobileInput),e.mobileInput=void 0;else if(e.calendarContainer&&e.calendarContainer.parentNode)if(e.config.static&&e.calendarContainer.parentNode){var d=e.calendarContainer.parentNode;if(d.lastChild&&d.removeChild(d.lastChild),d.parentNode){for(;d.firstChild;)d.parentNode.insertBefore(d.firstChild,d);d.parentNode.removeChild(d)}}else e.calendarContainer.parentNode.removeChild(e.calendarContainer);e.altInput&&(e.input.type="text",e.altInput.parentNode&&e.altInput.parentNode.removeChild(e.altInput),delete e.altInput),e.input&&(e.input.type=e.input._type,e.input.classList.remove("flatpickr-input"),e.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(function(p){try{delete e[p]}catch(v){}})}function vt(u){return e.calendarContainer.contains(u)}function Rn(u){if(e.isOpen&&!e.config.inline){var d=se(u),p=vt(d),v=d===e.input||d===e.altInput||e.element.contains(d)||u.path&&u.path.indexOf&&(~u.path.indexOf(e.input)||~u.path.indexOf(e.altInput)),w=!v&&!p&&!vt(u.relatedTarget),E=!e.config.ignoredFocusElements.some(function(O){return O.contains(d)});w&&E&&(e.config.allowInput&&e.setDate(e._input.value,!1,e.config.altInput?e.config.altFormat:e.config.dateFormat),e.timeContainer!==void 0&&e.minuteElement!==void 0&&e.hourElement!==void 0&&e.input.value!==""&&e.input.value!==void 0&&l(),e.close(),e.config&&e.config.mode==="range"&&e.selectedDates.length===1&&e.clear(!1))}}function qt(u){if(!(!u||e.config.minDate&&u<e.config.minDate.getFullYear()||e.config.maxDate&&u>e.config.maxDate.getFullYear())){var d=u,p=e.currentYear!==d;e.currentYear=d||e.currentYear,e.config.maxDate&&e.currentYear===e.config.maxDate.getFullYear()?e.currentMonth=Math.min(e.config.maxDate.getMonth(),e.currentMonth):e.config.minDate&&e.currentYear===e.config.minDate.getFullYear()&&(e.currentMonth=Math.max(e.config.minDate.getMonth(),e.currentMonth)),p&&(e.redraw(),B("onYearChange"),Be())}}function Ke(u,d){var p;d===void 0&&(d=!0);var v=e.parseDate(u,void 0,d);if(e.config.minDate&&v&&ae(v,e.config.minDate,d!==void 0?d:!e.minDateHasTime)<0||e.config.maxDate&&v&&ae(v,e.config.maxDate,d!==void 0?d:!e.maxDateHasTime)>0)return!1;if(!e.config.enable&&e.config.disable.length===0)return!0;if(v===void 0)return!1;for(var w=!!e.config.enable,E=(p=e.config.enable)!==null&&p!==void 0?p:e.config.disable,O=0,k=void 0;O<E.length;O++){if(k=E[O],typeof k=="function"&&k(v))return w;if(k instanceof Date&&v!==void 0&&k.getTime()===v.getTime())return w;if(typeof k=="string"){var P=e.parseDate(k,void 0,!0);return P&&P.getTime()===v.getTime()?w:!w}else if(typeof k=="object"&&v!==void 0&&k.from&&k.to&&v.getTime()>=k.from.getTime()&&v.getTime()<=k.to.getTime())return w}return!w}function Kt(u){return e.daysContainer!==void 0?u.className.indexOf("hidden")===-1&&u.className.indexOf("flatpickr-disabled")===-1&&e.daysContainer.contains(u):!1}function Ql(u){var d=u.target===e._input,p=e._input.value.trimEnd()!==Un();d&&p&&!(u.relatedTarget&&vt(u.relatedTarget))&&e.setDate(e._input.value,!0,u.target===e.altInput?e.config.altFormat:e.config.dateFormat)}function gr(u){var d=se(u),p=e.config.wrap?n.contains(d):d===e._input,v=e.config.allowInput,w=e.isOpen&&(!v||!p),E=e.config.inline&&p&&!v;if(u.keyCode===13&&p){if(v)return e.setDate(e._input.value,!0,d===e.altInput?e.config.altFormat:e.config.dateFormat),e.close(),d.blur();e.open()}else if(vt(d)||w||E){var O=!!e.timeContainer&&e.timeContainer.contains(d);switch(u.keyCode){case 13:O?(u.preventDefault(),l(),Nn()):wr(u);break;case 27:u.preventDefault(),Nn();break;case 8:case 46:p&&!e.config.allowInput&&(u.preventDefault(),e.clear());break;case 37:case 39:if(!O&&!p){u.preventDefault();var k=s();if(e.daysContainer!==void 0&&(v===!1||k&&Kt(k))){var P=u.keyCode===39?1:-1;u.ctrlKey?(u.stopPropagation(),jn(P),Oe(X(1),0)):Oe(void 0,P)}}else e.hourElement&&e.hourElement.focus();break;case 38:case 40:u.preventDefault();var S=u.keyCode===40?1:-1;e.daysContainer&&d.$i!==void 0||d===e.input||d===e.altInput?u.ctrlKey?(u.stopPropagation(),qt(e.currentYear-S),Oe(X(1),0)):O||Oe(void 0,S*7):d===e.currentYearElement?qt(e.currentYear-S):e.config.enableTime&&(!O&&e.hourElement&&e.hourElement.focus(),l(u),e._debouncedChange());break;case 9:if(O){var D=[e.hourElement,e.minuteElement,e.secondElement,e.amPM].concat(e.pluginElements).filter(function(ue){return ue}),N=D.indexOf(d);if(N!==-1){var be=D[N+(u.shiftKey?-1:1)];u.preventDefault(),(be||e._input).focus()}}else!e.config.noCalendar&&e.daysContainer&&e.daysContainer.contains(d)&&u.shiftKey&&(u.preventDefault(),e._input.focus());break}}if(e.amPM!==void 0&&d===e.amPM)switch(u.key){case e.l10n.amPM[0].charAt(0):case e.l10n.amPM[0].charAt(0).toLowerCase():e.amPM.textContent=e.l10n.amPM[0],f(),Ce();break;case e.l10n.amPM[1].charAt(0):case e.l10n.amPM[1].charAt(0).toLowerCase():e.amPM.textContent=e.l10n.amPM[1],f(),Ce();break}(p||vt(d))&&B("onKeyDown",u)}function Wt(u,d){if(d===void 0&&(d="flatpickr-day"),!(e.selectedDates.length!==1||u&&(!u.classList.contains(d)||u.classList.contains("flatpickr-disabled")))){for(var p=u?u.dateObj.getTime():e.days.firstElementChild.dateObj.getTime(),v=e.parseDate(e.selectedDates[0],void 0,!0).getTime(),w=Math.min(p,e.selectedDates[0].getTime()),E=Math.max(p,e.selectedDates[0].getTime()),O=!1,k=0,P=0,S=w;S<E;S+=Pr.DAY)Ke(new Date(S),!0)||(O=O||S>w&&S<E,S<v&&(!k||S>k)?k=S:S>v&&(!P||S<P)&&(P=S));var D=Array.from(e.rContainer.querySelectorAll("*:nth-child(-n+"+e.config.showMonths+") > ."+d));D.forEach(function(N){var be=N.dateObj,ue=be.getTime(),_t=k>0&&ue<k||P>0&&ue>P;if(_t){N.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(function(nt){N.classList.remove(nt)});return}else if(O&&!_t)return;["startRange","inRange","endRange","notAllowed"].forEach(function(nt){N.classList.remove(nt)}),u!==void 0&&(u.classList.add(p<=e.selectedDates[0].getTime()?"startRange":"endRange"),v<p&&ue===v?N.classList.add("startRange"):v>p&&ue===v&&N.classList.add("endRange"),ue>=k&&(P===0||ue<=P)&&Or(ue,v,p)&&N.classList.add("inRange"))})}}function Xl(){e.isOpen&&!e.config.static&&!e.config.inline&&Vt()}function Zl(u,d){if(d===void 0&&(d=e._positionElement),e.isMobile===!0){if(u){u.preventDefault();var p=se(u);p&&p.blur()}e.mobileInput!==void 0&&(e.mobileInput.focus(),e.mobileInput.click()),B("onOpen");return}else if(e._input.disabled||e.config.inline)return;var v=e.isOpen;e.isOpen=!0,v||(e.calendarContainer.classList.add("open"),e._input.classList.add("active"),B("onOpen"),Vt(d)),e.config.enableTime===!0&&e.config.noCalendar===!0&&e.config.allowInput===!1&&(u===void 0||!e.timeContainer.contains(u.relatedTarget))&&setTimeout(function(){return e.hourElement.select()},50)}function vr(u){return function(d){var p=e.config["_"+u+"Date"]=e.parseDate(d,e.config.dateFormat),v=e.config["_"+(u==="min"?"max":"min")+"Date"];p!==void 0&&(e[u==="min"?"minDateHasTime":"maxDateHasTime"]=p.getHours()>0||p.getMinutes()>0||p.getSeconds()>0),e.selectedDates&&(e.selectedDates=e.selectedDates.filter(function(w){return Ke(w)}),!e.selectedDates.length&&u==="min"&&m(p),Ce()),e.daysContainer&&(br(),p!==void 0?e.currentYearElement[u]=p.getFullYear().toString():e.currentYearElement.removeAttribute(u),e.currentYearElement.disabled=!!v&&p!==void 0&&v.getFullYear()===p.getFullYear())}}function ec(){var u=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],d=J(J({},JSON.parse(JSON.stringify(n.dataset||{}))),t),p={};e.config.parseDate=d.parseDate,e.config.formatDate=d.formatDate,Object.defineProperty(e.config,"enable",{get:function(){return e.config._enable},set:function(D){e.config._enable=Cr(D)}}),Object.defineProperty(e.config,"disable",{get:function(){return e.config._disable},set:function(D){e.config._disable=Cr(D)}});var v=d.mode==="time";if(!d.dateFormat&&(d.enableTime||v)){var w=H.defaultConfig.dateFormat||q.dateFormat;p.dateFormat=d.noCalendar||v?"H:i"+(d.enableSeconds?":S":""):w+" H:i"+(d.enableSeconds?":S":"")}if(d.altInput&&(d.enableTime||v)&&!d.altFormat){var E=H.defaultConfig.altFormat||q.altFormat;p.altFormat=d.noCalendar||v?"h:i"+(d.enableSeconds?":S K":" K"):E+(" h:i"+(d.enableSeconds?":S":"")+" K")}Object.defineProperty(e.config,"minDate",{get:function(){return e.config._minDate},set:vr("min")}),Object.defineProperty(e.config,"maxDate",{get:function(){return e.config._maxDate},set:vr("max")});var O=function(D){return function(N){e.config[D==="min"?"_minTime":"_maxTime"]=e.parseDate(N,"H:i:S")}};Object.defineProperty(e.config,"minTime",{get:function(){return e.config._minTime},set:O("min")}),Object.defineProperty(e.config,"maxTime",{get:function(){return e.config._maxTime},set:O("max")}),d.mode==="time"&&(e.config.noCalendar=!0,e.config.enableTime=!0),Object.assign(e.config,p,d);for(var k=0;k<u.length;k++)e.config[u[k]]=e.config[u[k]]===!0||e.config[u[k]]==="true";V.filter(function(D){return e.config[D]!==void 0}).forEach(function(D){e.config[D]=Pe(e.config[D]||[]).map(a)}),e.isMobile=!e.config.disableMobile&&!e.config.inline&&e.config.mode==="single"&&!e.config.disable.length&&!e.config.enable&&!e.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(var k=0;k<e.config.plugins.length;k++){var P=e.config.plugins[k](e)||{};for(var S in P)V.indexOf(S)>-1?e.config[S]=Pe(P[S]).map(a).concat(e.config[S]):typeof d[S]=="undefined"&&(e.config[S]=P[S])}d.altInputClass||(e.config.altInputClass=_r().className+" "+e.config.altInputClass),B("onParseConfig")}function _r(){return e.config.wrap?n.querySelector("[data-input]"):n}function yr(){typeof e.config.locale!="object"&&typeof H.l10ns[e.config.locale]=="undefined"&&e.config.errorHandler(new Error("flatpickr: invalid locale "+e.config.locale)),e.l10n=J(J({},H.l10ns.default),typeof e.config.locale=="object"?e.config.locale:e.config.locale!=="default"?H.l10ns[e.config.locale]:void 0),Me.D="("+e.l10n.weekdays.shorthand.join("|")+")",Me.l="("+e.l10n.weekdays.longhand.join("|")+")",Me.M="("+e.l10n.months.shorthand.join("|")+")",Me.F="("+e.l10n.months.longhand.join("|")+")",Me.K="("+e.l10n.amPM[0]+"|"+e.l10n.amPM[1]+"|"+e.l10n.amPM[0].toLowerCase()+"|"+e.l10n.amPM[1].toLowerCase()+")";var u=J(J({},t),JSON.parse(JSON.stringify(n.dataset||{})));u.time_24hr===void 0&&H.defaultConfig.time_24hr===void 0&&(e.config.time_24hr=e.l10n.time_24hr),e.formatDate=Kn(e),e.parseDate=Jt({config:e.config,l10n:e.l10n})}function Vt(u){if(typeof e.config.position=="function")return void e.config.position(e,u);if(e.calendarContainer!==void 0){B("onPreCalendarPosition");var d=u||e._positionElement,p=Array.prototype.reduce.call(e.calendarContainer.children,function(yc,bc){return yc+bc.offsetHeight},0),v=e.calendarContainer.offsetWidth,w=e.config.position.split(" "),E=w[0],O=w.length>1?w[1]:null,k=d.getBoundingClientRect(),P=window.innerHeight-k.bottom,S=E==="above"||E!=="below"&&P<p&&k.top>p,D=window.pageYOffset+k.top+(S?-p-2:d.offsetHeight+2);if(U(e.calendarContainer,"arrowTop",!S),U(e.calendarContainer,"arrowBottom",S),!e.config.inline){var N=window.pageXOffset+k.left,be=!1,ue=!1;O==="center"?(N-=(v-k.width)/2,be=!0):O==="right"&&(N-=v-k.width,ue=!0),U(e.calendarContainer,"arrowLeft",!be&&!ue),U(e.calendarContainer,"arrowCenter",be),U(e.calendarContainer,"arrowRight",ue);var _t=window.document.body.offsetWidth-(window.pageXOffset+k.right),nt=N+v>window.document.body.offsetWidth,dc=_t+v>window.document.body.offsetWidth;if(U(e.calendarContainer,"rightMost",nt),!e.config.static)if(e.calendarContainer.style.top=D+"px",!nt)e.calendarContainer.style.left=N+"px",e.calendarContainer.style.right="auto";else if(!dc)e.calendarContainer.style.left="auto",e.calendarContainer.style.right=_t+"px";else{var Hn=tc();if(Hn===void 0)return;var fc=window.document.body.offsetWidth,pc=Math.max(0,fc/2-v/2),mc=".flatpickr-calendar.centerMost:before",gc=".flatpickr-calendar.centerMost:after",vc=Hn.cssRules.length,_c="{left:"+k.left+"px;right:auto;}";U(e.calendarContainer,"rightMost",!1),U(e.calendarContainer,"centerMost",!0),Hn.insertRule(mc+","+gc+_c,vc),e.calendarContainer.style.left=pc+"px",e.calendarContainer.style.right="auto"}}}}function tc(){for(var u=null,d=0;d<document.styleSheets.length;d++){var p=document.styleSheets[d];if(p.cssRules){try{p.cssRules}catch(v){continue}u=p;break}}return u!=null?u:nc()}function nc(){var u=document.createElement("style");return document.head.appendChild(u),u.sheet}function br(){e.config.noCalendar||e.isMobile||(Be(),Gt(),ge())}function Nn(){e._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(e.close,0):e.close()}function wr(u){u.preventDefault(),u.stopPropagation();var d=function(D){return D.classList&&D.classList.contains("flatpickr-day")&&!D.classList.contains("flatpickr-disabled")&&!D.classList.contains("notAllowed")},p=qn(se(u),d);if(p!==void 0){var v=p,w=e.latestSelectedDateObj=new Date(v.dateObj.getTime()),E=(w.getMonth()<e.currentMonth||w.getMonth()>e.currentMonth+e.config.showMonths-1)&&e.config.mode!=="range";if(e.selectedDateElem=v,e.config.mode==="single")e.selectedDates=[w];else if(e.config.mode==="multiple"){var O=$n(w);O?e.selectedDates.splice(parseInt(O),1):e.selectedDates.push(w)}else e.config.mode==="range"&&(e.selectedDates.length===2&&e.clear(!1,!1),e.latestSelectedDateObj=w,e.selectedDates.push(w),ae(w,e.selectedDates[0],!0)!==0&&e.selectedDates.sort(function(D,N){return D.getTime()-N.getTime()}));if(f(),E){var k=e.currentYear!==w.getFullYear();e.currentYear=w.getFullYear(),e.currentMonth=w.getMonth(),k&&(B("onYearChange"),Be()),B("onMonthChange")}if(Gt(),ge(),Ce(),!E&&e.config.mode!=="range"&&e.config.showMonths===1?W(v):e.selectedDateElem!==void 0&&e.hourElement===void 0&&e.selectedDateElem&&e.selectedDateElem.focus(),e.hourElement!==void 0&&e.hourElement!==void 0&&e.hourElement.focus(),e.config.closeOnSelect){var P=e.config.mode==="single"&&!e.config.enableTime,S=e.config.mode==="range"&&e.selectedDates.length===2&&!e.config.enableTime;(P||S)&&Nn()}C()}}var Yt={locale:[yr,mr],showMonths:[qe,o,pr],minDate:[j],maxDate:[j],positionElement:[Sr],clickOpens:[function(){e.config.clickOpens===!0?(_(e._input,"focus",e.open),_(e._input,"click",e.open)):(e._input.removeEventListener("focus",e.open),e._input.removeEventListener("click",e.open))}]};function ic(u,d){if(u!==null&&typeof u=="object"){Object.assign(e.config,u);for(var p in u)Yt[p]!==void 0&&Yt[p].forEach(function(v){return v()})}else e.config[u]=d,Yt[u]!==void 0?Yt[u].forEach(function(v){return v()}):V.indexOf(u)>-1&&(e.config[u]=Pe(d));e.redraw(),Ce(!0)}function Er(u,d){var p=[];if(u instanceof Array)p=u.map(function(v){return e.parseDate(v,d)});else if(u instanceof Date||typeof u=="number")p=[e.parseDate(u,d)];else if(typeof u=="string")switch(e.config.mode){case"single":case"time":p=[e.parseDate(u,d)];break;case"multiple":p=u.split(e.config.conjunction).map(function(v){return e.parseDate(v,d)});break;case"range":p=u.split(e.l10n.rangeSeparator).map(function(v){return e.parseDate(v,d)});break}else e.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(u)));e.selectedDates=e.config.allowInvalidPreload?p:p.filter(function(v){return v instanceof Date&&Ke(v,!1)}),e.config.mode==="range"&&e.selectedDates.sort(function(v,w){return v.getTime()-w.getTime()})}function rc(u,d,p){if(d===void 0&&(d=!1),p===void 0&&(p=e.config.dateFormat),u!==0&&!u||u instanceof Array&&u.length===0)return e.clear(d);Er(u,p),e.latestSelectedDateObj=e.selectedDates[e.selectedDates.length-1],e.redraw(),j(void 0,d),m(),e.selectedDates.length===0&&e.clear(!1),Ce(d),d&&B("onChange")}function Cr(u){return u.slice().map(function(d){return typeof d=="string"||typeof d=="number"||d instanceof Date?e.parseDate(d,void 0,!0):d&&typeof d=="object"&&d.from&&d.to?{from:e.parseDate(d.from,void 0),to:e.parseDate(d.to,void 0)}:d}).filter(function(d){return d})}function sc(){e.selectedDates=[],e.now=e.parseDate(e.config.now)||new Date;var u=e.config.defaultDate||((e.input.nodeName==="INPUT"||e.input.nodeName==="TEXTAREA")&&e.input.placeholder&&e.input.value===e.input.placeholder?null:e.input.value);u&&Er(u,e.config.dateFormat),e._initialDate=e.selectedDates.length>0?e.selectedDates[0]:e.config.minDate&&e.config.minDate.getTime()>e.now.getTime()?e.config.minDate:e.config.maxDate&&e.config.maxDate.getTime()<e.now.getTime()?e.config.maxDate:e.now,e.currentYear=e._initialDate.getFullYear(),e.currentMonth=e._initialDate.getMonth(),e.selectedDates.length>0&&(e.latestSelectedDateObj=e.selectedDates[0]),e.config.minTime!==void 0&&(e.config.minTime=e.parseDate(e.config.minTime,"H:i")),e.config.maxTime!==void 0&&(e.config.maxTime=e.parseDate(e.config.maxTime,"H:i")),e.minDateHasTime=!!e.config.minDate&&(e.config.minDate.getHours()>0||e.config.minDate.getMinutes()>0||e.config.minDate.getSeconds()>0),e.maxDateHasTime=!!e.config.maxDate&&(e.config.maxDate.getHours()>0||e.config.maxDate.getMinutes()>0||e.config.maxDate.getSeconds()>0)}function ac(){if(e.input=_r(),!e.input){e.config.errorHandler(new Error("Invalid input element specified"));return}e.input._type=e.input.type,e.input.type="text",e.input.classList.add("flatpickr-input"),e._input=e.input,e.config.altInput&&(e.altInput=M(e.input.nodeName,e.config.altInputClass),e._input=e.altInput,e.altInput.placeholder=e.input.placeholder,e.altInput.disabled=e.input.disabled,e.altInput.required=e.input.required,e.altInput.tabIndex=e.input.tabIndex,e.altInput.type="text",e.input.setAttribute("type","hidden"),!e.config.static&&e.input.parentNode&&e.input.parentNode.insertBefore(e.altInput,e.input.nextSibling)),e.config.allowInput||e._input.setAttribute("readonly","readonly"),Sr()}function Sr(){e._positionElement=e.config.positionElement||e._input}function oc(){var u=e.config.enableTime?e.config.noCalendar?"time":"datetime-local":"date";e.mobileInput=M("input",e.input.className+" flatpickr-mobile"),e.mobileInput.tabIndex=1,e.mobileInput.type=u,e.mobileInput.disabled=e.input.disabled,e.mobileInput.required=e.input.required,e.mobileInput.placeholder=e.input.placeholder,e.mobileFormatStr=u==="datetime-local"?"Y-m-d\\TH:i:S":u==="date"?"Y-m-d":"H:i:S",e.selectedDates.length>0&&(e.mobileInput.defaultValue=e.mobileInput.value=e.formatDate(e.selectedDates[0],e.mobileFormatStr)),e.config.minDate&&(e.mobileInput.min=e.formatDate(e.config.minDate,"Y-m-d")),e.config.maxDate&&(e.mobileInput.max=e.formatDate(e.config.maxDate,"Y-m-d")),e.input.getAttribute("step")&&(e.mobileInput.step=String(e.input.getAttribute("step"))),e.input.type="hidden",e.altInput!==void 0&&(e.altInput.type="hidden");try{e.input.parentNode&&e.input.parentNode.insertBefore(e.mobileInput,e.input.nextSibling)}catch(d){}_(e.mobileInput,"change",function(d){e.setDate(se(d).value,!1,e.mobileFormatStr),B("onChange"),B("onClose")})}function lc(u){if(e.isOpen===!0)return e.close();e.open(u)}function B(u,d){if(e.config!==void 0){var p=e.config[u];if(p!==void 0&&p.length>0)for(var v=0;p[v]&&v<p.length;v++)p[v](e.selectedDates,e.input.value,e,d);u==="onChange"&&(e.input.dispatchEvent(Fn("change")),e.input.dispatchEvent(Fn("input")))}}function Fn(u){var d=document.createEvent("Event");return d.initEvent(u,!0,!0),d}function $n(u){for(var d=0;d<e.selectedDates.length;d++){var p=e.selectedDates[d];if(p instanceof Date&&ae(p,u)===0)return""+d}return!1}function cc(u){return e.config.mode!=="range"||e.selectedDates.length<2?!1:ae(u,e.selectedDates[0])>=0&&ae(u,e.selectedDates[1])<=0}function Gt(){e.config.noCalendar||e.isMobile||!e.monthNav||(e.yearElements.forEach(function(u,d){var p=new Date(e.currentYear,e.currentMonth,1);p.setMonth(e.currentMonth+d),e.config.showMonths>1||e.config.monthSelectorType==="static"?e.monthElements[d].textContent=Et(p.getMonth(),e.config.shorthandCurrentMonth,e.l10n)+" ":e.monthsDropdownContainer.value=p.getMonth().toString(),u.value=p.getFullYear().toString()}),e._hidePrevMonthArrow=e.config.minDate!==void 0&&(e.currentYear===e.config.minDate.getFullYear()?e.currentMonth<=e.config.minDate.getMonth():e.currentYear<e.config.minDate.getFullYear()),e._hideNextMonthArrow=e.config.maxDate!==void 0&&(e.currentYear===e.config.maxDate.getFullYear()?e.currentMonth+1>e.config.maxDate.getMonth():e.currentYear>e.config.maxDate.getFullYear()))}function Un(u){var d=u||(e.config.altInput?e.config.altFormat:e.config.dateFormat);return e.selectedDates.map(function(p){return e.formatDate(p,d)}).filter(function(p,v,w){return e.config.mode!=="range"||e.config.enableTime||w.indexOf(p)===v}).join(e.config.mode!=="range"?e.config.conjunction:e.l10n.rangeSeparator)}function Ce(u){u===void 0&&(u=!0),e.mobileInput!==void 0&&e.mobileFormatStr&&(e.mobileInput.value=e.latestSelectedDateObj!==void 0?e.formatDate(e.latestSelectedDateObj,e.mobileFormatStr):""),e.input.value=Un(e.config.dateFormat),e.altInput!==void 0&&(e.altInput.value=Un(e.config.altFormat)),u!==!1&&B("onValueUpdate")}function uc(u){var d=se(u),p=e.prevMonthNav.contains(d),v=e.nextMonthNav.contains(d);p||v?jn(p?-1:1):e.yearElements.indexOf(d)>=0?d.select():d.classList.contains("arrowUp")?e.changeYear(e.currentYear+1):d.classList.contains("arrowDown")&&e.changeYear(e.currentYear-1)}function hc(u){u.preventDefault();var d=u.type==="keydown",p=se(u),v=p;e.amPM!==void 0&&p===e.amPM&&(e.amPM.textContent=e.l10n.amPM[Z(e.amPM.textContent===e.l10n.amPM[0])]);var w=parseFloat(v.getAttribute("min")),E=parseFloat(v.getAttribute("max")),O=parseFloat(v.getAttribute("step")),k=parseInt(v.value,10),P=u.delta||(d?u.which===38?1:-1:0),S=k+O*P;if(typeof v.value!="undefined"&&v.value.length===2){var D=v===e.hourElement,N=v===e.minuteElement;S<w?(S=E+S+Z(!D)+(Z(D)&&Z(!e.amPM)),N&&$(void 0,-1,e.hourElement)):S>E&&(S=v===e.hourElement?S-E-Z(!e.amPM):w,N&&$(void 0,1,e.hourElement)),e.amPM&&D&&(O===1?S+k===23:Math.abs(S-k)>O)&&(e.amPM.textContent=e.l10n.amPM[Z(e.amPM.textContent===e.l10n.amPM[0])]),v.value=G(S)}}return r(),e}function We(n,t){for(var e=Array.prototype.slice.call(n).filter(function(a){return a instanceof HTMLElement}),i=[],r=0;r<e.length;r++){var s=e[r];try{if(s.getAttribute("data-fp-omit")!==null)continue;s._flatpickr!==void 0&&(s._flatpickr.destroy(),s._flatpickr=void 0),s._flatpickr=Lr(s,t||{}),i.push(s._flatpickr)}catch(a){console.error(a)}}return i.length===1?i[0]:i}typeof HTMLElement!="undefined"&&typeof HTMLCollection!="undefined"&&typeof NodeList!="undefined"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(n){return We(this,n)},HTMLElement.prototype.flatpickr=function(n){return We([this],n)});var H=function(n,t){return typeof n=="string"?We(window.document.querySelectorAll(n),t):n instanceof Node?We([n],t):We(n,t)};H.defaultConfig={},H.l10ns={en:J({},xe),default:J({},xe)},H.localize=function(n){H.l10ns.default=J(J({},H.l10ns.default),n)},H.setDefaults=function(n){H.defaultConfig=J(J({},H.defaultConfig),n)},H.parseDate=Jt({}),H.formatDate=Kn({}),H.compareDates=ae,typeof jQuery!="undefined"&&typeof jQuery.fn!="undefined"&&(jQuery.fn.flatpickr=function(n){return We(this,n)}),Date.prototype.fp_incr=function(n){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof n=="string"?parseInt(n,10):n))},typeof window!="undefined"&&(window.flatpickr=H);const Vn=()=>{const n=document.querySelector("#i-pickup-date"),t=document.querySelector("#i-return-date"),e=document.querySelector("#v-pickup-date"),i=document.querySelector("#v-return-date"),r=document.querySelector("#v-calc-duration");if(n.value){const s=new Date(n.value);e.textContent=Yn(s)}if(t.value){const s=new Date(t.value);i.textContent=Yn(s)}if(n.value&&t.value){const s=jr(new Date(n.value),new Date(t.value));r.textContent=s}},Yn=n=>n.toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),jr=(n,t)=>{const e=t-n;return Math.ceil(e/(1e3*60*60*24))};function Rr(){const n=document.querySelector("#pickup-confirmation"),t=document.querySelector("#i-pickup-location"),e=document.querySelector("#i-return-location"),i=document.querySelector("#v-calc-delivery-fee"),r=document.querySelector("#v-pickup-location"),s=document.querySelector("#v-return-location");t.closest(".input-dropdown").style.display="none",e.closest(".input-dropdown").style.display="none",t.addEventListener("change",function(){this.selectedIndex!==0&&(r.textContent=this.options[this.selectedIndex].text)}),e.addEventListener("change",function(){this.selectedIndex!==0&&(s.textContent=this.options[this.selectedIndex].text)}),n.addEventListener("change",function(){const a=this.checked?"block":"none";t.closest(".input-dropdown").style.display=a,e.closest(".input-dropdown").style.display=a,i.textContent=this.checked?"250.00":"0.00",this.checked||(t.selectedIndex=0,e.selectedIndex=0,r.textContent="-",s.textContent="-")})}function Nr(){let n,t;const e={enableTime:!0,dateFormat:"Y-m-d H:i",minDate:"today",time_24hr:!0,minuteIncrement:30,onChange:function(a){if(t){t.set("minDate",a[0]);const o=t.selectedDates[0];o&&o<a[0]&&(t.clear(),Gn("Return date cannot be earlier than pickup date. Please select a new return date."))}Vn()}},i={enableTime:!0,dateFormat:"Y-m-d H:i",minDate:"today",time_24hr:!0,minuteIncrement:30,onChange:function(a){const o=n.selectedDates[0];if(o&&a[0]<o){t.clear(),Gn("Return date cannot be earlier than pickup date. Please select a valid date.");return}Vn()}};n=H("#i-pickup-date",e),t=H("#i-return-date",i);const r={dateFormat:"Y-m-d",maxDate:new Date,yearRange:[1900,new Date().getFullYear()]},s={dateFormat:"Y-m-d",minDate:"today"};H("#i-date-of-birth",r),H("#i-expiration-date",s),Rr()}function Gn(n){const t=document.querySelector("#i-return-date").closest(".f-field-wrapper").querySelector(".error-alert-bg");t.querySelector(".error-alert-text").textContent=n,t.classList.remove("is-hidden"),setTimeout(()=>{t.classList.add("is-hidden")},5e3)}const Ct=[{id:1,name:"NAD-45-000.00-Excess-Waiver",baseFee:45e3,perDay:!1,displayName:"NAD 45,000.00 Excess Waiver"},{id:2,name:"Tyre-Glass-Waiver",baseFee:165,perDay:!0,displayName:"Tyre & Glass Waiver @ 165.00 p.d"},{id:3,name:"Cross-Border-Charge",baseFee:100,perDay:!1,displayName:"Cross Border Charge @ 100.00"},{id:4,name:"Satellite-Phone-N-6000-Excess",baseFee:140,perDay:!0,displayName:"Satellite Phone (N$6000 Excess) @ 140.00 p.d"},{id:5,name:"Satellite-Phone-Zero-Excess",baseFee:170,perDay:!0,displayName:"Satellite Phone (Zero Excess) @ 170.00 p.d"},{id:6,name:"Camping-Equipment---Double-Cab",baseFee:170,perDay:!0,displayName:"Camping Equipment - Double Cab @ NAD 170.00 p.d"},{id:7,name:"Roof-Tents-Required",baseFee:60,perDay:!0,displayName:"Roof Tents Required @ NAD 60.00 p.d"},{id:8,name:"Engel-40L-Fridge-Freezer",baseFee:90,perDay:!0,displayName:"Engel 40L Fridge/Freezer @ 90.00 p.d"},{id:9,name:"Bedding-incl.-1x-sleeping-bag-1x-pillow",baseFee:20,perDay:!0,displayName:"Bedding (incl. 1x sleeping bag + 1x pillow) @ 20.00 p.d"},{id:10,name:"GPS-System",baseFee:75,perDay:!0,displayName:"GPS System @ 75.00 p.d"},{id:11,name:"SAT-Phone-Minutes",baseFee:825,perDay:!1,displayName:"SAT Phone Minutes @ 825.00 once.off"},{id:12,name:"Kitchen-wash-up-kit-small-dish-wash-liquid-2x-drying-cloth-2x-sponge-2x-cleaning-cloth-extras",baseFee:150,perDay:!1,displayName:"Kitchen wash up kit @ 150.00 once.off"},{id:13,name:"Ground-Tent",baseFee:0,perDay:!1,displayName:"Free Ground Tent"},{id:14,name:"Jerry-Can",baseFee:10,perDay:!0,displayName:"Jerry Can @ 10.00 p.d"},{id:15,name:"Baby-Seat",baseFee:0,perDay:!1,displayName:"Free Baby Seat"}].map(n=>Dr(Bn({},n),{key:`extra-${n.id}`,inputId:`i-extra-${n.id}`,countId:`i-count-extra-${n.id}`,displayId:`v-calc-extra-${n.id}`,getElements(){return{checkbox:document.querySelector(`#${this.inputId}`),quantity:document.querySelector(`#${this.countId}`),display:document.querySelector(`#${this.displayId}`)}},isValid(){const t=this.getElements();return t.checkbox&&t.quantity&&t.display}})),zn=n=>{var a;const t=Ct.find(o=>o.id===n);if(!t||!t.isValid())return;const e=t.getElements(),i=parseInt(e.quantity.value)||0,r=parseInt((a=document.querySelector("#v-calc-duration"))==null?void 0:a.textContent)||0,s=t.perDay?t.baseFee*i*r:t.baseFee*i;e.display.textContent=s.toFixed(2),Zt()},Zt=()=>{const n=document.querySelector("#v-calc-total-extra");if(!n)return;const t=Ct.reduce((e,i)=>{if(!i.isValid())return e;const r=i.getElements();return!r.checkbox.checked||r.display.textContent==="-"?e:e+parseFloat(r.display.textContent||"0")},0);n.textContent=t.toFixed(2)},Fr=()=>{const n=Ct.reduce((e,i)=>{if(!i.isValid())return e;const r=i.getElements();return!r.checkbox.checked||r.display.textContent==="-"?e:e+parseFloat(r.display.textContent||"0")},0),t=document.querySelector("#v-calc-total-extra");return t&&(t.textContent=n.toFixed(2)),n},$r=()=>{Ct.forEach(n=>{if(!n.isValid())return;const t=n.getElements();t.checkbox.addEventListener("change",()=>{t.checkbox.checked?(t.quantity.value=t.quantity.value||"1",zn(n.id)):(t.quantity.value="",t.display.textContent="-",Zt()),St()}),t.quantity.addEventListener("change",()=>{t.checkbox.checked&&(zn(n.id),St())})}),Zt()},Ur=.15,Le={vehiclePrice:"#v-calc-vehicle-price",duration:"#v-calc-duration",deliveryFee:"#v-calc-delivery-fee",totalExtra:"#v-calc-total-extra",tax:"#v-calc-tax",subtotal:"#v-calc-subtotal",total:"#v-calc-total"},en=(n,t=0,e=parseFloat)=>{try{const i=document.querySelector(n);if(!i)return t;const r=e((i==null?void 0:i.textContent)||t);return isNaN(r)?t:r}catch(i){return t}},Hr=(n,t)=>{try{const e=document.querySelector(n);e&&(e.textContent=t.toFixed(2))}catch(e){}},St=()=>{try{const n={vehiclePrice:en(Le.vehiclePrice),duration:en(Le.duration,0,parseInt),deliveryFee:en(Le.deliveryFee)},t={extrasTotal:Fr(),vehicleCost:n.vehiclePrice*n.duration},e=t.vehicleCost+t.extrasTotal+n.deliveryFee,i=e*Ur,r=e+i,s={[Le.totalExtra]:t.extrasTotal,[Le.tax]:i,[Le.subtotal]:e,[Le.total]:r};return Object.entries(s).forEach(([a,o])=>{Hr(a,o)}),{subtotal:e,tax:i,total:r}}catch(n){return{subtotal:0,tax:0,total:0}}},Br=()=>{document.querySelectorAll('input[name="vehicle"]').forEach(t=>{t.addEventListener("change",e=>{const i=e.target.closest(".f-radio-field").querySelector(".vehicle-name").textContent,r=parseFloat(e.target.value);document.querySelector("#v-vehicle-name").textContent=i,document.querySelector("#v-calc-vehicle-price").textContent=r.toFixed(2),St()})})};let tn={NAD:1,USD:.054,EUR:.049,GBP:.042};const qr={NAD:{symbol:"N$",decimals:2},USD:{symbol:"$",decimals:2},EUR:{symbol:"€",decimals:2},GBP:{symbol:"£",decimals:2}},Kr=36e5;let Jn=0;function Wr(){return g(this,null,function*(){const n=Date.now();if(n-Jn<Kr)return;const t=yield ts();t&&(tn=Bn({},t),Jn=n)})}const Vr=()=>g(this,null,function*(){try{if(yield Wr(),!document.querySelectorAll('input[name="currency-group"]').length)throw new Error("No currency inputs found");const t=document.getElementById("i-currency-nad");t&&(t.checked=!0,Qn("NAD"));const e=document.querySelector('[name="currency-group"]').closest("form");e&&e.addEventListener("change",i=>{i.target.name==="currency-group"&&Yr(i)})}catch(n){console.error("Failed to initialize currency toggle:",n),Xn("Currency initialization failed")}});function Yr(n){const t=n.target.value;Qn(t)}const Qn=n=>{try{Gr(n),zr(n),Xr(n)}catch(t){console.error("Error updating currency:",t),Xn(`Failed to update currency: ${t.message}`)}};function Xn(n){const t=document.querySelector(".error-alert-bg");t&&(t.querySelector(".error-alert-text").textContent=n,t.classList.remove("is-hidden"),setTimeout(()=>t.classList.add("is-hidden"),5e3))}function Gr(n){if(!tn[n])throw new Error(`Invalid currency: ${n}`)}function zr(n){const t=tn[n],e=qr[n];document.querySelectorAll('[id^="v-calc-"]').forEach(i=>{if(i.id==="v-calc-duration"||i.textContent==="-")return;if(!i.hasAttribute("data-original-price")&&i.textContent!=="-"){const s=i.textContent.trim();i.setAttribute("data-original-price",s)}const r=parseFloat(i.getAttribute("data-original-price"));if(!isNaN(r)){const s=(r*t).toFixed(e.decimals);(i.id==="v-calc-vehicle-price"||i.id.startsWith("v-calc-extra-")||i.id==="v-calc-delivery-fee"||i.id.startsWith("v-calc-veh-price-p-")||i.classList.contains("vehicle-value"))&&(i.textContent=s)}}),Jr(t,e.decimals),Qr(t,e.decimals)}function Jr(n,t){const e=document.querySelector("#v-calc-total-extra");if(!e)return;let i=0;document.querySelectorAll('[id^="v-calc-extra-"]').forEach(s=>{if(s.textContent!=="-"){const a=parseFloat(s.getAttribute("data-original-price"));isNaN(a)||(i+=a)}});const r=(i*n).toFixed(t);e.textContent=r,e.hasAttribute("data-original-price")||e.setAttribute("data-original-price",i.toString())}function Qr(n,t){var c,f,m,y;const e={subtotal:document.querySelector("#v-calc-subtotal"),tax:document.querySelector("#v-calc-tax"),total:document.querySelector("#v-calc-total")},i=parseFloat(((c=document.querySelector("#v-calc-vehicle-price"))==null?void 0:c.getAttribute("data-original-price"))||"0"),r=parseInt(((f=document.querySelector("#v-calc-duration"))==null?void 0:f.textContent)||"0"),s=parseFloat(((m=document.querySelector("#v-calc-delivery-fee"))==null?void 0:m.getAttribute("data-original-price"))||"0"),a=parseFloat(((y=document.querySelector("#v-calc-total-extra"))==null?void 0:y.getAttribute("data-original-price"))||"0"),o=i*r+s+a,l=o*.15,h=o+l;e.subtotal&&(e.subtotal.textContent=(o*n).toFixed(t),e.subtotal.setAttribute("data-original-price",o.toString())),e.tax&&(e.tax.textContent=(l*n).toFixed(t),e.tax.setAttribute("data-original-price",l.toString())),e.total&&(e.total.textContent=(h*n).toFixed(t),e.total.setAttribute("data-original-price",h.toString()))}function Xr(n){document.querySelectorAll(".currency-symbol").forEach(t=>{t.textContent=n})}const Zr="f8eb8575dc0df45769f9bc6c",es="https://v6.exchangerate-api.com/v6";function ts(n="NAD"){return g(this,null,function*(){try{const t=new AbortController,e=setTimeout(()=>t.abort(),5e3),i=yield fetch(`${es}/${Zr}/latest/${n}`,{signal:t.signal});if(clearTimeout(e),!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const r=yield i.json();if(r.result==="success")return r.conversion_rates;throw new Error(r["error-type"]||"Failed to fetch exchange rates")}catch(t){return t.name==="AbortError"?console.error("Request timed out"):console.error("Error fetching exchange rates:",t),null}})}/*! choices.js v11.0.2 | © 2024 Josh Johnson | https://github.com/jshjohnson/Choices#readme */var nn=function(n,t){return nn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])},nn(n,t)};function Zn(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");nn(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var ee=function(){return ee=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++){e=arguments[i];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},ee.apply(this,arguments)};function ns(n,t,e){if(e||arguments.length===2)for(var i=0,r=t.length,s;i<r;i++)(s||!(i in t))&&(s||(s=Array.prototype.slice.call(t,0,i)),s[i]=t[i]);return n.concat(s||Array.prototype.slice.call(t))}typeof SuppressedError=="function"&&SuppressedError;var K={ADD_CHOICE:"ADD_CHOICE",REMOVE_CHOICE:"REMOVE_CHOICE",FILTER_CHOICES:"FILTER_CHOICES",ACTIVATE_CHOICES:"ACTIVATE_CHOICES",CLEAR_CHOICES:"CLEAR_CHOICES",ADD_GROUP:"ADD_GROUP",ADD_ITEM:"ADD_ITEM",REMOVE_ITEM:"REMOVE_ITEM",HIGHLIGHT_ITEM:"HIGHLIGHT_ITEM"},te={showDropdown:"showDropdown",hideDropdown:"hideDropdown",change:"change",choice:"choice",search:"search",addItem:"addItem",removeItem:"removeItem",highlightItem:"highlightItem",highlightChoice:"highlightChoice",unhighlightItem:"unhighlightItem"},is=["fuseOptions","classNames"],Se={Text:"text",SelectOne:"select-one",SelectMultiple:"select-multiple"},rs=function(n){return{type:K.ADD_CHOICE,choice:n}},ei=function(n){return{type:K.REMOVE_CHOICE,choice:n}},ss=function(n){return{type:K.FILTER_CHOICES,results:n}},as=function(n){return{type:K.ACTIVATE_CHOICES,active:n}},os=function(n){return{type:K.ADD_GROUP,group:n}},ls=function(n){return{type:K.ADD_ITEM,item:n}},ti=function(n){return{type:K.REMOVE_ITEM,item:n}},kt=function(n,t){return{type:K.HIGHLIGHT_ITEM,item:n,highlighted:t}},cs=function(n,t){return Math.floor(Math.random()*(t-n)+n)},ni=function(n){return Array.from({length:n},function(){return cs(0,36).toString(36)}).join("")},us=function(n,t){var e=n.id||n.name&&"".concat(n.name,"-").concat(ni(2))||ni(4);return e=e.replace(/(:|\.|\[|\]|,)/g,""),e="".concat(t,"-").concat(e),e},hs=function(n,t,e){e===void 0&&(e=1);for(var i="".concat(e>0?"next":"previous","ElementSibling"),r=n[i];r;){if(r.matches(t))return r;r=r[i]}return null},ds=function(n,t,e){e===void 0&&(e=1);var i;return e>0?i=t.scrollTop+t.offsetHeight>=n.offsetTop+n.offsetHeight:i=n.offsetTop>=t.scrollTop,i},Tt=function(n){if(typeof n!="string"){if(n==null)return"";if(typeof n=="object"){if("raw"in n)return Tt(n.raw);if("trusted"in n)return n.trusted}return n}return n.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;")},fs=function(){var n=document.createElement("div");return function(t){n.innerHTML=t.trim();for(var e=n.children[0];n.firstChild;)n.removeChild(n.firstChild);return e}}(),rt=function(n,t){return typeof n=="function"?n(Tt(t),t):n},ii=function(n){return typeof n=="function"?n():n},je=function(n){if(typeof n=="string")return n;if(typeof n=="object"){if("trusted"in n)return n.trusted;if("raw"in n)return n.raw}return""},ps=function(n){if(typeof n=="string")return n;if(typeof n=="object"){if("escaped"in n)return n.escaped;if("trusted"in n)return n.trusted}return""},rn=function(n,t){return n?ps(t):Tt(t)},we=function(n,t,e){n.innerHTML=rn(t,e)},ms=function(n,t){var e=n.value,i=n.label,r=i===void 0?e:i,s=t.value,a=t.label,o=a===void 0?s:a;return je(r).localeCompare(je(o),[],{sensitivity:"base",ignorePunctuation:!0,numeric:!0})},gs=function(n,t){return n.rank-t.rank},vs=function(n,t,e){e===void 0&&(e=null);var i=new CustomEvent(t,{detail:e,bubbles:!0,cancelable:!0});return n.dispatchEvent(i)},_s=function(n,t){var e=Object.keys(n).sort(),i=Object.keys(t).sort();return e.filter(function(r){return i.indexOf(r)<0})},Dt=function(n){return Array.isArray(n)?n:[n]},st=function(n){return n&&Array.isArray(n)?n.map(function(t){return".".concat(t)}).join(""):".".concat(n)},A=function(n,t){var e;(e=n.classList).add.apply(e,Dt(t))},ve=function(n,t){var e;(e=n.classList).remove.apply(e,Dt(t))},ys=function(n){if(typeof n!="undefined")try{return JSON.parse(n)}catch(t){return n}return{}},bs=function(n,t,e){var i=n.itemEl;i&&(ve(i,e),A(i,t))},ws=function(){function n(t){var e=t.element,i=t.type,r=t.classNames;this.element=e,this.classNames=r,this.type=i,this.isActive=!1}return n.prototype.show=function(){return A(this.element,this.classNames.activeState),this.element.setAttribute("aria-expanded","true"),this.isActive=!0,this},n.prototype.hide=function(){return ve(this.element,this.classNames.activeState),this.element.setAttribute("aria-expanded","false"),this.isActive=!1,this},n}(),ri=function(){function n(t){var e=t.element,i=t.type,r=t.classNames,s=t.position;this.element=e,this.classNames=r,this.type=i,this.position=s,this.isOpen=!1,this.isFlipped=!1,this.isDisabled=!1,this.isLoading=!1}return n.prototype.shouldFlip=function(t,e){var i=!1;return this.position==="auto"?i=this.element.getBoundingClientRect().top-e>=0&&!window.matchMedia("(min-height: ".concat(t+1,"px)")).matches:this.position==="top"&&(i=!0),i},n.prototype.setActiveDescendant=function(t){this.element.setAttribute("aria-activedescendant",t)},n.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},n.prototype.open=function(t,e){A(this.element,this.classNames.openState),this.element.setAttribute("aria-expanded","true"),this.isOpen=!0,this.shouldFlip(t,e)&&(A(this.element,this.classNames.flippedState),this.isFlipped=!0)},n.prototype.close=function(){ve(this.element,this.classNames.openState),this.element.setAttribute("aria-expanded","false"),this.removeActiveDescendant(),this.isOpen=!1,this.isFlipped&&(ve(this.element,this.classNames.flippedState),this.isFlipped=!1)},n.prototype.addFocusState=function(){A(this.element,this.classNames.focusState)},n.prototype.removeFocusState=function(){ve(this.element,this.classNames.focusState)},n.prototype.enable=function(){ve(this.element,this.classNames.disabledState),this.element.removeAttribute("aria-disabled"),this.type===Se.SelectOne&&this.element.setAttribute("tabindex","0"),this.isDisabled=!1},n.prototype.disable=function(){A(this.element,this.classNames.disabledState),this.element.setAttribute("aria-disabled","true"),this.type===Se.SelectOne&&this.element.setAttribute("tabindex","-1"),this.isDisabled=!0},n.prototype.wrap=function(t){var e=this.element,i=t.parentNode;i&&(t.nextSibling?i.insertBefore(e,t.nextSibling):i.appendChild(e)),e.appendChild(t)},n.prototype.unwrap=function(t){var e=this.element,i=e.parentNode;i&&(i.insertBefore(t,e),i.removeChild(e))},n.prototype.addLoadingState=function(){A(this.element,this.classNames.loadingState),this.element.setAttribute("aria-busy","true"),this.isLoading=!0},n.prototype.removeLoadingState=function(){ve(this.element,this.classNames.loadingState),this.element.removeAttribute("aria-busy"),this.isLoading=!1},n}(),Es=function(){function n(t){var e=t.element,i=t.type,r=t.classNames,s=t.preventPaste;this.element=e,this.type=i,this.classNames=r,this.preventPaste=s,this.isFocussed=this.element.isEqualNode(document.activeElement),this.isDisabled=e.disabled,this._onPaste=this._onPaste.bind(this),this._onInput=this._onInput.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}return Object.defineProperty(n.prototype,"placeholder",{set:function(t){this.element.placeholder=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this.element.value},set:function(t){this.element.value=t},enumerable:!1,configurable:!0}),n.prototype.addEventListeners=function(){var t=this.element;t.addEventListener("paste",this._onPaste),t.addEventListener("input",this._onInput,{passive:!0}),t.addEventListener("focus",this._onFocus,{passive:!0}),t.addEventListener("blur",this._onBlur,{passive:!0})},n.prototype.removeEventListeners=function(){var t=this.element;t.removeEventListener("input",this._onInput),t.removeEventListener("paste",this._onPaste),t.removeEventListener("focus",this._onFocus),t.removeEventListener("blur",this._onBlur)},n.prototype.enable=function(){var t=this.element;t.removeAttribute("disabled"),this.isDisabled=!1},n.prototype.disable=function(){var t=this.element;t.setAttribute("disabled",""),this.isDisabled=!0},n.prototype.focus=function(){this.isFocussed||this.element.focus()},n.prototype.blur=function(){this.isFocussed&&this.element.blur()},n.prototype.clear=function(t){return t===void 0&&(t=!0),this.element.value="",t&&this.setWidth(),this},n.prototype.setWidth=function(){var t=this.element;t.style.minWidth="".concat(t.placeholder.length+1,"ch"),t.style.width="".concat(t.value.length+1,"ch")},n.prototype.setActiveDescendant=function(t){this.element.setAttribute("aria-activedescendant",t)},n.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},n.prototype._onInput=function(){this.type!==Se.SelectOne&&this.setWidth()},n.prototype._onPaste=function(t){this.preventPaste&&t.preventDefault()},n.prototype._onFocus=function(){this.isFocussed=!0},n.prototype._onBlur=function(){this.isFocussed=!1},n}(),Cs=4,si=function(){function n(t){var e=t.element;this.element=e,this.scrollPos=this.element.scrollTop,this.height=this.element.offsetHeight}return n.prototype.prepend=function(t){var e=this.element.firstElementChild;e?this.element.insertBefore(t,e):this.element.append(t)},n.prototype.scrollToTop=function(){this.element.scrollTop=0},n.prototype.scrollToChildElement=function(t,e){var i=this;if(t){var r=this.element.offsetHeight,s=this.element.scrollTop+r,a=t.offsetHeight,o=t.offsetTop+a,l=e>0?this.element.scrollTop+o-s:t.offsetTop;requestAnimationFrame(function(){i._animateScroll(l,e)})}},n.prototype._scrollDown=function(t,e,i){var r=(i-t)/e,s=r>1?r:1;this.element.scrollTop=t+s},n.prototype._scrollUp=function(t,e,i){var r=(t-i)/e,s=r>1?r:1;this.element.scrollTop=t-s},n.prototype._animateScroll=function(t,e){var i=this,r=Cs,s=this.element.scrollTop,a=!1;e>0?(this._scrollDown(s,r,t),s<t&&(a=!0)):(this._scrollUp(s,r,t),s>t&&(a=!0)),a&&requestAnimationFrame(function(){i._animateScroll(t,e)})},n}(),ai=function(){function n(t){var e=t.element,i=t.classNames;this.element=e,this.classNames=i,this.isDisabled=!1}return Object.defineProperty(n.prototype,"isActive",{get:function(){return this.element.dataset.choice==="active"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dir",{get:function(){return this.element.dir},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this.element.value},set:function(t){this.element.setAttribute("value",t),this.element.value=t},enumerable:!1,configurable:!0}),n.prototype.conceal=function(){var t=this.element;A(t,this.classNames.input),t.hidden=!0,t.tabIndex=-1;var e=t.getAttribute("style");e&&t.setAttribute("data-choice-orig-style",e),t.setAttribute("data-choice","active")},n.prototype.reveal=function(){var t=this.element;ve(t,this.classNames.input),t.hidden=!1,t.removeAttribute("tabindex");var e=t.getAttribute("data-choice-orig-style");e?(t.removeAttribute("data-choice-orig-style"),t.setAttribute("style",e)):t.removeAttribute("style"),t.removeAttribute("data-choice")},n.prototype.enable=function(){this.element.removeAttribute("disabled"),this.element.disabled=!1,this.isDisabled=!1},n.prototype.disable=function(){this.element.setAttribute("disabled",""),this.element.disabled=!0,this.isDisabled=!0},n.prototype.triggerEvent=function(t,e){vs(this.element,t,e||{})},n}(),Ss=function(n){Zn(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t}(ai),at=function(n,t){return t===void 0&&(t=!0),typeof n=="undefined"?t:!!n},oi=function(n){if(typeof n=="string"&&(n=n.split(" ").filter(function(t){return t.length})),Array.isArray(n)&&n.length)return n},_e=function(n,t){if(typeof n=="string"){var e=_e({value:n,label:n},!1);return e}var i=n;if("choices"in i){if(!t)throw new TypeError("optGroup is not allowed");var r=i,s=r.choices.map(function(h){return _e(h,!1)}),a={id:0,label:je(r.label)||r.value,active:!!s.length,disabled:!!r.disabled,choices:s};return a}var o=i,l={id:0,group:null,score:0,rank:0,value:o.value,label:o.label||o.value,active:at(o.active),selected:at(o.selected,!1),disabled:at(o.disabled,!1),placeholder:at(o.placeholder,!1),highlighted:!1,labelClass:oi(o.labelClass),labelDescription:o.labelDescription,customProperties:o.customProperties};return l},ks=function(n){return n.tagName==="INPUT"},li=function(n){return n.tagName==="SELECT"},Ts=function(n){return n.tagName==="OPTION"},Ds=function(n){return n.tagName==="OPTGROUP"},Is=function(n){Zn(t,n);function t(e){var i=e.element,r=e.classNames,s=e.template,a=e.extractPlaceholder,o=n.call(this,{element:i,classNames:r})||this;return o.template=s,o.extractPlaceholder=a,o}return Object.defineProperty(t.prototype,"placeholderOption",{get:function(){return this.element.querySelector('option[value=""]')||this.element.querySelector("option[placeholder]")},enumerable:!1,configurable:!0}),t.prototype.addOptions=function(e){var i=this,r=document.createDocumentFragment();e.forEach(function(s){var a=s;if(!a.element){var o=i.template(a);r.appendChild(o),a.element=o}}),this.element.appendChild(r)},t.prototype.optionsAsChoices=function(){var e=this,i=[];return this.element.querySelectorAll(":scope > option, :scope > optgroup").forEach(function(r){Ts(r)?i.push(e._optionToChoice(r)):Ds(r)&&i.push(e._optgroupToChoice(r))}),i},t.prototype._optionToChoice=function(e){return!e.hasAttribute("value")&&e.hasAttribute("placeholder")&&(e.setAttribute("value",""),e.value=""),{id:0,group:null,score:0,rank:0,value:e.value,label:e.innerHTML,element:e,active:!0,selected:this.extractPlaceholder?e.selected:e.hasAttribute("selected"),disabled:e.disabled,highlighted:!1,placeholder:this.extractPlaceholder&&(!e.value||e.hasAttribute("placeholder")),labelClass:typeof e.dataset.labelClass!="undefined"?oi(e.dataset.labelClass):void 0,labelDescription:typeof e.dataset.labelDescription!="undefined"?e.dataset.labelDescription:void 0,customProperties:ys(e.dataset.customProperties)}},t.prototype._optgroupToChoice=function(e){var i=this,r=e.querySelectorAll("option"),s=Array.from(r).map(function(a){return i._optionToChoice(a)});return{id:0,label:e.label||"",element:e,active:!!s.length,disabled:e.disabled,choices:s}},t}(ai),As={containerOuter:["choices"],containerInner:["choices__inner"],input:["choices__input"],inputCloned:["choices__input--cloned"],list:["choices__list"],listItems:["choices__list--multiple"],listSingle:["choices__list--single"],listDropdown:["choices__list--dropdown"],item:["choices__item"],itemSelectable:["choices__item--selectable"],itemDisabled:["choices__item--disabled"],itemChoice:["choices__item--choice"],description:["choices__description"],placeholder:["choices__placeholder"],group:["choices__group"],groupHeading:["choices__heading"],button:["choices__button"],activeState:["is-active"],focusState:["is-focused"],openState:["is-open"],disabledState:["is-disabled"],highlightedState:["is-highlighted"],selectedState:["is-selected"],flippedState:["is-flipped"],loadingState:["is-loading"],notice:["choices__notice"],addChoice:["choices__item--selectable","add-choice"],noResults:["has-no-results"],noChoices:["has-no-choices"]},ci={items:[],choices:[],silent:!1,renderChoiceLimit:-1,maxItemCount:-1,closeDropdownOnSelect:"auto",singleModeForMultiSelect:!1,addChoices:!1,addItems:!0,addItemFilter:function(n){return!!n&&n!==""},removeItems:!0,removeItemButton:!1,removeItemButtonAlignLeft:!1,editItems:!1,allowHTML:!1,allowHtmlUserInput:!1,duplicateItemsAllowed:!0,delimiter:",",paste:!0,searchEnabled:!0,searchChoices:!0,searchFloor:1,searchResultLimit:4,searchFields:["label","value"],position:"auto",resetScrollPosition:!0,shouldSort:!0,shouldSortItems:!1,sorter:ms,shadowRoot:null,placeholder:!0,placeholderValue:null,searchPlaceholderValue:null,prependValue:null,appendValue:null,renderSelectedChoices:"auto",loadingText:"Loading...",noResultsText:"No results found",noChoicesText:"No choices to choose from",itemSelectText:"Press to select",uniqueItemText:"Only unique values can be added",customAddItemText:"Only values matching specific conditions can be added",addItemText:function(n){return'Press Enter to add <b>"'.concat(n,'"</b>')},removeItemIconText:function(){return"Remove item"},removeItemLabelText:function(n){return"Remove item: ".concat(n)},maxItemText:function(n){return"Only ".concat(n," values can be added")},valueComparer:function(n,t){return n===t},fuseOptions:{includeScore:!0},labelId:"",callbackOnInit:null,callbackOnCreateTemplates:null,classNames:As,appendGroupInSearch:!1},ui=function(n){var t=n.itemEl;t&&(t.remove(),n.itemEl=void 0)};function Os(n,t,e){var i=n,r=!0;switch(t.type){case K.ADD_ITEM:{t.item.selected=!0;var s=t.item.element;s&&(s.selected=!0,s.setAttribute("selected","")),i.push(t.item);break}case K.REMOVE_ITEM:{t.item.selected=!1;var s=t.item.element;if(s){s.selected=!1,s.removeAttribute("selected");var a=s.parentElement;a&&li(a)&&a.type===Se.SelectOne&&(a.value="")}ui(t.item),i=i.filter(function(c){return c.id!==t.item.id});break}case K.REMOVE_CHOICE:{ui(t.choice),i=i.filter(function(h){return h.id!==t.choice.id});break}case K.HIGHLIGHT_ITEM:{var o=t.highlighted,l=i.find(function(h){return h.id===t.item.id});l&&l.highlighted!==o&&(l.highlighted=o,e&&bs(l,o?e.classNames.highlightedState:e.classNames.selectedState,o?e.classNames.selectedState:e.classNames.highlightedState));break}default:{r=!1;break}}return{state:i,update:r}}function xs(n,t){var e=n,i=!0;switch(t.type){case K.ADD_GROUP:{e.push(t.group);break}case K.CLEAR_CHOICES:{e=[];break}default:{i=!1;break}}return{state:e,update:i}}function Ps(n,t,e){var i=n,r=!0;switch(t.type){case K.ADD_CHOICE:{i.push(t.choice);break}case K.REMOVE_CHOICE:{t.choice.choiceEl=void 0,t.choice.group&&(t.choice.group.choices=t.choice.group.choices.filter(function(a){return a.id!==t.choice.id})),i=i.filter(function(a){return a.id!==t.choice.id});break}case K.ADD_ITEM:case K.REMOVE_ITEM:{t.item.choiceEl=void 0;break}case K.FILTER_CHOICES:{var s=[];t.results.forEach(function(a){s[a.item.id]=a}),i.forEach(function(a){var o=s[a.id];o!==void 0?(a.score=o.score,a.rank=o.rank,a.active=!0):(a.score=0,a.rank=0,a.active=!1),e&&e.appendGroupInSearch&&(a.choiceEl=void 0)});break}case K.ACTIVATE_CHOICES:{i.forEach(function(a){a.active=t.active,e&&e.appendGroupInSearch&&(a.choiceEl=void 0)});break}case K.CLEAR_CHOICES:{i=[];break}default:{r=!1;break}}return{state:i,update:r}}var hi={groups:xs,items:Os,choices:Ps},Ms=function(){function n(t){this._state=this.defaultState,this._listeners=[],this._txn=0,this._context=t}return Object.defineProperty(n.prototype,"defaultState",{get:function(){return{groups:[],items:[],choices:[]}},enumerable:!1,configurable:!0}),n.prototype.changeSet=function(t){return{groups:t,items:t,choices:t}},n.prototype.reset=function(){this._state=this.defaultState;var t=this.changeSet(!0);this._txn?this._changeSet=t:this._listeners.forEach(function(e){return e(t)})},n.prototype.subscribe=function(t){return this._listeners.push(t),this},n.prototype.dispatch=function(t){var e=this,i=this._state,r=!1,s=this._changeSet||this.changeSet(!1);Object.keys(hi).forEach(function(a){var o=hi[a](i[a],t,e._context);o.update&&(r=!0,s[a]=!0,i[a]=o.state)}),r&&(this._txn?this._changeSet=s:this._listeners.forEach(function(a){return a(s)}))},n.prototype.withTxn=function(t){this._txn++;try{t()}finally{if(this._txn=Math.max(0,this._txn-1),!this._txn){var e=this._changeSet;e&&(this._changeSet=void 0,this._listeners.forEach(function(i){return i(e)}))}}},Object.defineProperty(n.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"items",{get:function(){return this.state.items},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"highlightedActiveItems",{get:function(){return this.items.filter(function(t){return!t.disabled&&t.active&&t.highlighted})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"choices",{get:function(){return this.state.choices},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"activeChoices",{get:function(){return this.choices.filter(function(t){return t.active})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"searchableChoices",{get:function(){return this.choices.filter(function(t){return!t.disabled&&!t.placeholder})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"groups",{get:function(){return this.state.groups},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"activeGroups",{get:function(){var t=this;return this.state.groups.filter(function(e){var i=e.active&&!e.disabled,r=t.state.choices.some(function(s){return s.active&&!s.disabled});return i&&r},[])},enumerable:!1,configurable:!0}),n.prototype.inTxn=function(){return this._txn>0},n.prototype.getChoiceById=function(t){return this.activeChoices.find(function(e){return e.id===t})},n.prototype.getGroupById=function(t){return this.groups.find(function(e){return e.id===t})},n}(),Q={noChoices:"no-choices",noResults:"no-results",addChoice:"add-choice",generic:""};function Ls(n,t,e){return(t=Rs(t))in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function di(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),e.push.apply(e,i)}return e}function Ve(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?di(Object(e),!0).forEach(function(i){Ls(n,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):di(Object(e)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(e,i))})}return n}function js(n,t){if(typeof n!="object"||!n)return n;var e=n[Symbol.toPrimitive];if(e!==void 0){var i=e.call(n,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}function Rs(n){var t=js(n,"string");return typeof t=="symbol"?t:t+""}function Ee(n){return Array.isArray?Array.isArray(n):mi(n)==="[object Array]"}const Ns=1/0;function Fs(n){if(typeof n=="string")return n;let t=n+"";return t=="0"&&1/n==-Ns?"-0":t}function $s(n){return n==null?"":Fs(n)}function ye(n){return typeof n=="string"}function fi(n){return typeof n=="number"}function Us(n){return n===!0||n===!1||Hs(n)&&mi(n)=="[object Boolean]"}function pi(n){return typeof n=="object"}function Hs(n){return pi(n)&&n!==null}function oe(n){return n!=null}function sn(n){return!n.trim().length}function mi(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}const Tc="Extended search is not available",Bs="Incorrect 'index' type",qs=n=>`Invalid value for key ${n}`,Ks=n=>`Pattern length exceeds max of ${n}.`,Ws=n=>`Missing ${n} property in key`,Vs=n=>`Property 'weight' in key '${n}' must be a positive integer`,gi=Object.prototype.hasOwnProperty;class Ys{constructor(t){this._keys=[],this._keyMap={};let e=0;t.forEach(i=>{let r=vi(i);this._keys.push(r),this._keyMap[r.id]=r,e+=r.weight}),this._keys.forEach(i=>{i.weight/=e})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function vi(n){let t=null,e=null,i=null,r=1,s=null;if(ye(n)||Ee(n))i=n,t=_i(n),e=an(n);else{if(!gi.call(n,"name"))throw new Error(Ws("name"));const a=n.name;if(i=a,gi.call(n,"weight")&&(r=n.weight,r<=0))throw new Error(Vs(a));t=_i(a),e=an(a),s=n.getFn}return{path:t,id:e,weight:r,src:i,getFn:s}}function _i(n){return Ee(n)?n:n.split(".")}function an(n){return Ee(n)?n.join("."):n}function Gs(n,t){let e=[],i=!1;const r=(s,a,o)=>{if(oe(s))if(!a[o])e.push(s);else{let l=a[o];const h=s[l];if(!oe(h))return;if(o===a.length-1&&(ye(h)||fi(h)||Us(h)))e.push($s(h));else if(Ee(h)){i=!0;for(let c=0,f=h.length;c<f;c+=1)r(h[c],a,o+1)}else a.length&&r(h,a,o+1)}};return r(n,ye(t)?t.split("."):t,0),i?e:e[0]}const zs={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},Js={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(n,t)=>n.score===t.score?n.idx<t.idx?-1:1:n.score<t.score?-1:1},Qs={location:0,threshold:.6,distance:100},Xs={useExtendedSearch:!1,getFn:Gs,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var I=Ve(Ve(Ve(Ve({},Js),zs),Qs),Xs);const Zs=/[^ ]+/g;function ea(n=1,t=3){const e=new Map,i=Math.pow(10,t);return{get(r){const s=r.match(Zs).length;if(e.has(s))return e.get(s);const a=1/Math.pow(s,.5*n),o=parseFloat(Math.round(a*i)/i);return e.set(s,o),o},clear(){e.clear()}}}class on{constructor({getFn:t=I.getFn,fieldNormWeight:e=I.fieldNormWeight}={}){this.norm=ea(e,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((e,i)=>{this._keysMap[e.id]=i})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,ye(this.docs[0])?this.docs.forEach((t,e)=>{this._addString(t,e)}):this.docs.forEach((t,e)=>{this._addObject(t,e)}),this.norm.clear())}add(t){const e=this.size();ye(t)?this._addString(t,e):this._addObject(t,e)}removeAt(t){this.records.splice(t,1);for(let e=t,i=this.size();e<i;e+=1)this.records[e].i-=1}getValueForItemAtKeyId(t,e){return t[this._keysMap[e]]}size(){return this.records.length}_addString(t,e){if(!oe(t)||sn(t))return;let i={v:t,i:e,n:this.norm.get(t)};this.records.push(i)}_addObject(t,e){let i={i:e,$:{}};this.keys.forEach((r,s)=>{let a=r.getFn?r.getFn(t):this.getFn(t,r.path);if(oe(a)){if(Ee(a)){let o=[];const l=[{nestedArrIndex:-1,value:a}];for(;l.length;){const{nestedArrIndex:h,value:c}=l.pop();if(oe(c))if(ye(c)&&!sn(c)){let f={v:c,i:h,n:this.norm.get(c)};o.push(f)}else Ee(c)&&c.forEach((f,m)=>{l.push({nestedArrIndex:m,value:f})})}i.$[s]=o}else if(ye(a)&&!sn(a)){let o={v:a,n:this.norm.get(a)};i.$[s]=o}}}),this.records.push(i)}toJSON(){return{keys:this.keys,records:this.records}}}function yi(n,t,{getFn:e=I.getFn,fieldNormWeight:i=I.fieldNormWeight}={}){const r=new on({getFn:e,fieldNormWeight:i});return r.setKeys(n.map(vi)),r.setSources(t),r.create(),r}function ta(n,{getFn:t=I.getFn,fieldNormWeight:e=I.fieldNormWeight}={}){const{keys:i,records:r}=n,s=new on({getFn:t,fieldNormWeight:e});return s.setKeys(i),s.setIndexRecords(r),s}function It(n,{errors:t=0,currentLocation:e=0,expectedLocation:i=0,distance:r=I.distance,ignoreLocation:s=I.ignoreLocation}={}){const a=t/n.length;if(s)return a;const o=Math.abs(i-e);return r?a+o/r:o?1:a}function na(n=[],t=I.minMatchCharLength){let e=[],i=-1,r=-1,s=0;for(let a=n.length;s<a;s+=1){let o=n[s];o&&i===-1?i=s:!o&&i!==-1&&(r=s-1,r-i+1>=t&&e.push([i,r]),i=-1)}return n[s-1]&&s-i>=t&&e.push([i,s-1]),e}const Re=32;function ia(n,t,e,{location:i=I.location,distance:r=I.distance,threshold:s=I.threshold,findAllMatches:a=I.findAllMatches,minMatchCharLength:o=I.minMatchCharLength,includeMatches:l=I.includeMatches,ignoreLocation:h=I.ignoreLocation}={}){if(t.length>Re)throw new Error(Ks(Re));const c=t.length,f=n.length,m=Math.max(0,Math.min(i,f));let y=s,b=m;const _=o>1||l,C=_?Array(f):[];let T;for(;(T=n.indexOf(t,b))>-1;){let W=It(t,{currentLocation:T,expectedLocation:m,distance:r,ignoreLocation:h});if(y=Math.min(W,y),b=T+c,_){let X=0;for(;X<c;)C[T+X]=1,X+=1}}b=-1;let j=[],R=1,$=c+f;const z=1<<c-1;for(let W=0;W<c;W+=1){let X=0,de=$;for(;X<de;)It(t,{errors:W,currentLocation:m+de,expectedLocation:m,distance:r,ignoreLocation:h})<=y?X=de:$=de,de=Math.floor(($-X)/2+X);$=de;let Oe=Math.max(1,m-de+1),gt=a?f:Math.min(m+de,f)+c,ge=Array(gt+2);ge[gt+1]=(1<<W)-1;for(let ce=gt;ce>=Oe;ce-=1){let qe=ce-1,Bt=e[n.charAt(qe)];if(_&&(C[qe]=+!!Bt),ge[ce]=(ge[ce+1]<<1|1)&Bt,W&&(ge[ce]|=(j[ce+1]|j[ce])<<1|1|j[ce+1]),ge[ce]&z&&(R=It(t,{errors:W,currentLocation:qe,expectedLocation:m,distance:r,ignoreLocation:h}),R<=y)){if(y=R,b=qe,b<=m)break;Oe=Math.max(1,2*m-b)}}if(It(t,{errors:W+1,currentLocation:m,expectedLocation:m,distance:r,ignoreLocation:h})>y)break;j=ge}const me={isMatch:b>=0,score:Math.max(.001,R)};if(_){const W=na(C,o);W.length?l&&(me.indices=W):me.isMatch=!1}return me}function ra(n){let t={};for(let e=0,i=n.length;e<i;e+=1){const r=n.charAt(e);t[r]=(t[r]||0)|1<<i-e-1}return t}class bi{constructor(t,{location:e=I.location,threshold:i=I.threshold,distance:r=I.distance,includeMatches:s=I.includeMatches,findAllMatches:a=I.findAllMatches,minMatchCharLength:o=I.minMatchCharLength,isCaseSensitive:l=I.isCaseSensitive,ignoreLocation:h=I.ignoreLocation}={}){if(this.options={location:e,threshold:i,distance:r,includeMatches:s,findAllMatches:a,minMatchCharLength:o,isCaseSensitive:l,ignoreLocation:h},this.pattern=l?t:t.toLowerCase(),this.chunks=[],!this.pattern.length)return;const c=(m,y)=>{this.chunks.push({pattern:m,alphabet:ra(m),startIndex:y})},f=this.pattern.length;if(f>Re){let m=0;const y=f%Re,b=f-y;for(;m<b;)c(this.pattern.substr(m,Re),m),m+=Re;if(y){const _=f-Re;c(this.pattern.substr(_),_)}}else c(this.pattern,0)}searchIn(t){const{isCaseSensitive:e,includeMatches:i}=this.options;if(e||(t=t.toLowerCase()),this.pattern===t){let b={isMatch:!0,score:0};return i&&(b.indices=[[0,t.length-1]]),b}const{location:r,distance:s,threshold:a,findAllMatches:o,minMatchCharLength:l,ignoreLocation:h}=this.options;let c=[],f=0,m=!1;this.chunks.forEach(({pattern:b,alphabet:_,startIndex:C})=>{const{isMatch:T,score:j,indices:R}=ia(t,b,_,{location:r+C,distance:s,threshold:a,findAllMatches:o,minMatchCharLength:l,includeMatches:i,ignoreLocation:h});T&&(m=!0),f+=j,T&&R&&(c=[...c,...R])});let y={isMatch:m,score:m?f/this.chunks.length:1};return m&&i&&(y.indices=c),y}}class ke{constructor(t){this.pattern=t}static isMultiMatch(t){return wi(t,this.multiRegex)}static isSingleMatch(t){return wi(t,this.singleRegex)}search(){}}function wi(n,t){const e=n.match(t);return e?e[1]:null}class sa extends ke{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const e=t===this.pattern;return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}}class aa extends ke{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const i=t.indexOf(this.pattern)===-1;return{isMatch:i,score:i?0:1,indices:[0,t.length-1]}}}class oa extends ke{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const e=t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}}class la extends ke{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const e=!t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}}class ca extends ke{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const e=t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}class ua extends ke{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const e=!t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}}class Ei extends ke{constructor(t,{location:e=I.location,threshold:i=I.threshold,distance:r=I.distance,includeMatches:s=I.includeMatches,findAllMatches:a=I.findAllMatches,minMatchCharLength:o=I.minMatchCharLength,isCaseSensitive:l=I.isCaseSensitive,ignoreLocation:h=I.ignoreLocation}={}){super(t),this._bitapSearch=new bi(t,{location:e,threshold:i,distance:r,includeMatches:s,findAllMatches:a,minMatchCharLength:o,isCaseSensitive:l,ignoreLocation:h})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class Ci extends ke{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let e=0,i;const r=[],s=this.pattern.length;for(;(i=t.indexOf(this.pattern,e))>-1;)e=i+s,r.push([i,e-1]);const a=!!r.length;return{isMatch:a,score:a?0:1,indices:r}}}const ln=[sa,Ci,oa,la,ua,ca,aa,Ei],Si=ln.length,ha=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,da="|";function fa(n,t={}){return n.split(da).map(e=>{let i=e.trim().split(ha).filter(s=>s&&!!s.trim()),r=[];for(let s=0,a=i.length;s<a;s+=1){const o=i[s];let l=!1,h=-1;for(;!l&&++h<Si;){const c=ln[h];let f=c.isMultiMatch(o);f&&(r.push(new c(f,t)),l=!0)}if(!l)for(h=-1;++h<Si;){const c=ln[h];let f=c.isSingleMatch(o);if(f){r.push(new c(f,t));break}}}return r})}const pa=new Set([Ei.type,Ci.type]);class ma{constructor(t,{isCaseSensitive:e=I.isCaseSensitive,includeMatches:i=I.includeMatches,minMatchCharLength:r=I.minMatchCharLength,ignoreLocation:s=I.ignoreLocation,findAllMatches:a=I.findAllMatches,location:o=I.location,threshold:l=I.threshold,distance:h=I.distance}={}){this.query=null,this.options={isCaseSensitive:e,includeMatches:i,minMatchCharLength:r,findAllMatches:a,ignoreLocation:s,location:o,threshold:l,distance:h},this.pattern=e?t:t.toLowerCase(),this.query=fa(this.pattern,this.options)}static condition(t,e){return e.useExtendedSearch}searchIn(t){const e=this.query;if(!e)return{isMatch:!1,score:1};const{includeMatches:i,isCaseSensitive:r}=this.options;t=r?t:t.toLowerCase();let s=0,a=[],o=0;for(let l=0,h=e.length;l<h;l+=1){const c=e[l];a.length=0,s=0;for(let f=0,m=c.length;f<m;f+=1){const y=c[f],{isMatch:b,indices:_,score:C}=y.search(t);if(b){if(s+=1,o+=C,i){const T=y.constructor.type;pa.has(T)?a=[...a,..._]:a.push(_)}}else{o=0,s=0,a.length=0;break}}if(s){let f={isMatch:!0,score:o/s};return i&&(f.indices=a),f}}return{isMatch:!1,score:1}}}const cn=[];function ga(...n){cn.push(...n)}function un(n,t){for(let e=0,i=cn.length;e<i;e+=1){let r=cn[e];if(r.condition(n,t))return new r(n,t)}return new bi(n,t)}const At={AND:"$and",OR:"$or"},hn={PATH:"$path",PATTERN:"$val"},dn=n=>!!(n[At.AND]||n[At.OR]),va=n=>!!n[hn.PATH],_a=n=>!Ee(n)&&pi(n)&&!dn(n),ki=n=>({[At.AND]:Object.keys(n).map(t=>({[t]:n[t]}))});function Ti(n,t,{auto:e=!0}={}){const i=r=>{let s=Object.keys(r);const a=va(r);if(!a&&s.length>1&&!dn(r))return i(ki(r));if(_a(r)){const l=a?r[hn.PATH]:s[0],h=a?r[hn.PATTERN]:r[l];if(!ye(h))throw new Error(qs(l));const c={keyId:an(l),pattern:h};return e&&(c.searcher=un(h,t)),c}let o={children:[],operator:s[0]};return s.forEach(l=>{const h=r[l];Ee(h)&&h.forEach(c=>{o.children.push(i(c))})}),o};return dn(n)||(n=ki(n)),i(n)}function ya(n,{ignoreFieldNorm:t=I.ignoreFieldNorm}){n.forEach(e=>{let i=1;e.matches.forEach(({key:r,norm:s,score:a})=>{const o=r?r.weight:null;i*=Math.pow(a===0&&o?Number.EPSILON:a,(o||1)*(t?1:s))}),e.score=i})}function ba(n,t){const e=n.matches;t.matches=[],oe(e)&&e.forEach(i=>{if(!oe(i.indices)||!i.indices.length)return;const{indices:r,value:s}=i;let a={indices:r,value:s};i.key&&(a.key=i.key.src),i.idx>-1&&(a.refIndex=i.idx),t.matches.push(a)})}function wa(n,t){t.score=n.score}function Ea(n,t,{includeMatches:e=I.includeMatches,includeScore:i=I.includeScore}={}){const r=[];return e&&r.push(ba),i&&r.push(wa),n.map(s=>{const{idx:a}=s,o={item:t[a],refIndex:a};return r.length&&r.forEach(l=>{l(s,o)}),o})}class Ye{constructor(t,e={},i){this.options=Ve(Ve({},I),e),this.options.useExtendedSearch,this._keyStore=new Ys(this.options.keys),this.setCollection(t,i)}setCollection(t,e){if(this._docs=t,e&&!(e instanceof on))throw new Error(Bs);this._myIndex=e||yi(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){oe(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const e=[];for(let i=0,r=this._docs.length;i<r;i+=1){const s=this._docs[i];t(s,i)&&(this.removeAt(i),i-=1,r-=1,e.push(s))}return e}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:e=-1}={}){const{includeMatches:i,includeScore:r,shouldSort:s,sortFn:a,ignoreFieldNorm:o}=this.options;let l=ye(t)?ye(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return ya(l,{ignoreFieldNorm:o}),s&&l.sort(a),fi(e)&&e>-1&&(l=l.slice(0,e)),Ea(l,this._docs,{includeMatches:i,includeScore:r})}_searchStringList(t){const e=un(t,this.options),{records:i}=this._myIndex,r=[];return i.forEach(({v:s,i:a,n:o})=>{if(!oe(s))return;const{isMatch:l,score:h,indices:c}=e.searchIn(s);l&&r.push({item:s,idx:a,matches:[{score:h,value:s,norm:o,indices:c}]})}),r}_searchLogical(t){const e=Ti(t,this.options),i=(o,l,h)=>{if(!o.children){const{keyId:f,searcher:m}=o,y=this._findMatches({key:this._keyStore.get(f),value:this._myIndex.getValueForItemAtKeyId(l,f),searcher:m});return y&&y.length?[{idx:h,item:l,matches:y}]:[]}const c=[];for(let f=0,m=o.children.length;f<m;f+=1){const y=o.children[f],b=i(y,l,h);if(b.length)c.push(...b);else if(o.operator===At.AND)return[]}return c},r=this._myIndex.records,s={},a=[];return r.forEach(({$:o,i:l})=>{if(oe(o)){let h=i(e,o,l);h.length&&(s[l]||(s[l]={idx:l,item:o,matches:[]},a.push(s[l])),h.forEach(({matches:c})=>{s[l].matches.push(...c)}))}}),a}_searchObjectList(t){const e=un(t,this.options),{keys:i,records:r}=this._myIndex,s=[];return r.forEach(({$:a,i:o})=>{if(!oe(a))return;let l=[];i.forEach((h,c)=>{l.push(...this._findMatches({key:h,value:a[c],searcher:e}))}),l.length&&s.push({idx:o,item:a,matches:l})}),s}_findMatches({key:t,value:e,searcher:i}){if(!oe(e))return[];let r=[];if(Ee(e))e.forEach(({v:s,i:a,n:o})=>{if(!oe(s))return;const{isMatch:l,score:h,indices:c}=i.searchIn(s);l&&r.push({score:h,key:t,value:s,idx:a,norm:o,indices:c})});else{const{v:s,n:a}=e,{isMatch:o,score:l,indices:h}=i.searchIn(s);o&&r.push({score:l,key:t,value:s,norm:a,indices:h})}return r}}Ye.version="7.0.0",Ye.createIndex=yi,Ye.parseIndex=ta,Ye.config=I,Ye.parseQuery=Ti,ga(ma);var Ca=function(){function n(t){this._haystack=[],this._fuseOptions=ee(ee({},t.fuseOptions),{keys:ns([],t.searchFields,!0),includeMatches:!0})}return n.prototype.index=function(t){this._haystack=t,this._fuse&&this._fuse.setCollection(t)},n.prototype.reset=function(){this._haystack=[],this._fuse=void 0},n.prototype.isEmptyIndex=function(){return!this._haystack.length},n.prototype.search=function(t){this._fuse||(this._fuse=new Ye(this._haystack,this._fuseOptions));var e=this._fuse.search(t);return e.map(function(i,r){return{item:i.item,score:i.score||0,rank:r+1}})},n}();function Sa(n){return new Ca(n)}var ka=function(n){for(var t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0},fn=function(n,t,e){var i=n.dataset,r=t.customProperties,s=t.labelClass,a=t.labelDescription;s&&(i.labelClass=Dt(s).join(" ")),a&&(i.labelDescription=a),e&&r&&(typeof r=="string"?i.customProperties=r:typeof r=="object"&&!ka(r)&&(i.customProperties=JSON.stringify(r)))},Di=function(n,t,e){var i=t&&n.querySelector("label[for='".concat(t,"']")),r=i&&i.innerText;r&&e.setAttribute("aria-label",r)},Ta={containerOuter:function(n,t,e,i,r,s,a){var o=n.classNames.containerOuter,l=document.createElement("div");return A(l,o),l.dataset.type=s,t&&(l.dir=t),i&&(l.tabIndex=0),e&&(l.setAttribute("role",r?"combobox":"listbox"),r?l.setAttribute("aria-autocomplete","list"):a||Di(this._docRoot,this.passedElement.element.id,l),l.setAttribute("aria-haspopup","true"),l.setAttribute("aria-expanded","false")),a&&l.setAttribute("aria-labelledby",a),l},containerInner:function(n){var t=n.classNames.containerInner,e=document.createElement("div");return A(e,t),e},itemList:function(n,t){var e=n.searchEnabled,i=n.classNames,r=i.list,s=i.listSingle,a=i.listItems,o=document.createElement("div");return A(o,r),A(o,t?s:a),this._isSelectElement&&e&&o.setAttribute("role","listbox"),o},placeholder:function(n,t){var e=n.allowHTML,i=n.classNames.placeholder,r=document.createElement("div");return A(r,i),we(r,e,t),r},item:function(n,t,e){var i=n.allowHTML,r=n.removeItemButtonAlignLeft,s=n.removeItemIconText,a=n.removeItemLabelText,o=n.classNames,l=o.item,h=o.button,c=o.highlightedState,f=o.itemSelectable,m=o.placeholder,y=je(t.value),b=document.createElement("div");if(A(b,l),t.labelClass){var _=document.createElement("span");we(_,i,t.label),A(_,t.labelClass),b.appendChild(_)}else we(b,i,t.label);if(b.dataset.item="",b.dataset.id=t.id,b.dataset.value=y,fn(b,t,!0),(t.disabled||this.containerOuter.isDisabled)&&b.setAttribute("aria-disabled","true"),this._isSelectElement&&(b.setAttribute("aria-selected","true"),b.setAttribute("role","option")),t.placeholder&&(A(b,m),b.dataset.placeholder=""),A(b,t.highlighted?c:f),e){t.disabled&&ve(b,f),b.dataset.deletable="";var C=document.createElement("button");C.type="button",A(C,h),we(C,!0,rt(s,t.value));var T=rt(a,t.value);T&&C.setAttribute("aria-label",T),C.dataset.button="",r?b.insertAdjacentElement("afterbegin",C):b.appendChild(C)}return b},choiceList:function(n,t){var e=n.classNames.list,i=document.createElement("div");return A(i,e),t||i.setAttribute("aria-multiselectable","true"),i.setAttribute("role","listbox"),i},choiceGroup:function(n,t){var e=n.allowHTML,i=n.classNames,r=i.group,s=i.groupHeading,a=i.itemDisabled,o=t.id,l=t.label,h=t.disabled,c=je(l),f=document.createElement("div");A(f,r),h&&A(f,a),f.setAttribute("role","group"),f.dataset.group="",f.dataset.id=o,f.dataset.value=c,h&&f.setAttribute("aria-disabled","true");var m=document.createElement("div");return A(m,s),we(m,e,l||""),f.appendChild(m),f},choice:function(n,t,e,i){var r=n.allowHTML,s=n.classNames,a=s.item,o=s.itemChoice,l=s.itemSelectable,h=s.selectedState,c=s.itemDisabled,f=s.description,m=s.placeholder,y=t.label,b=je(t.value),_=document.createElement("div");_.id=t.elementId,A(_,a),A(_,o),i&&typeof y=="string"&&(y=rn(r,y),y+=" (".concat(i,")"),y={trusted:y});var C=_;if(t.labelClass){var T=document.createElement("span");we(T,r,y),A(T,t.labelClass),C=T,_.appendChild(T)}else we(_,r,y);if(t.labelDescription){var j="".concat(t.elementId,"-description");C.setAttribute("aria-describedby",j);var R=document.createElement("span");we(R,r,t.labelDescription),R.id=j,A(R,f),_.appendChild(R)}return t.selected&&A(_,h),t.placeholder&&A(_,m),_.setAttribute("role",t.group?"treeitem":"option"),_.dataset.choice="",_.dataset.id=t.id,_.dataset.value=b,e&&(_.dataset.selectText=e),t.group&&(_.dataset.groupId="".concat(t.group.id)),fn(_,t,!1),t.disabled?(A(_,c),_.dataset.choiceDisabled="",_.setAttribute("aria-disabled","true")):(A(_,l),_.dataset.choiceSelectable=""),_},input:function(n,t){var e=n.classNames,i=e.input,r=e.inputCloned,s=n.labelId,a=document.createElement("input");return a.type="search",A(a,i),A(a,r),a.autocomplete="off",a.autocapitalize="off",a.spellcheck=!1,a.setAttribute("role","textbox"),a.setAttribute("aria-autocomplete","list"),t?a.setAttribute("aria-label",t):s||Di(this._docRoot,this.passedElement.element.id,a),a},dropdown:function(n){var t=n.classNames,e=t.list,i=t.listDropdown,r=document.createElement("div");return A(r,e),A(r,i),r.setAttribute("aria-expanded","false"),r},notice:function(n,t,e){var i=n.classNames,r=i.item,s=i.itemChoice,a=i.addChoice,o=i.noResults,l=i.noChoices,h=i.notice;e===void 0&&(e=Q.generic);var c=document.createElement("div");switch(we(c,!0,t),A(c,r),A(c,s),A(c,h),e){case Q.addChoice:A(c,a);break;case Q.noResults:A(c,o);break;case Q.noChoices:A(c,l);break}return e===Q.addChoice&&(c.dataset.choiceSelectable="",c.dataset.choice=""),c},option:function(n){var t=je(n.label),e=new Option(t,n.value,!1,n.selected);return fn(e,n,!0),e.disabled=n.disabled,n.selected&&e.setAttribute("selected",""),e}},Da="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style,Ia={},pn=function(n){if(n)return n.dataset.id?parseInt(n.dataset.id,10):void 0},ot="[data-choice-selectable]",Aa=function(){function n(t,e){t===void 0&&(t="[data-choice]"),e===void 0&&(e={});var i=this;this.initialisedOK=void 0,this._hasNonChoicePlaceholder=!1,this._lastAddedChoiceId=0,this._lastAddedGroupId=0;var r=n.defaults;this.config=ee(ee(ee({},r.allOptions),r.options),e),is.forEach(function(T){i.config[T]=ee(ee(ee({},r.allOptions[T]),r.options[T]),e[T])});var s=this.config;s.silent||this._validateConfig();var a=s.shadowRoot||document.documentElement;this._docRoot=a;var o=typeof t=="string"?a.querySelector(t):t;if(!o||typeof o!="object"||!(ks(o)||li(o)))throw TypeError(!o&&typeof t=="string"?"Selector ".concat(t," failed to find an element"):"Expected one of the following types text|select-one|select-multiple");var l=o.type,h=l===Se.Text;(h||s.maxItemCount!==1)&&(s.singleModeForMultiSelect=!1),s.singleModeForMultiSelect&&(l=Se.SelectMultiple);var c=l===Se.SelectOne,f=l===Se.SelectMultiple,m=c||f;if(this._elementType=l,this._isTextElement=h,this._isSelectOneElement=c,this._isSelectMultipleElement=f,this._isSelectElement=c||f,this._canAddUserChoices=h&&s.addItems||m&&s.addChoices,typeof s.renderSelectedChoices!="boolean"&&(s.renderSelectedChoices=s.renderSelectedChoices==="always"||c),s.closeDropdownOnSelect==="auto"?s.closeDropdownOnSelect=h||c||s.singleModeForMultiSelect:s.closeDropdownOnSelect=at(s.closeDropdownOnSelect),s.placeholder&&(s.placeholderValue?this._hasNonChoicePlaceholder=!0:o.dataset.placeholder&&(this._hasNonChoicePlaceholder=!0,s.placeholderValue=o.dataset.placeholder)),e.addItemFilter&&typeof e.addItemFilter!="function"){var y=e.addItemFilter instanceof RegExp?e.addItemFilter:new RegExp(e.addItemFilter);s.addItemFilter=y.test.bind(y)}if(this._isTextElement)this.passedElement=new Ss({element:o,classNames:s.classNames});else{var b=o;this.passedElement=new Is({element:b,classNames:s.classNames,template:function(T){return i._templates.option(T)},extractPlaceholder:s.placeholder&&!this._hasNonChoicePlaceholder})}if(this.initialised=!1,this._store=new Ms(s),this._currentValue="",s.searchEnabled=!h&&s.searchEnabled||f,this._canSearch=s.searchEnabled,this._isScrollingOnIe=!1,this._highlightPosition=0,this._wasTap=!0,this._placeholderValue=this._generatePlaceholderValue(),this._baseId=us(o,"choices-"),this._direction=o.dir,!this._direction){var _=window.getComputedStyle(o).direction,C=window.getComputedStyle(document.documentElement).direction;_!==C&&(this._direction=_)}if(this._idNames={itemChoice:"item-choice"},this._templates=r.templates,this._render=this._render.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this),this._onKeyUp=this._onKeyUp.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onInput=this._onInput.bind(this),this._onClick=this._onClick.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseOver=this._onMouseOver.bind(this),this._onFormReset=this._onFormReset.bind(this),this._onSelectKey=this._onSelectKey.bind(this),this._onEnterKey=this._onEnterKey.bind(this),this._onEscapeKey=this._onEscapeKey.bind(this),this._onDirectionKey=this._onDirectionKey.bind(this),this._onDeleteKey=this._onDeleteKey.bind(this),this.passedElement.isActive){s.silent||console.warn("Trying to initialise Choices on element already initialised",{element:t}),this.initialised=!0,this.initialisedOK=!1;return}this.init(),this._initialItems=this._store.items.map(function(T){return T.value})}return Object.defineProperty(n,"defaults",{get:function(){return Object.preventExtensions({get options(){return Ia},get allOptions(){return ci},get templates(){return Ta}})},enumerable:!1,configurable:!0}),n.prototype.init=function(){if(!(this.initialised||this.initialisedOK!==void 0)){this._searcher=Sa(this.config),this._loadChoices(),this._createTemplates(),this._createElements(),this._createStructure(),this._isTextElement&&!this.config.addItems||this.passedElement.element.hasAttribute("disabled")||this.passedElement.element.closest("fieldset:disabled")?this.disable():(this.enable(),this._addEventListeners()),this._initStore(),this.initialised=!0,this.initialisedOK=!0;var t=this.config.callbackOnInit;typeof t=="function"&&t.call(this)}},n.prototype.destroy=function(){this.initialised&&(this._removeEventListeners(),this.passedElement.reveal(),this.containerOuter.unwrap(this.passedElement.element),this._store._listeners=[],this.clearStore(!1),this._stopSearch(),this._templates=n.defaults.templates,this.initialised=!1,this.initialisedOK=void 0)},n.prototype.enable=function(){return this.passedElement.isDisabled&&this.passedElement.enable(),this.containerOuter.isDisabled&&(this._addEventListeners(),this.input.enable(),this.containerOuter.enable()),this},n.prototype.disable=function(){return this.passedElement.isDisabled||this.passedElement.disable(),this.containerOuter.isDisabled||(this._removeEventListeners(),this.input.disable(),this.containerOuter.disable()),this},n.prototype.highlightItem=function(t,e){if(e===void 0&&(e=!0),!t||!t.id)return this;var i=this._store.items.find(function(r){return r.id===t.id});return!i||i.highlighted?this:(this._store.dispatch(kt(i,!0)),e&&this.passedElement.triggerEvent(te.highlightItem,this._getChoiceForOutput(i)),this)},n.prototype.unhighlightItem=function(t,e){if(e===void 0&&(e=!0),!t||!t.id)return this;var i=this._store.items.find(function(r){return r.id===t.id});return!i||!i.highlighted?this:(this._store.dispatch(kt(i,!1)),e&&this.passedElement.triggerEvent(te.unhighlightItem,this._getChoiceForOutput(i)),this)},n.prototype.highlightAll=function(){var t=this;return this._store.withTxn(function(){t._store.items.forEach(function(e){e.highlighted||(t._store.dispatch(kt(e,!0)),t.passedElement.triggerEvent(te.highlightItem,t._getChoiceForOutput(e)))})}),this},n.prototype.unhighlightAll=function(){var t=this;return this._store.withTxn(function(){t._store.items.forEach(function(e){e.highlighted&&(t._store.dispatch(kt(e,!1)),t.passedElement.triggerEvent(te.highlightItem,t._getChoiceForOutput(e)))})}),this},n.prototype.removeActiveItemsByValue=function(t){var e=this;return this._store.withTxn(function(){e._store.items.filter(function(i){return i.value===t}).forEach(function(i){return e._removeItem(i)})}),this},n.prototype.removeActiveItems=function(t){var e=this;return this._store.withTxn(function(){e._store.items.filter(function(i){var r=i.id;return r!==t}).forEach(function(i){return e._removeItem(i)})}),this},n.prototype.removeHighlightedItems=function(t){var e=this;return t===void 0&&(t=!1),this._store.withTxn(function(){e._store.highlightedActiveItems.forEach(function(i){e._removeItem(i),t&&e._triggerChange(i.value)})}),this},n.prototype.showDropdown=function(t){var e=this;return this.dropdown.isActive?this:(requestAnimationFrame(function(){e.dropdown.show();var i=e.dropdown.element.getBoundingClientRect();e.containerOuter.open(i.bottom,i.height),!t&&e._canSearch&&e.input.focus(),e.passedElement.triggerEvent(te.showDropdown)}),this)},n.prototype.hideDropdown=function(t){var e=this;return this.dropdown.isActive?(requestAnimationFrame(function(){e.dropdown.hide(),e.containerOuter.close(),!t&&e._canSearch&&(e.input.removeActiveDescendant(),e.input.blur()),e.passedElement.triggerEvent(te.hideDropdown)}),this):this},n.prototype.getValue=function(t){var e=this,i=this._store.items.map(function(r){return t?r.value:e._getChoiceForOutput(r)});return this._isSelectOneElement||this.config.singleModeForMultiSelect?i[0]:i},n.prototype.setValue=function(t){var e=this;return this.initialisedOK?(this._store.withTxn(function(){t.forEach(function(i){i&&e._addChoice(_e(i,!1))})}),this._searcher.reset(),this):(this._warnChoicesInitFailed("setValue"),this)},n.prototype.setChoiceByValue=function(t){var e=this;return this.initialisedOK?this._isTextElement?this:(this._store.withTxn(function(){var i=Array.isArray(t)?t:[t];i.forEach(function(r){return e._findAndSelectChoiceByValue(r)}),e.unhighlightAll()}),this._searcher.reset(),this):(this._warnChoicesInitFailed("setChoiceByValue"),this)},n.prototype.setChoices=function(t,e,i,r,s){var a=this;if(t===void 0&&(t=[]),e===void 0&&(e="value"),i===void 0&&(i="label"),r===void 0&&(r=!1),s===void 0&&(s=!0),!this.initialisedOK)return this._warnChoicesInitFailed("setChoices"),this;if(!this._isSelectElement)throw new TypeError("setChoices can't be used with INPUT based Choices");if(typeof e!="string"||!e)throw new TypeError("value parameter must be a name of 'value' field in passed objects");if(r&&this.clearChoices(),typeof t=="function"){var o=t(this);if(typeof Promise=="function"&&o instanceof Promise)return new Promise(function(l){return requestAnimationFrame(l)}).then(function(){return a._handleLoadingState(!0)}).then(function(){return o}).then(function(l){return a.setChoices(l,e,i,r)}).catch(function(l){a.config.silent||console.error(l)}).then(function(){return a._handleLoadingState(!1)}).then(function(){return a});if(!Array.isArray(o))throw new TypeError(".setChoices first argument function must return either array of choices or Promise, got: ".concat(typeof o));return this.setChoices(o,e,i,!1)}if(!Array.isArray(t))throw new TypeError(".setChoices must be called either with array of choices with a function resulting into Promise of array of choices");return this.containerOuter.removeLoadingState(),this._store.withTxn(function(){s&&(a._isSearching=!1);var l=e==="value",h=i==="label";t.forEach(function(c){if("choices"in c){var f=c;h||(f=ee(ee({},f),{label:f[i]})),a._addGroup(_e(f,!0))}else{var m=c;(!h||!l)&&(m=ee(ee({},m),{value:m[e],label:m[i]})),a._addChoice(_e(m,!1))}}),a.unhighlightAll()}),this._searcher.reset(),this},n.prototype.refresh=function(t,e,i){var r=this;return t===void 0&&(t=!1),e===void 0&&(e=!1),i===void 0&&(i=!1),this._isSelectElement?(this._store.withTxn(function(){var s=r.passedElement.optionsAsChoices(),a={};i||r._store.items.forEach(function(l){l.id&&l.active&&l.selected&&!l.disabled&&(a[l.value]=!0)}),r.clearStore(!1);var o=function(l){i?r._store.dispatch(ti(l)):a[l.value]&&(l.selected=!0)};s.forEach(function(l){if("choices"in l){l.choices.forEach(o);return}o(l)}),r._addPredefinedChoices(s,e,t),r._isSearching&&r._searchChoices(r.input.value)}),this):(this.config.silent||console.warn("refresh method can only be used on choices backed by a <select> element"),this)},n.prototype.removeChoice=function(t){var e=this._store.choices.find(function(i){return i.value===t});return e?(this._clearNotice(),this._store.dispatch(ei(e)),this._searcher.reset(),e.selected&&this.passedElement.triggerEvent(te.removeItem,this._getChoiceForOutput(e)),this):this},n.prototype.clearChoices=function(){var t=this;return this._store.withTxn(function(){t._store.choices.forEach(function(e){e.selected||t._store.dispatch(ei(e))})}),this._searcher.reset(),this},n.prototype.clearStore=function(t){return t===void 0&&(t=!0),this._stopSearch(),t&&this.passedElement.element.replaceChildren(""),this.itemList.element.replaceChildren(""),this.choiceList.element.replaceChildren(""),this._store.reset(),this._lastAddedChoiceId=0,this._lastAddedGroupId=0,this._searcher.reset(),this},n.prototype.clearInput=function(){var t=!this._isSelectOneElement;return this.input.clear(t),this._stopSearch(),this},n.prototype._validateConfig=function(){var t=this.config,e=_s(t,ci);e.length&&console.warn("Unknown config option(s) passed",e.join(", ")),t.allowHTML&&t.allowHtmlUserInput&&(t.addItems&&console.warn("Warning: allowHTML/allowHtmlUserInput/addItems all being true is strongly not recommended and may lead to XSS attacks"),t.addChoices&&console.warn("Warning: allowHTML/allowHtmlUserInput/addChoices all being true is strongly not recommended and may lead to XSS attacks"))},n.prototype._render=function(t){t===void 0&&(t={choices:!0,groups:!0,items:!0}),!this._store.inTxn()&&(this._isSelectElement&&(t.choices||t.groups)&&this._renderChoices(),t.items&&this._renderItems())},n.prototype._renderChoices=function(){var t=this;if(this._canAddItems()){var e=this,i=e.config,r=e._isSearching,s=this._store,a=s.activeGroups,o=s.activeChoices,l=0;if(r&&i.searchResultLimit>0?l=i.searchResultLimit:i.renderChoiceLimit>0&&(l=i.renderChoiceLimit),this._isSelectElement){var h=o.filter(function(b){return!b.element});h.length&&this.passedElement.addOptions(h)}var c=document.createDocumentFragment(),f=function(b){return b.filter(function(_){return!_.placeholder&&(r?!!_.rank:i.renderSelectedChoices||!_.selected)})},m=!1,y=function(b,_,C){r?b.sort(gs):i.shouldSort&&b.sort(i.sorter);var T=b.length;T=!_&&l&&T>l?l:T,T--,b.every(function(j,R){var $=j.choiceEl||t._templates.choice(i,j,i.itemSelectText,C);return j.choiceEl=$,c.appendChild($),!j.disabled&&(r||!j.selected)&&(m=!0),R<T})};o.length&&(i.resetScrollPosition&&requestAnimationFrame(function(){return t.choiceList.scrollToTop()}),!this._hasNonChoicePlaceholder&&!r&&this._isSelectOneElement&&y(o.filter(function(b){return b.placeholder&&!b.group}),!1,void 0),a.length&&!r?(i.shouldSort&&a.sort(i.sorter),y(o.filter(function(b){return!b.placeholder&&!b.group}),!1,void 0),a.forEach(function(b){var _=f(b.choices);if(_.length){if(b.label){var C=b.groupEl||t._templates.choiceGroup(t.config,b);b.groupEl=C,C.remove(),c.appendChild(C)}y(_,!0,i.appendGroupInSearch&&r?b.label:void 0)}})):y(f(o),!1,void 0)),m||(this._notice||(this._notice={text:ii(r?i.noResultsText:i.noChoicesText),type:r?Q.noResults:Q.noChoices}),c.replaceChildren("")),this._renderNotice(c),this.choiceList.element.replaceChildren(c),m&&this._highlightChoice()}},n.prototype._renderItems=function(){var t=this,e=this._store.items||[],i=this.itemList.element,r=this.config,s=document.createDocumentFragment(),a=function(f){return i.querySelector('[data-item][data-id="'.concat(f.id,'"]'))},o=function(f){var m=f.itemEl;m&&m.parentElement||(m=a(f)||t._templates.item(r,f,r.removeItemButton),f.itemEl=m,s.appendChild(m))};e.forEach(o);var l=!!s.childNodes.length;if(this._isSelectOneElement&&this._hasNonChoicePlaceholder){var h=i.children.length;if(l||h>1){var c=i.querySelector(st(r.classNames.placeholder));c&&c.remove()}else h||(l=!0,o(_e({selected:!0,value:"",label:r.placeholderValue||"",placeholder:!0},!1)))}l&&(i.append(s),r.shouldSortItems&&!this._isSelectOneElement&&(e.sort(r.sorter),e.forEach(function(f){var m=a(f);m&&(m.remove(),s.append(m))}),i.append(s))),this._isTextElement&&(this.passedElement.value=e.map(function(f){var m=f.value;return m}).join(r.delimiter))},n.prototype._displayNotice=function(t,e,i){i===void 0&&(i=!0);var r=this._notice;if(r&&(r.type===e&&r.text===t||r.type===Q.addChoice&&(e===Q.noResults||e===Q.noChoices))){i&&this.showDropdown(!0);return}this._clearNotice(),this._notice=t?{text:t,type:e}:void 0,this._renderNotice(),i&&t&&this.showDropdown(!0)},n.prototype._clearNotice=function(){if(this._notice){var t=this.choiceList.element.querySelector(st(this.config.classNames.notice));t&&t.remove(),this._notice=void 0}},n.prototype._renderNotice=function(t){var e=this._notice;if(e){var i=this._templates.notice(this.config,e.text,e.type);t?t.append(i):this.choiceList.prepend(i)}},n.prototype._getChoiceForOutput=function(t,e){return{id:t.id,highlighted:t.highlighted,labelClass:t.labelClass,labelDescription:t.labelDescription,customProperties:t.customProperties,disabled:t.disabled,active:t.active,label:t.label,placeholder:t.placeholder,value:t.value,groupValue:t.group?t.group.label:void 0,element:t.element,keyCode:e}},n.prototype._triggerChange=function(t){t!=null&&this.passedElement.triggerEvent(te.change,{value:t})},n.prototype._handleButtonAction=function(t){var e=this,i=this._store.items;if(!(!i.length||!this.config.removeItems||!this.config.removeItemButton)){var r=t&&pn(t.parentElement),s=r&&i.find(function(a){return a.id===r});s&&this._store.withTxn(function(){if(e._removeItem(s),e._triggerChange(s.value),e._isSelectOneElement&&!e._hasNonChoicePlaceholder){var a=e._store.choices.reverse().find(function(o){return!o.disabled&&o.placeholder});a&&(e._addItem(a),e.unhighlightAll(),a.value&&e._triggerChange(a.value))}})}},n.prototype._handleItemAction=function(t,e){var i=this;e===void 0&&(e=!1);var r=this._store.items;if(!(!r.length||!this.config.removeItems||this._isSelectOneElement)){var s=pn(t);s&&(r.forEach(function(a){a.id===s&&!a.highlighted?i.highlightItem(a):!e&&a.highlighted&&i.unhighlightItem(a)}),this.input.focus())}},n.prototype._handleChoiceAction=function(t){var e=this,i=pn(t),r=i&&this._store.getChoiceById(i);if(!r||r.disabled)return!1;var s=this.dropdown.isActive;if(!r.selected){if(!this._canAddItems())return!0;this._store.withTxn(function(){e._addItem(r,!0,!0),e.clearInput(),e.unhighlightAll()}),this._triggerChange(r.value)}return s&&this.config.closeDropdownOnSelect&&(this.hideDropdown(!0),this.containerOuter.element.focus()),!0},n.prototype._handleBackspace=function(t){var e=this.config;if(!(!e.removeItems||!t.length)){var i=t[t.length-1],r=t.some(function(s){return s.highlighted});e.editItems&&!r&&i?(this.input.value=i.value,this.input.setWidth(),this._removeItem(i),this._triggerChange(i.value)):(r||this.highlightItem(i,!1),this.removeHighlightedItems(!0))}},n.prototype._loadChoices=function(){var t,e=this.config;if(this._isTextElement){if(this._presetChoices=e.items.map(function(s){return _e(s,!1)}),this.passedElement.value){var i=this.passedElement.value.split(e.delimiter).map(function(s){return _e(s,!1)});this._presetChoices=this._presetChoices.concat(i)}this._presetChoices.forEach(function(s){s.selected=!0})}else if(this._isSelectElement){this._presetChoices=e.choices.map(function(s){return _e(s,!0)});var r=this.passedElement.optionsAsChoices();r&&(t=this._presetChoices).push.apply(t,r)}},n.prototype._handleLoadingState=function(t){t===void 0&&(t=!0);var e=this.itemList.element;t?(this.disable(),this.containerOuter.addLoadingState(),this._isSelectOneElement?e.replaceChildren(this._templates.placeholder(this.config,this.config.loadingText)):this.input.placeholder=this.config.loadingText):(this.enable(),this.containerOuter.removeLoadingState(),this._isSelectOneElement?(e.replaceChildren(""),this._render()):this.input.placeholder=this._placeholderValue||"")},n.prototype._handleSearch=function(t){if(this.input.isFocussed)if(t!==null&&typeof t!="undefined"&&t.length>=this.config.searchFloor){var e=this.config.searchChoices?this._searchChoices(t):0;e!==null&&this.passedElement.triggerEvent(te.search,{value:t,resultCount:e})}else this._store.choices.some(function(i){return!i.active})&&this._stopSearch()},n.prototype._canAddItems=function(){var t=this.config,e=t.maxItemCount,i=t.maxItemText;return!t.singleModeForMultiSelect&&e>0&&e<=this._store.items.length?(this.choiceList.element.replaceChildren(""),this._displayNotice(typeof i=="function"?i(e):i,Q.addChoice),!1):!0},n.prototype._canCreateItem=function(t){var e=this.config,i=!0,r="";if(i&&typeof e.addItemFilter=="function"&&!e.addItemFilter(t)&&(i=!1,r=rt(e.customAddItemText,t)),i){var s=this._store.choices.find(function(a){return e.valueComparer(a.value,t)});if(this._isSelectElement){if(s)return this._displayNotice("",Q.addChoice),!1}else this._isTextElement&&!e.duplicateItemsAllowed&&s&&(i=!1,r=rt(e.uniqueItemText,t))}return i&&(r=rt(e.addItemText,t)),r&&this._displayNotice(r,Q.addChoice),i},n.prototype._searchChoices=function(t){var e=t.trim().replace(/\s{2,}/," ");if(!e.length||e===this._currentValue)return null;var i=this._searcher;i.isEmptyIndex()&&i.index(this._store.searchableChoices);var r=i.search(e);this._currentValue=e,this._highlightPosition=0,this._isSearching=!0;var s=this._notice,a=s&&s.type;return a!==Q.addChoice&&(r.length?this._clearNotice():this._displayNotice(ii(this.config.noResultsText),Q.noResults)),this._store.dispatch(ss(r)),r.length},n.prototype._stopSearch=function(){this._isSearching&&(this._currentValue="",this._isSearching=!1,this._clearNotice(),this._store.dispatch(as(!0)),this.passedElement.triggerEvent(te.search,{value:"",resultCount:0}))},n.prototype._addEventListeners=function(){var t=this._docRoot,e=this.containerOuter.element,i=this.input.element;t.addEventListener("touchend",this._onTouchEnd,!0),e.addEventListener("keydown",this._onKeyDown,!0),e.addEventListener("mousedown",this._onMouseDown,!0),t.addEventListener("click",this._onClick,{passive:!0}),t.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.dropdown.element.addEventListener("mouseover",this._onMouseOver,{passive:!0}),this._isSelectOneElement&&(e.addEventListener("focus",this._onFocus,{passive:!0}),e.addEventListener("blur",this._onBlur,{passive:!0})),i.addEventListener("keyup",this._onKeyUp,{passive:!0}),i.addEventListener("input",this._onInput,{passive:!0}),i.addEventListener("focus",this._onFocus,{passive:!0}),i.addEventListener("blur",this._onBlur,{passive:!0}),i.form&&i.form.addEventListener("reset",this._onFormReset,{passive:!0}),this.input.addEventListeners()},n.prototype._removeEventListeners=function(){var t=this._docRoot,e=this.containerOuter.element,i=this.input.element;t.removeEventListener("touchend",this._onTouchEnd,!0),e.removeEventListener("keydown",this._onKeyDown,!0),e.removeEventListener("mousedown",this._onMouseDown,!0),t.removeEventListener("click",this._onClick),t.removeEventListener("touchmove",this._onTouchMove),this.dropdown.element.removeEventListener("mouseover",this._onMouseOver),this._isSelectOneElement&&(e.removeEventListener("focus",this._onFocus),e.removeEventListener("blur",this._onBlur)),i.removeEventListener("keyup",this._onKeyUp),i.removeEventListener("input",this._onInput),i.removeEventListener("focus",this._onFocus),i.removeEventListener("blur",this._onBlur),i.form&&i.form.removeEventListener("reset",this._onFormReset),this.input.removeEventListeners()},n.prototype._onKeyDown=function(t){var e=t.keyCode,i=this.dropdown.isActive,r=t.key.length===1||t.key.length===2&&t.key.charCodeAt(0)>=55296||t.key==="Unidentified";switch(!this._isTextElement&&!i&&(this.showDropdown(),!this.input.isFocussed&&r&&(this.input.value+=t.key,t.key===" "&&t.preventDefault())),e){case 65:return this._onSelectKey(t,this.itemList.element.hasChildNodes());case 13:return this._onEnterKey(t,i);case 27:return this._onEscapeKey(t,i);case 38:case 33:case 40:case 34:return this._onDirectionKey(t,i);case 8:case 46:return this._onDeleteKey(t,this._store.items,this.input.isFocussed)}},n.prototype._onKeyUp=function(){this._canSearch=this.config.searchEnabled},n.prototype._onInput=function(){var t=this.input.value;if(!t){this._isTextElement?this.hideDropdown(!0):this._stopSearch();return}this._canAddItems()&&(this._canSearch&&this._handleSearch(t),this._canAddUserChoices&&(this._canCreateItem(t),this._isSelectElement&&(this._highlightPosition=0,this._highlightChoice())))},n.prototype._onSelectKey=function(t,e){if((t.ctrlKey||t.metaKey)&&e){this._canSearch=!1;var i=this.config.removeItems&&!this.input.value&&this.input.element===document.activeElement;i&&this.highlightAll()}},n.prototype._onEnterKey=function(t,e){var i=this,r=this.input.value,s=t.target;if(t.preventDefault(),s&&s.hasAttribute("data-button")){this._handleButtonAction(s);return}if(!e){(this._isSelectElement||this._notice)&&this.showDropdown();return}var a=this.dropdown.element.querySelector(st(this.config.classNames.highlightedState));if(!(a&&this._handleChoiceAction(a))){if(!s||!r){this.hideDropdown(!0);return}if(this._canAddItems()){var o=!1;this._store.withTxn(function(){if(o=i._findAndSelectChoiceByValue(r,!0),!o){if(!i._canAddUserChoices||!i._canCreateItem(r))return;var l=Tt(r),h=i.config.allowHtmlUserInput||l===r?r:{escaped:l,raw:r};i._addChoice(_e({value:h,label:h,selected:!0},!1),!0,!0),o=!0}i.clearInput(),i.unhighlightAll()}),o&&(this._triggerChange(r),this.config.closeDropdownOnSelect&&this.hideDropdown(!0))}}},n.prototype._onEscapeKey=function(t,e){e&&(t.stopPropagation(),this.hideDropdown(!0),this.containerOuter.element.focus())},n.prototype._onDirectionKey=function(t,e){var i=t.keyCode;if(e||this._isSelectOneElement){this.showDropdown(),this._canSearch=!1;var r=i===40||i===34?1:-1,s=t.metaKey||i===34||i===33,a=void 0;if(s)r>0?a=this.dropdown.element.querySelector("".concat(ot,":last-of-type")):a=this.dropdown.element.querySelector(ot);else{var o=this.dropdown.element.querySelector(st(this.config.classNames.highlightedState));o?a=hs(o,ot,r):a=this.dropdown.element.querySelector(ot)}a&&(ds(a,this.choiceList.element,r)||this.choiceList.scrollToChildElement(a,r),this._highlightChoice(a)),t.preventDefault()}},n.prototype._onDeleteKey=function(t,e,i){!this._isSelectOneElement&&!t.target.value&&i&&(this._handleBackspace(e),t.preventDefault())},n.prototype._onTouchMove=function(){this._wasTap&&(this._wasTap=!1)},n.prototype._onTouchEnd=function(t){var e=(t||t.touches[0]).target,i=this._wasTap&&this.containerOuter.element.contains(e);if(i){var r=e===this.containerOuter.element||e===this.containerInner.element;r&&(this._isTextElement?this.input.focus():this._isSelectMultipleElement&&this.showDropdown()),t.stopPropagation()}this._wasTap=!0},n.prototype._onMouseDown=function(t){var e=t.target;if(e instanceof HTMLElement){if(Da&&this.choiceList.element.contains(e)){var i=this.choiceList.element.firstElementChild;this._isScrollingOnIe=this._direction==="ltr"?t.offsetX>=i.offsetWidth:t.offsetX<i.offsetLeft}if(e!==this.input.element){var r=e.closest("[data-button],[data-item],[data-choice]");r instanceof HTMLElement&&("button"in r.dataset?this._handleButtonAction(r):"item"in r.dataset?this._handleItemAction(r,t.shiftKey):"choice"in r.dataset&&this._handleChoiceAction(r)),t.preventDefault()}}},n.prototype._onMouseOver=function(t){var e=t.target;e instanceof HTMLElement&&"choice"in e.dataset&&this._highlightChoice(e)},n.prototype._onClick=function(t){var e=t.target,i=this.containerOuter,r=i.element.contains(e);r?!this.dropdown.isActive&&!i.isDisabled?this._isTextElement?document.activeElement!==this.input.element&&this.input.focus():(this.showDropdown(),i.element.focus()):this._isSelectOneElement&&e!==this.input.element&&!this.dropdown.element.contains(e)&&this.hideDropdown():(i.removeFocusState(),this.hideDropdown(!0),this.unhighlightAll())},n.prototype._onFocus=function(t){var e=t.target,i=this.containerOuter,r=e&&i.element.contains(e);if(r){var s=e===this.input.element;this._isTextElement?s&&i.addFocusState():this._isSelectMultipleElement?s&&(this.showDropdown(!0),i.addFocusState()):(i.addFocusState(),s&&this.showDropdown(!0))}},n.prototype._onBlur=function(t){var e=t.target,i=this.containerOuter,r=e&&i.element.contains(e);if(r&&!this._isScrollingOnIe){var s=e===this.input.element;this._isTextElement||this._isSelectMultipleElement?s&&(i.removeFocusState(),this.hideDropdown(!0),this.unhighlightAll()):(i.removeFocusState(),(s||e===i.element&&!this._canSearch)&&this.hideDropdown(!0))}else this._isScrollingOnIe=!1,this.input.element.focus()},n.prototype._onFormReset=function(){var t=this;this._store.withTxn(function(){t.clearInput(),t.hideDropdown(),t.refresh(!1,!1,!0),t._initialItems.length&&t.setChoiceByValue(t._initialItems)})},n.prototype._highlightChoice=function(t){t===void 0&&(t=null);var e=Array.from(this.dropdown.element.querySelectorAll(ot));if(e.length){var i=t,r=this.config.classNames.highlightedState,s=Array.from(this.dropdown.element.querySelectorAll(st(r)));s.forEach(function(a){ve(a,r),a.setAttribute("aria-selected","false")}),i?this._highlightPosition=e.indexOf(i):(e.length>this._highlightPosition?i=e[this._highlightPosition]:i=e[e.length-1],i||(i=e[0])),A(i,r),i.setAttribute("aria-selected","true"),this.passedElement.triggerEvent(te.highlightChoice,{el:i}),this.dropdown.isActive&&(this.input.setActiveDescendant(i.id),this.containerOuter.setActiveDescendant(i.id))}},n.prototype._addItem=function(t,e,i){if(e===void 0&&(e=!0),i===void 0&&(i=!1),!t.id)throw new TypeError("item.id must be set before _addItem is called for a choice/item");(this.config.singleModeForMultiSelect||this._isSelectOneElement)&&this.removeActiveItems(t.id),this._store.dispatch(ls(t)),e&&(this.passedElement.triggerEvent(te.addItem,this._getChoiceForOutput(t)),i&&this.passedElement.triggerEvent(te.choice,this._getChoiceForOutput(t)))},n.prototype._removeItem=function(t){t.id&&(this._store.dispatch(ti(t)),this.passedElement.triggerEvent(te.removeItem,this._getChoiceForOutput(t)))},n.prototype._addChoice=function(t,e,i){if(e===void 0&&(e=!0),i===void 0&&(i=!1),t.id)throw new TypeError("Can not re-add a choice which has already been added");var r=this.config;if(!((this._isSelectElement||!r.duplicateItemsAllowed)&&this._store.choices.find(function(o){return r.valueComparer(o.value,t.value)}))){this._lastAddedChoiceId++,t.id=this._lastAddedChoiceId,t.elementId="".concat(this._baseId,"-").concat(this._idNames.itemChoice,"-").concat(t.id);var s=r.prependValue,a=r.appendValue;s&&(t.value=s+t.value),a&&(t.value+=a.toString()),(s||a)&&t.element&&(t.element.value=t.value),this._clearNotice(),this._store.dispatch(rs(t)),t.selected&&this._addItem(t,e,i)}},n.prototype._addGroup=function(t,e){var i=this;if(e===void 0&&(e=!0),t.id)throw new TypeError("Can not re-add a group which has already been added");this._store.dispatch(os(t)),t.choices&&(this._lastAddedGroupId++,t.id=this._lastAddedGroupId,t.choices.forEach(function(r){r.group=t,t.disabled&&(r.disabled=!0),i._addChoice(r,e)}))},n.prototype._createTemplates=function(){var t=this,e=this.config.callbackOnCreateTemplates,i={};typeof e=="function"&&(i=e.call(this,fs,rn,Dt));var r={};Object.keys(this._templates).forEach(function(s){s in i?r[s]=i[s].bind(t):r[s]=t._templates[s].bind(t)}),this._templates=r},n.prototype._createElements=function(){var t=this._templates,e=this,i=e.config,r=e._isSelectOneElement,s=i.position,a=i.classNames,o=this._elementType;this.containerOuter=new ri({element:t.containerOuter(i,this._direction,this._isSelectElement,r,i.searchEnabled,o,i.labelId),classNames:a,type:o,position:s}),this.containerInner=new ri({element:t.containerInner(i),classNames:a,type:o,position:s}),this.input=new Es({element:t.input(i,this._placeholderValue),classNames:a,type:o,preventPaste:!i.paste}),this.choiceList=new si({element:t.choiceList(i,r)}),this.itemList=new si({element:t.itemList(i,r)}),this.dropdown=new ws({element:t.dropdown(i),classNames:a,type:o})},n.prototype._createStructure=function(){var t=this,e=t.containerInner,i=t.containerOuter,r=t.passedElement,s=this.dropdown.element;r.conceal(),e.wrap(r.element),i.wrap(e.element),this._isSelectOneElement?this.input.placeholder=this.config.searchPlaceholderValue||"":(this._placeholderValue&&(this.input.placeholder=this._placeholderValue),this.input.setWidth()),i.element.appendChild(e.element),i.element.appendChild(s),e.element.appendChild(this.itemList.element),s.appendChild(this.choiceList.element),this._isSelectOneElement?this.config.searchEnabled&&s.insertBefore(this.input.element,s.firstChild):e.element.appendChild(this.input.element),this._highlightPosition=0,this._isSearching=!1},n.prototype._initStore=function(){var t=this;this._store.subscribe(this._render).withTxn(function(){t._addPredefinedChoices(t._presetChoices,t._isSelectOneElement&&!t._hasNonChoicePlaceholder,!1)}),(!this._store.choices.length||this._isSelectOneElement&&this._hasNonChoicePlaceholder)&&this._render()},n.prototype._addPredefinedChoices=function(t,e,i){var r=this;if(e===void 0&&(e=!1),i===void 0&&(i=!0),e){var s=t.findIndex(function(a){return a.selected})===-1;s&&t.some(function(a){return a.disabled||"choices"in a?!1:(a.selected=!0,!0)})}t.forEach(function(a){"choices"in a?r._isSelectElement&&r._addGroup(a,i):r._addChoice(a,i)})},n.prototype._findAndSelectChoiceByValue=function(t,e){var i=this;e===void 0&&(e=!1);var r=this._store.choices.find(function(s){return i.config.valueComparer(s.value,t)});return r&&!r.disabled&&!r.selected?(this._addItem(r,!0,e),!0):!1},n.prototype._generatePlaceholderValue=function(){var t=this.config;if(!t.placeholder)return null;if(this._hasNonChoicePlaceholder)return t.placeholderValue;if(this._isSelectElement){var e=this.passedElement.placeholderOption;return e?e.text:null}return null},n.prototype._warnChoicesInitFailed=function(t){if(!this.config.silent)if(this.initialised){if(!this.initialisedOK)throw new TypeError("".concat(t," called for an element which has multiple instances of Choices initialised on it"))}else throw new TypeError("".concat(t," called on a non-initialised instance of Choices"))},n.version="11.0.2",n}();function Oa(){return g(this,null,function*(){const n="https://restcountries.com/v3.1/all";try{const t=yield fetch(n);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return yield t.json()}catch(t){return console.error("Error fetching countries:",t),[]}})}const xa=()=>g(this,null,function*(){const n=document.querySelector("#i-country");if(!n){console.warn("Country select element not found");return}try{const t=new Aa(n,{searchEnabled:!0,searchPlaceholderValue:"Search for a country",placeholder:!0,placeholderValue:"Select a country",removeItemButton:!0,silent:!0}),e=yield Oa(),i=Pa(e);t.setChoices(i,"value","label",!0)}catch(t){console.error("Error initializing country select:",t)}});function Pa(n){return n.sort((t,e)=>t.name.common.localeCompare(e.name.common)).map(t=>({value:t.cca2,label:t.name.common}))}const Ma="modulepreload",La=function(n){return"/"+n},Ii={},Ge=function(t,e,i){return t()},ja=n=>{let t;return n?t=n:typeof fetch=="undefined"?t=(...e)=>Ge(()=>Promise.resolve().then(()=>Je),void 0).then(({default:i})=>i(...e)):t=fetch,(...e)=>t(...e)};class mn extends Error{constructor(t,e="FunctionsError",i){super(t),this.name=e,this.context=i}}class Ra extends mn{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Na extends mn{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Fa extends mn{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var gn;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(gn||(gn={}));var $a=globalThis&&globalThis.__awaiter||function(n,t,e,i){function r(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(c){try{h(i.next(c))}catch(f){a(f)}}function l(c){try{h(i.throw(c))}catch(f){a(f)}}function h(c){c.done?s(c.value):r(c.value).then(o,l)}h((i=i.apply(n,t||[])).next())})};class Ua{constructor(t,{headers:e={},customFetch:i,region:r=gn.Any}={}){this.url=t,this.headers=e,this.region=r,this.fetch=ja(i)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,e={}){var i;return $a(this,void 0,void 0,function*(){try{const{headers:r,method:s,body:a}=e;let o={},{region:l}=e;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let h;a&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob!="undefined"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",h=a):typeof a=="string"?(o["Content-Type"]="text/plain",h=a):typeof FormData!="undefined"&&a instanceof FormData?h=a:(o["Content-Type"]="application/json",h=JSON.stringify(a)));const c=yield this.fetch(`${this.url}/${t}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),r),body:h}).catch(b=>{throw new Ra(b)}),f=c.headers.get("x-relay-error");if(f&&f==="true")throw new Na(c);if(!c.ok)throw new Fa(c);let m=((i=c.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),y;return m==="application/json"?y=yield c.json():m==="application/octet-stream"?y=yield c.blob():m==="text/event-stream"?y=c:m==="multipart/form-data"?y=yield c.formData():y=yield c.text(),{data:y,error:null}}catch(r){return{data:null,error:r}}})}}var he=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Ha(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Ba(n){if(n.__esModule)return n;var t=n.default;if(typeof t=="function"){var e=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(e,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}),e}var ne={},vn={},Ot={},lt={},xt={},Pt={},qa=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("unable to locate global object")},ze=qa();const Ka=ze.fetch,Ai=ze.fetch.bind(ze),Oi=ze.Headers,Wa=ze.Request,Va=ze.Response,Je=Object.freeze(Object.defineProperty({__proto__:null,Headers:Oi,Request:Wa,Response:Va,default:Ai,fetch:Ka},Symbol.toStringTag,{value:"Module"})),Ya=Ba(Je);var Mt={};Object.defineProperty(Mt,"__esModule",{value:!0});class Ga extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}Mt.default=Ga;var xi=he&&he.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Pt,"__esModule",{value:!0});const za=xi(Ya),Ja=xi(Mt);let Qa=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch=="undefined"?this.fetch=za.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=Object.assign({},this.headers),this.headers[t]=e,this}then(t,e){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const i=this.fetch;let r=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(s=>g(this,null,function*(){var a,o,l;let h=null,c=null,f=null,m=s.status,y=s.statusText;if(s.ok){if(this.method!=="HEAD"){const T=yield s.text();T===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=T:c=JSON.parse(T))}const _=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),C=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");_&&C&&C.length>1&&(f=parseInt(C[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(h={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,f=null,m=406,y="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const _=yield s.text();try{h=JSON.parse(_),Array.isArray(h)&&s.status===404&&(c=[],h=null,m=200,y="OK")}catch(C){s.status===404&&_===""?(m=204,y="No Content"):h={message:_}}if(h&&this.isMaybeSingle&&(!((l=h==null?void 0:h.details)===null||l===void 0)&&l.includes("0 rows"))&&(h=null,m=200,y="OK"),h&&this.shouldThrowOnError)throw new Ja.default(h)}return{error:h,data:c,count:f,status:m,statusText:y}}));return this.shouldThrowOnError||(r=r.catch(s=>{var a,o,l;return{error:{message:`${(a=s==null?void 0:s.name)!==null&&a!==void 0?a:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),r.then(t,e)}};Pt.default=Qa;var Xa=he&&he.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(xt,"__esModule",{value:!0});const Za=Xa(Pt);let eo=class extends Za.default{select(t){let e=!1;const i=(t!=null?t:"*").split("").map(r=>/\s/.test(r)&&!e?"":(r==='"'&&(e=!e),r)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:e=!0,nullsFirst:i,foreignTable:r,referencedTable:s=r}={}){const a=s?`${s}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${t}.${e?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:i=e}={}){const r=typeof i=="undefined"?"limit":`${i}.limit`;return this.url.searchParams.set(r,`${t}`),this}range(t,e,{foreignTable:i,referencedTable:r=i}={}){const s=typeof r=="undefined"?"offset":`${r}.offset`,a=typeof r=="undefined"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(a,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:e=!1,settings:i=!1,buffers:r=!1,wal:s=!1,format:a="text"}={}){var o;const l=[t?"analyze":null,e?"verbose":null,i?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),h=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${h}"; options=${l};`,a==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};xt.default=eo;var to=he&&he.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(lt,"__esModule",{value:!0});const no=to(xt);let io=class extends no.default{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}in(t,e){const i=Array.from(new Set(e)).map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`in.(${i})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:i,type:r}={}){let s="";r==="plain"?s="pl":r==="phrase"?s="ph":r==="websearch"&&(s="w");const a=i===void 0?"":`(${i})`;return this.url.searchParams.append(t,`${s}fts${a}.${e}`),this}match(t){return Object.entries(t).forEach(([e,i])=>{this.url.searchParams.append(e,`eq.${i}`)}),this}not(t,e,i){return this.url.searchParams.append(t,`not.${e}.${i}`),this}or(t,{foreignTable:e,referencedTable:i=e}={}){const r=i?`${i}.or`:"or";return this.url.searchParams.append(r,`(${t})`),this}filter(t,e,i){return this.url.searchParams.append(t,`${e}.${i}`),this}};lt.default=io;var ro=he&&he.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ot,"__esModule",{value:!0});const ct=ro(lt);let so=class{constructor(t,{headers:e={},schema:i,fetch:r}){this.url=t,this.headers=e,this.schema=i,this.fetch=r}select(t,{head:e=!1,count:i}={}){const r=e?"HEAD":"GET";let s=!1;const a=(t!=null?t:"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),i&&(this.headers.Prefer=`count=${i}`),new ct.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:e,defaultToNull:i=!0}={}){const r="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),e&&s.push(`count=${e}`),i||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const a=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new ct.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:e,ignoreDuplicates:i=!1,count:r,defaultToNull:s=!0}={}){const a="POST",o=[`resolution=${i?"ignore":"merge"}-duplicates`];if(e!==void 0&&this.url.searchParams.set("on_conflict",e),this.headers.Prefer&&o.push(this.headers.Prefer),r&&o.push(`count=${r}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const l=t.reduce((h,c)=>h.concat(Object.keys(c)),[]);if(l.length>0){const h=[...new Set(l)].map(c=>`"${c}"`);this.url.searchParams.set("columns",h.join(","))}}return new ct.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:e}={}){const i="PATCH",r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),e&&r.push(`count=${e}`),this.headers.Prefer=r.join(","),new ct.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const e="DELETE",i=[];return t&&i.push(`count=${t}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new ct.default({method:e,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Ot.default=so;var Lt={},jt={};Object.defineProperty(jt,"__esModule",{value:!0}),jt.version=void 0,jt.version="0.0.0-automated",Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.DEFAULT_HEADERS=void 0;const ao=jt;Lt.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${ao.version}`};var Pi=he&&he.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(vn,"__esModule",{value:!0});const oo=Pi(Ot),lo=Pi(lt),co=Lt;let uo=class Ir{constructor(t,{headers:e={},schema:i,fetch:r}={}){this.url=t,this.headers=Object.assign(Object.assign({},co.DEFAULT_HEADERS),e),this.schemaName=i,this.fetch=r}from(t){const e=new URL(`${this.url}/${t}`);return new oo.default(e,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Ir(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,e={},{head:i=!1,get:r=!1,count:s}={}){let a;const o=new URL(`${this.url}/rpc/${t}`);let l;i||r?(a=i?"HEAD":"GET",Object.entries(e).filter(([c,f])=>f!==void 0).map(([c,f])=>[c,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([c,f])=>{o.searchParams.append(c,f)})):(a="POST",l=e);const h=Object.assign({},this.headers);return s&&(h.Prefer=`count=${s}`),new lo.default({method:a,url:o,headers:h,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};vn.default=uo;var Qe=he&&he.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ne,"__esModule",{value:!0}),ne.PostgrestError=ne.PostgrestBuilder=ne.PostgrestTransformBuilder=ne.PostgrestFilterBuilder=ne.PostgrestQueryBuilder=ne.PostgrestClient=void 0;const Mi=Qe(vn);ne.PostgrestClient=Mi.default;const Li=Qe(Ot);ne.PostgrestQueryBuilder=Li.default;const ji=Qe(lt);ne.PostgrestFilterBuilder=ji.default;const Ri=Qe(xt);ne.PostgrestTransformBuilder=Ri.default;const Ni=Qe(Pt);ne.PostgrestBuilder=Ni.default;const Fi=Qe(Mt);ne.PostgrestError=Fi.default;var ho=ne.default={PostgrestClient:Mi.default,PostgrestQueryBuilder:Li.default,PostgrestFilterBuilder:ji.default,PostgrestTransformBuilder:Ri.default,PostgrestBuilder:Ni.default,PostgrestError:Fi.default};const{PostgrestClient:fo,PostgrestQueryBuilder:Dc,PostgrestFilterBuilder:Ic,PostgrestTransformBuilder:Ac,PostgrestBuilder:Oc}=ho,po={"X-Client-Info":"realtime-js/2.10.7"},mo="1.0.0",$i=1e4,go=1e3;var Xe;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Xe||(Xe={}));var le;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(le||(le={}));var fe;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(fe||(fe={}));var _n;(function(n){n.websocket="websocket"})(_n||(_n={}));var Ne;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Ne||(Ne={}));class vo{constructor(){this.HEADER_LENGTH=1}decode(t,e){return t.constructor===ArrayBuffer?e(this._binaryDecode(t)):e(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const e=new DataView(t),i=new TextDecoder;return this._decodeBroadcast(t,e,i)}_decodeBroadcast(t,e,i){const r=e.getUint8(1),s=e.getUint8(2);let a=this.HEADER_LENGTH+2;const o=i.decode(t.slice(a,a+r));a=a+r;const l=i.decode(t.slice(a,a+s));a=a+s;const h=JSON.parse(i.decode(t.slice(a,t.byteLength)));return{ref:null,topic:o,event:l,payload:h}}}class Ui{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var F;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(F||(F={}));const Hi=(n,t,e={})=>{var i;const r=(i=e.skipTypes)!==null&&i!==void 0?i:[];return Object.keys(t).reduce((s,a)=>(s[a]=_o(a,n,t,r),s),{})},_o=(n,t,e,i)=>{const r=t.find(o=>o.name===n),s=r==null?void 0:r.type,a=e[n];return s&&!i.includes(s)?Bi(s,a):yn(a)},Bi=(n,t)=>{if(n.charAt(0)==="_"){const e=n.slice(1,n.length);return Eo(t,e)}switch(n){case F.bool:return yo(t);case F.float4:case F.float8:case F.int2:case F.int4:case F.int8:case F.numeric:case F.oid:return bo(t);case F.json:case F.jsonb:return wo(t);case F.timestamp:return Co(t);case F.abstime:case F.date:case F.daterange:case F.int4range:case F.int8range:case F.money:case F.reltime:case F.text:case F.time:case F.timestamptz:case F.timetz:case F.tsrange:case F.tstzrange:return yn(t);default:return yn(t)}},yn=n=>n,yo=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},bo=n=>{if(typeof n=="string"){const t=parseFloat(n);if(!Number.isNaN(t))return t}return n},wo=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(t){return console.log(`JSON parse error: ${t}`),n}return n},Eo=(n,t)=>{if(typeof n!="string")return n;const e=n.length-1,i=n[e];if(n[0]==="{"&&i==="}"){let s;const a=n.slice(1,e);try{s=JSON.parse("["+a+"]")}catch(o){s=a?a.split(","):[]}return s.map(o=>Bi(t,o))}return n},Co=n=>typeof n=="string"?n.replace(" ","T"):n,qi=n=>{let t=n;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class bn{constructor(t,e,i={},r=$i){this.channel=t,this.event=e,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var i;return this._hasReceived(t)&&e((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(i=>i.status===t).forEach(i=>i.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Ki;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Ki||(Ki={}));class ut{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(e==null?void 0:e.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},r=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ut.syncState(this.state,r,s,a),this.pendingDiffs.forEach(l=>{this.state=ut.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(i.diff,{},r=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=ut.syncDiff(this.state,r,s,a),o())}),this.onJoin((r,s,a)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:s,newPresences:a})}),this.onLeave((r,s,a)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,i,r){const s=this.cloneDeep(t),a=this.transformState(e),o={},l={};return this.map(s,(h,c)=>{a[h]||(l[h]=c)}),this.map(a,(h,c)=>{const f=s[h];if(f){const m=c.map(C=>C.presence_ref),y=f.map(C=>C.presence_ref),b=c.filter(C=>y.indexOf(C.presence_ref)<0),_=f.filter(C=>m.indexOf(C.presence_ref)<0);b.length>0&&(o[h]=b),_.length>0&&(l[h]=_)}else o[h]=c}),this.syncDiff(s,{joins:o,leaves:l},i,r)}static syncDiff(t,e,i,r){const{joins:s,leaves:a}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(s,(o,l)=>{var h;const c=(h=t[o])!==null&&h!==void 0?h:[];if(t[o]=this.cloneDeep(l),c.length>0){const f=t[o].map(y=>y.presence_ref),m=c.filter(y=>f.indexOf(y.presence_ref)<0);t[o].unshift(...m)}i(o,c,l)}),this.map(a,(o,l)=>{let h=t[o];if(!h)return;const c=l.map(f=>f.presence_ref);h=h.filter(f=>c.indexOf(f.presence_ref)<0),t[o]=h,r(o,h,l),h.length===0&&delete t[o]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(i=>e(i,t[i]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,i)=>{const r=t[i];return"metas"in r?e[i]=r.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):e[i]=r,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Wi;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Wi||(Wi={}));var Vi;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Vi||(Vi={}));var Yi;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(Yi||(Yi={}));class wn{constructor(t,e={config:{}},i){this.topic=t,this.params=e,this.socket=i,this.bindings={},this.state=le.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new bn(this,fe.join,this.params,this.timeout),this.rejoinTimer=new Ui(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=le.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=le.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=le.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=le.errored,this.rejoinTimer.scheduleTimeout())}),this._on(fe.reply,{},(r,s)=>{this._trigger(this._replyEventName(s),r)}),this.presence=new ut(this),this.broadcastEndpointURL=qi(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,e=this.timeout){var i,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:a,private:o}}=this.params;this._onError(c=>t&&t("CHANNEL_ERROR",c)),this._onClose(()=>t&&t("CLOSED"));const l={},h={broadcast:s,presence:a,postgres_changes:(r=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(c=>c.filter))!==null&&r!==void 0?r:[],private:o};this.socket.accessToken&&(l.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:h},l)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",({postgres_changes:c})=>{var f;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),c===void 0){t&&t("SUBSCRIBED");return}else{const m=this.bindings.postgres_changes,y=(f=m==null?void 0:m.length)!==null&&f!==void 0?f:0,b=[];for(let _=0;_<y;_++){const C=m[_],{filter:{event:T,schema:j,table:R,filter:$}}=C,z=c&&c[_];if(z&&z.event===T&&z.schema===j&&z.table===R&&z.filter===$)b.push(Object.assign(Object.assign({},C),{id:z.id}));else{this.unsubscribe(),t&&t("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,t&&t("SUBSCRIBED");return}}).receive("error",c=>{t&&t("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{t&&t("TIMED_OUT")})}return this}presenceState(){return this.presence.state}track(i){return g(this,arguments,function*(t,e={}){return yield this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)})}untrack(){return g(this,arguments,function*(t={}){return yield this.send({type:"presence",event:"untrack"},t)})}on(t,e,i){return this._on(t,e,i)}send(i){return g(this,arguments,function*(t,e={}){var r,s;if(!this._canPush()&&t.type==="broadcast"){const{event:a,payload:o}=t,l={method:"POST",headers:{Authorization:this.socket.accessToken?`Bearer ${this.socket.accessToken}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const h=yield this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=e.timeout)!==null&&r!==void 0?r:this.timeout);return yield(s=h.body)===null||s===void 0?void 0:s.cancel(),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,h;const c=this._push(t.type,t,e.timeout||this.timeout);t.type==="broadcast"&&!(!((h=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||h===void 0)&&h.ack)&&a("ok"),c.receive("ok",()=>a("ok")),c.receive("error",()=>a("error")),c.receive("timeout",()=>a("timed out"))})})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=le.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(fe.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(i=>{const r=new bn(this,fe.leave,{},t);r.receive("ok",()=>{e(),i("ok")}).receive("timeout",()=>{e(),i("timed out")}).receive("error",()=>{i("error")}),r.send(),this._canPush()||r.trigger("ok",{})})}_fetchWithTimeout(t,e,i){return g(this,null,function*(){const r=new AbortController,s=setTimeout(()=>r.abort(),i),a=yield this.socket.fetch(t,Object.assign(Object.assign({},e),{signal:r.signal}));return clearTimeout(s),a})}_push(t,e,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new bn(this,t,e,i);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(t,e,i){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,i){var r,s;const a=t.toLocaleLowerCase(),{close:o,error:l,leave:h,join:c}=fe;if(i&&[o,l,h,c].indexOf(a)>=0&&i!==this._joinRef())return;let m=this._onMessage(a,e,i);if(e&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(y=>{var b,_,C;return((b=y.filter)===null||b===void 0?void 0:b.event)==="*"||((C=(_=y.filter)===null||_===void 0?void 0:_.event)===null||C===void 0?void 0:C.toLocaleLowerCase())===a}).map(y=>y.callback(m,i)):(s=this.bindings[a])===null||s===void 0||s.filter(y=>{var b,_,C,T,j,R;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in y){const $=y.id,z=(b=y.filter)===null||b===void 0?void 0:b.event;return $&&((_=e.ids)===null||_===void 0?void 0:_.includes($))&&(z==="*"||(z==null?void 0:z.toLocaleLowerCase())===((C=e.data)===null||C===void 0?void 0:C.type.toLocaleLowerCase()))}else{const $=(j=(T=y==null?void 0:y.filter)===null||T===void 0?void 0:T.event)===null||j===void 0?void 0:j.toLocaleLowerCase();return $==="*"||$===((R=e==null?void 0:e.event)===null||R===void 0?void 0:R.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===a}).map(y=>{if(typeof m=="object"&&"ids"in m){const b=m.data,{schema:_,table:C,commit_timestamp:T,type:j,errors:R}=b;m=Object.assign(Object.assign({},{schema:_,table:C,commit_timestamp:T,eventType:j,new:{},old:{},errors:R}),this._getPayloadRecords(b))}y.callback(m,i)})}_isClosed(){return this.state===le.closed}_isJoined(){return this.state===le.joined}_isJoining(){return this.state===le.joining}_isLeaving(){return this.state===le.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,i){const r=t.toLocaleLowerCase(),s={type:r,filter:e,callback:i};return this.bindings[r]?this.bindings[r].push(s):this.bindings[r]=[s],this}_off(t,e){const i=t.toLocaleLowerCase();return this.bindings[i]=this.bindings[i].filter(r=>{var s;return!(((s=r.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===i&&wn.isEqual(r.filter,e))}),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const i in t)if(t[i]!==e[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(fe.close,{},t)}_onError(t){this._on(fe.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=le.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const e={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(e.new=Hi(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(e.old=Hi(t.columns,t.old_record)),e}}const So=()=>{},ko=typeof WebSocket!="undefined",To=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Do{constructor(t,e){var i;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=po,this.params={},this.timeout=$i,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=So,this.conn=null,this.sendBuffer=[],this.serializer=new vo,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=s=>{let a;return s?a=s:typeof fetch=="undefined"?a=(...o)=>Ge(()=>Promise.resolve().then(()=>Je),void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${t}/${_n.websocket}`,this.httpEndpoint=qi(t),e!=null&&e.transport?this.transport=e.transport:this.transport=null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.headers&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),e!=null&&e.timeout&&(this.timeout=e.timeout),e!=null&&e.logger&&(this.logger=e.logger),e!=null&&e.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs);const r=(i=e==null?void 0:e.params)===null||i===void 0?void 0:i.apikey;if(r&&(this.accessToken=r,this.apiKey=r),this.reconnectAfterMs=e!=null&&e.reconnectAfterMs?e.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=e!=null&&e.encode?e.encode:(s,a)=>a(JSON.stringify(s)),this.decode=e!=null&&e.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ui(()=>g(this,null,function*(){this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(e==null?void 0:e.fetch),e!=null&&e.worker){if(typeof window!="undefined"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(e==null?void 0:e.worker)||!1,this.workerUrl=e==null?void 0:e.workerUrl}}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(ko){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new Io(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Ge(()=>Promise.resolve().then(()=>Wl),void 0).then(({default:t})=>{this.conn=new t(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(t,e){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,e!=null?e:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}removeChannel(t){return g(this,null,function*(){const e=yield t.unsubscribe();return this.channels.length===0&&this.disconnect(),e})}removeAllChannels(){return g(this,null,function*(){const t=yield Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),t})}log(t,e,i){this.logger(t,e,i)}connectionState(){switch(this.conn&&this.conn.readyState){case Xe.connecting:return Ne.Connecting;case Xe.open:return Ne.Open;case Xe.closing:return Ne.Closing;default:return Ne.Closed}}isConnected(){return this.connectionState()===Ne.Open}channel(t,e={config:{}}){const i=new wn(`realtime:${t}`,e,this);return this.channels.push(i),i}push(t){const{topic:e,event:i,payload:r,ref:s}=t,a=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${e} ${i} (${s})`,r),this.isConnected()?a():this.sendBuffer.push(a)}setAuth(t){this.accessToken=t,this.channels.forEach(e=>{t&&e.updateJoinPayload({access_token:t}),e.joinedOnce&&e._isJoined()&&e._push(fe.access_token,{access_token:t})})}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(i=>i.topic===t&&(i._isJoined()||i._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:mo}))}_onConnMessage(t){this.decode(t.data,e=>{let{topic:i,event:r,payload:s,ref:a}=e;(a&&a===this.pendingHeartbeatRef||r===(s==null?void 0:s.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${i} ${r} ${a&&"("+a+")"||""}`,s),this.channels.filter(o=>o._isMember(i)).forEach(o=>o._trigger(r,s,a)),this.stateChangeCallbacks.message.forEach(o=>o(e))})}_onConnOpen(){return g(this,null,function*(){if(this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this._sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(fe.error))}_appendParams(t,e){if(Object.keys(e).length===0)return t;const i=t.match(/\?/)?"&":"?",r=new URLSearchParams(e);return`${t}${i}${r}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(go,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}_workerObjectUrl(t){let e;if(t)e=t;else{const i=new Blob([To],{type:"application/javascript"});e=URL.createObjectURL(i)}return e}}class Io{constructor(t,e,i){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Xe.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=i.close}}class En extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Y(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Ao extends En{constructor(t,e){super(t),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Cn extends En{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}}var Oo=globalThis&&globalThis.__awaiter||function(n,t,e,i){function r(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(c){try{h(i.next(c))}catch(f){a(f)}}function l(c){try{h(i.throw(c))}catch(f){a(f)}}function h(c){c.done?s(c.value):r(c.value).then(o,l)}h((i=i.apply(n,t||[])).next())})};const Gi=n=>{let t;return n?t=n:typeof fetch=="undefined"?t=(...e)=>Ge(()=>Promise.resolve().then(()=>Je),void 0).then(({default:i})=>i(...e)):t=fetch,(...e)=>t(...e)},xo=()=>Oo(void 0,void 0,void 0,function*(){return typeof Response=="undefined"?(yield Ge(()=>Promise.resolve().then(()=>Je),void 0)).Response:Response}),Sn=n=>{if(Array.isArray(n))return n.map(e=>Sn(e));if(typeof n=="function"||n!==Object(n))return n;const t={};return Object.entries(n).forEach(([e,i])=>{const r=e.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[r]=Sn(i)}),t};var Fe=globalThis&&globalThis.__awaiter||function(n,t,e,i){function r(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(c){try{h(i.next(c))}catch(f){a(f)}}function l(c){try{h(i.throw(c))}catch(f){a(f)}}function h(c){c.done?s(c.value):r(c.value).then(o,l)}h((i=i.apply(n,t||[])).next())})};const kn=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Po=(n,t,e)=>Fe(void 0,void 0,void 0,function*(){const i=yield xo();n instanceof i&&!(e!=null&&e.noResolveJson)?n.json().then(r=>{t(new Ao(kn(r),n.status||500))}).catch(r=>{t(new Cn(kn(r),r))}):t(new Cn(kn(n),n))}),Mo=(n,t,e,i)=>{const r={method:n,headers:(t==null?void 0:t.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i&&(r.body=JSON.stringify(i)),Object.assign(Object.assign({},r),e))};function ht(n,t,e,i,r,s){return Fe(this,void 0,void 0,function*(){return new Promise((a,o)=>{n(e,Mo(t,i,r,s)).then(l=>{if(!l.ok)throw l;return i!=null&&i.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>Po(l,o,i))})})}function Rt(n,t,e,i){return Fe(this,void 0,void 0,function*(){return ht(n,"GET",t,e,i)})}function Te(n,t,e,i,r){return Fe(this,void 0,void 0,function*(){return ht(n,"POST",t,i,r,e)})}function Lo(n,t,e,i,r){return Fe(this,void 0,void 0,function*(){return ht(n,"PUT",t,i,r,e)})}function jo(n,t,e,i){return Fe(this,void 0,void 0,function*(){return ht(n,"HEAD",t,Object.assign(Object.assign({},e),{noResolveJson:!0}),i)})}function zi(n,t,e,i,r){return Fe(this,void 0,void 0,function*(){return ht(n,"DELETE",t,i,r,e)})}var ie=globalThis&&globalThis.__awaiter||function(n,t,e,i){function r(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(c){try{h(i.next(c))}catch(f){a(f)}}function l(c){try{h(i.throw(c))}catch(f){a(f)}}function h(c){c.done?s(c.value):r(c.value).then(o,l)}h((i=i.apply(n,t||[])).next())})};const Ro={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ji={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class No{constructor(t,e={},i,r){this.url=t,this.headers=e,this.bucketId=i,this.fetch=Gi(r)}uploadOrUpdate(t,e,i,r){return ie(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},Ji),r);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob!="undefined"&&i instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",i)):typeof FormData!="undefined"&&i instanceof FormData?(s=i,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=i,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),r!=null&&r.headers&&(o=Object.assign(Object.assign({},o),r.headers));const h=this._removeEmptyFolders(e),c=this._getFinalPath(h),f=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:t,body:s,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),m=yield f.json();return f.ok?{data:{path:h,id:m.Id,fullPath:m.Key},error:null}:{data:null,error:m}}catch(s){if(Y(s))return{data:null,error:s};throw s}})}upload(t,e,i){return ie(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,i)})}uploadToSignedUrl(t,e,i,r){return ie(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",e);try{let l;const h=Object.assign({upsert:Ji.upsert},r),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(h.upsert)});typeof Blob!="undefined"&&i instanceof Blob?(l=new FormData,l.append("cacheControl",h.cacheControl),l.append("",i)):typeof FormData!="undefined"&&i instanceof FormData?(l=i,l.append("cacheControl",h.cacheControl)):(l=i,c["cache-control"]=`max-age=${h.cacheControl}`,c["content-type"]=h.contentType);const f=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:c}),m=yield f.json();return f.ok?{data:{path:s,fullPath:m.Key},error:null}:{data:null,error:m}}catch(l){if(Y(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,e){return ie(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t);const r=Object.assign({},this.headers);e!=null&&e.upsert&&(r["x-upsert"]="true");const s=yield Te(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:r}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new En("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:o},error:null}}catch(i){if(Y(i))return{data:null,error:i};throw i}})}update(t,e,i){return ie(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,i)})}move(t,e,i){return ie(this,void 0,void 0,function*(){try{return{data:yield Te(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}})}copy(t,e,i){return ie(this,void 0,void 0,function*(){try{return{data:{path:(yield Te(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}})}createSignedUrl(t,e,i){return ie(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t),s=yield Te(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:e},i!=null&&i.transform?{transform:i.transform}:{}),{headers:this.headers});const a=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}})}createSignedUrls(t,e,i){return ie(this,void 0,void 0,function*(){try{const r=yield Te(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),s=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{data:r.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}})}download(t,e){return ie(this,void 0,void 0,function*(){const r=typeof(e==null?void 0:e.transform)!="undefined"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),a=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield Rt(this.fetch,`${this.url}/${r}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Y(o))return{data:null,error:o};throw o}})}info(t){return ie(this,void 0,void 0,function*(){const e=this._getFinalPath(t);try{const i=yield Rt(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:Sn(i),error:null}}catch(i){if(Y(i))return{data:null,error:i};throw i}})}exists(t){return ie(this,void 0,void 0,function*(){const e=this._getFinalPath(t);try{return yield jo(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(Y(i)&&i instanceof Cn){const r=i.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:i}}throw i}})}getPublicUrl(t,e){const i=this._getFinalPath(t),r=[],s=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&r.push(s);const o=typeof(e==null?void 0:e.transform)!="undefined"?"render/image":"object",l=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});l!==""&&r.push(l);let h=r.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${i}${h}`)}}}remove(t){return ie(this,void 0,void 0,function*(){try{return{data:yield zi(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(Y(e))return{data:null,error:e};throw e}})}list(t,e,i){return ie(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},Ro),e),{prefix:t||""});return{data:yield Te(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer!="undefined"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}}const Fo={"X-Client-Info":"storage-js/2.7.1"};var Ze=globalThis&&globalThis.__awaiter||function(n,t,e,i){function r(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(c){try{h(i.next(c))}catch(f){a(f)}}function l(c){try{h(i.throw(c))}catch(f){a(f)}}function h(c){c.done?s(c.value):r(c.value).then(o,l)}h((i=i.apply(n,t||[])).next())})};class $o{constructor(t,e={},i){this.url=t,this.headers=Object.assign(Object.assign({},Fo),e),this.fetch=Gi(i)}listBuckets(){return Ze(this,void 0,void 0,function*(){try{return{data:yield Rt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Y(t))return{data:null,error:t};throw t}})}getBucket(t){return Ze(this,void 0,void 0,function*(){try{return{data:yield Rt(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(Y(e))return{data:null,error:e};throw e}})}createBucket(t,e={public:!1}){return Ze(this,void 0,void 0,function*(){try{return{data:yield Te(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(Y(i))return{data:null,error:i};throw i}})}updateBucket(t,e){return Ze(this,void 0,void 0,function*(){try{return{data:yield Lo(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(Y(i))return{data:null,error:i};throw i}})}emptyBucket(t){return Ze(this,void 0,void 0,function*(){try{return{data:yield Te(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(Y(e))return{data:null,error:e};throw e}})}deleteBucket(t){return Ze(this,void 0,void 0,function*(){try{return{data:yield zi(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(Y(e))return{data:null,error:e};throw e}})}}class Uo extends $o{constructor(t,e={},i){super(t,e,i)}from(t){return new No(this.url,this.headers,t,this.fetch)}}const Ho="2.46.1";let dt="";typeof Deno!="undefined"?dt="deno":typeof document!="undefined"?dt="web":typeof navigator!="undefined"&&navigator.product==="ReactNative"?dt="react-native":dt="node";const Bo={headers:{"X-Client-Info":`supabase-js-${dt}/${Ho}`}},qo={schema:"public"},Ko={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Wo={};var Vo=globalThis&&globalThis.__awaiter||function(n,t,e,i){function r(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(c){try{h(i.next(c))}catch(f){a(f)}}function l(c){try{h(i.throw(c))}catch(f){a(f)}}function h(c){c.done?s(c.value):r(c.value).then(o,l)}h((i=i.apply(n,t||[])).next())})};const Yo=n=>{let t;return n?t=n:typeof fetch=="undefined"?t=Ai:t=fetch,(...e)=>t(...e)},Go=()=>typeof Headers=="undefined"?Oi:Headers,zo=(n,t,e)=>{const i=Yo(e),r=Go();return(s,a)=>Vo(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:n;let h=new r(a==null?void 0:a.headers);return h.has("apikey")||h.set("apikey",n),h.has("Authorization")||h.set("Authorization",`Bearer ${l}`),i(s,Object.assign(Object.assign({},a),{headers:h}))})};var Jo=globalThis&&globalThis.__awaiter||function(n,t,e,i){function r(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(c){try{h(i.next(c))}catch(f){a(f)}}function l(c){try{h(i.throw(c))}catch(f){a(f)}}function h(c){c.done?s(c.value):r(c.value).then(o,l)}h((i=i.apply(n,t||[])).next())})};function Qo(n){return n.replace(/\/$/,"")}function Xo(n,t){const{db:e,auth:i,realtime:r,global:s}=n,{db:a,auth:o,realtime:l,global:h}=t,c={db:Object.assign(Object.assign({},a),e),auth:Object.assign(Object.assign({},o),i),realtime:Object.assign(Object.assign({},l),r),global:Object.assign(Object.assign({},h),s),accessToken:()=>Jo(this,void 0,void 0,function*(){return""})};return n.accessToken?c.accessToken=n.accessToken:delete c.accessToken,c}const Qi="2.65.1",Zo="http://localhost:9999",el="supabase.auth.token",tl={"X-Client-Info":`gotrue-js/${Qi}`},Xi=10,Tn="X-Supabase-Api-Version",Zi={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function nl(n){return Math.round(Date.now()/1e3)+n}function il(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const t=Math.random()*16|0;return(n=="x"?t:t&3|8).toString(16)})}const pe=()=>typeof document!="undefined",$e={tested:!1,writable:!1},ft=()=>{if(!pe())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch(t){return!1}if($e.tested)return $e.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),$e.tested=!0,$e.writable=!0}catch(t){$e.tested=!0,$e.writable=!1}return $e.writable};function Dn(n){const t={},e=new URL(n);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((r,s)=>{t[s]=r})}catch(i){}return e.searchParams.forEach((i,r)=>{t[r]=i}),t}const er=n=>{let t;return n?t=n:typeof fetch=="undefined"?t=(...e)=>Ge(()=>Promise.resolve().then(()=>Je),void 0).then(({default:i})=>i(...e)):t=fetch,(...e)=>t(...e)},rl=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",tr=(n,t,e)=>g(this,null,function*(){yield n.setItem(t,JSON.stringify(e))}),Nt=(n,t)=>g(this,null,function*(){const e=yield n.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch(i){return e}}),Ft=(n,t)=>g(this,null,function*(){yield n.removeItem(t)});function sl(n){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let e="",i,r,s,a,o,l,h,c=0;for(n=n.replace("-","+").replace("_","/");c<n.length;)a=t.indexOf(n.charAt(c++)),o=t.indexOf(n.charAt(c++)),l=t.indexOf(n.charAt(c++)),h=t.indexOf(n.charAt(c++)),i=a<<2|o>>4,r=(o&15)<<4|l>>2,s=(l&3)<<6|h,e=e+String.fromCharCode(i),l!=64&&r!=0&&(e=e+String.fromCharCode(r)),h!=64&&s!=0&&(e=e+String.fromCharCode(s));return e}class $t{constructor(){this.promise=new $t.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}}$t.promiseConstructor=Promise;function nr(n){const t=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,e=n.split(".");if(e.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!t.test(e[1]))throw new Error("JWT is not valid: payload is not in base64url format");const i=e[1];return JSON.parse(sl(i))}function al(n){return g(this,null,function*(){return yield new Promise(t=>{setTimeout(()=>t(null),n)})})}function ol(n,t){return new Promise((i,r)=>{g(this,null,function*(){for(let s=0;s<1/0;s++)try{const a=yield n(s);if(!t(s,null,a)){i(a);return}}catch(a){if(!t(s,a)){r(a);return}}})})}function ll(n){return("0"+n.toString(16)).substr(-2)}function cl(){const t=new Uint32Array(56);if(typeof crypto=="undefined"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=e.length;let r="";for(let s=0;s<56;s++)r+=e.charAt(Math.floor(Math.random()*i));return r}return crypto.getRandomValues(t),Array.from(t,ll).join("")}function ul(n){return g(this,null,function*(){const e=new TextEncoder().encode(n),i=yield crypto.subtle.digest("SHA-256",e),r=new Uint8Array(i);return Array.from(r).map(s=>String.fromCharCode(s)).join("")})}function hl(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function dl(n){return g(this,null,function*(){if(!(typeof crypto!="undefined"&&typeof crypto.subtle!="undefined"&&typeof TextEncoder!="undefined"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const e=yield ul(n);return hl(e)})}function et(n,t,e=!1){return g(this,null,function*(){const i=cl();let r=i;e&&(r+="/PASSWORD_RECOVERY"),yield tr(n,`${t}-code-verifier`,r);const s=yield dl(i);return[s,i===s?"plain":"s256"]})}const fl=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function pl(n){const t=n.headers.get(Tn);if(!t||!t.match(fl))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}class In extends Error{constructor(t,e,i){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=i}}function x(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class ml extends In{constructor(t,e,i){super(t,e,i),this.name="AuthApiError",this.status=e,this.code=i}}function gl(n){return x(n)&&n.name==="AuthApiError"}class ir extends In{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}}class Ue extends In{constructor(t,e,i,r){super(t,i,r),this.name=e,this.status=i}}class De extends Ue{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function vl(n){return x(n)&&n.name==="AuthSessionMissingError"}class An extends Ue{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ut extends Ue{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Ht extends Ue{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class rr extends Ue{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class On extends Ue{constructor(t,e){super(t,"AuthRetryableFetchError",e,void 0)}}function xn(n){return x(n)&&n.name==="AuthRetryableFetchError"}class sr extends Ue{constructor(t,e,i){super(t,"AuthWeakPasswordError",e,"weak_password"),this.reasons=i}}var _l=globalThis&&globalThis.__rest||function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};const He=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),yl=[502,503,504];function ar(n){return g(this,null,function*(){var t;if(!rl(n))throw new On(He(n),0);if(yl.includes(n.status))throw new On(He(n),n.status);let e;try{e=yield n.json()}catch(s){throw new ir(He(s),s)}let i;const r=pl(n);if(r&&r.getTime()>=Zi["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?i=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(i=e.error_code),i){if(i==="weak_password")throw new sr(He(e),n.status,((t=e.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(i==="session_not_found")throw new De}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new sr(He(e),n.status,e.weak_password.reasons);throw new ml(He(e),n.status||500,i)})}const bl=(n,t,e,i)=>{const r={method:n,headers:(t==null?void 0:t.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),e))};function L(n,t,e,i){return g(this,null,function*(){var r;const s=Object.assign({},i==null?void 0:i.headers);s[Tn]||(s[Tn]=Zi["2024-01-01"].name),i!=null&&i.jwt&&(s.Authorization=`Bearer ${i.jwt}`);const a=(r=i==null?void 0:i.query)!==null&&r!==void 0?r:{};i!=null&&i.redirectTo&&(a.redirect_to=i.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=yield wl(n,t,e+o,{headers:s,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(l):{data:Object.assign({},l),error:null}})}function wl(n,t,e,i,r,s){return g(this,null,function*(){const a=bl(t,i,r,s);let o;try{o=yield n(e,Object.assign({},a))}catch(l){throw console.error(l),new On(He(l),0)}if(o.ok||(yield ar(o)),i!=null&&i.noResolveJson)return o;try{return yield o.json()}catch(l){yield ar(l)}})}function Ie(n){var t;let e=null;kl(n)&&(e=Object.assign({},n),n.expires_at||(e.expires_at=nl(n.expires_in)));const i=(t=n.user)!==null&&t!==void 0?t:n;return{data:{session:e,user:i},error:null}}function or(n){const t=Ie(n);return!t.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((e,i)=>e&&typeof i=="string",!0)&&(t.data.weak_password=n.weak_password),t}function Ae(n){var t;return{data:{user:(t=n.user)!==null&&t!==void 0?t:n},error:null}}function El(n){return{data:n,error:null}}function Cl(n){const{action_link:t,email_otp:e,hashed_token:i,redirect_to:r,verification_type:s}=n,a=_l(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:e,hashed_token:i,redirect_to:r,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function Sl(n){return n}function kl(n){return n.access_token&&n.refresh_token&&n.expires_in}var Tl=globalThis&&globalThis.__rest||function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};class Dl{constructor({url:t="",headers:e={},fetch:i}){this.url=t,this.headers=e,this.fetch=er(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(t,e="global"){return g(this,null,function*(){try{return yield L(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(i){if(x(i))return{data:null,error:i};throw i}})}inviteUserByEmail(i){return g(this,arguments,function*(t,e={}){try{return yield L(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:Ae})}catch(r){if(x(r))return{data:{user:null},error:r};throw r}})}generateLink(t){return g(this,null,function*(){try{const{options:e}=t,i=Tl(t,["options"]),r=Object.assign(Object.assign({},i),e);return"newEmail"in i&&(r.new_email=i==null?void 0:i.newEmail,delete r.newEmail),yield L(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:Cl,redirectTo:e==null?void 0:e.redirectTo})}catch(e){if(x(e))return{data:{properties:null,user:null},error:e};throw e}})}createUser(t){return g(this,null,function*(){try{return yield L(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ae})}catch(e){if(x(e))return{data:{user:null},error:e};throw e}})}listUsers(t){return g(this,null,function*(){var e,i,r,s,a,o,l;try{const h={nextPage:null,lastPage:0,total:0},c=yield L(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(e=t==null?void 0:t.page)===null||e===void 0?void 0:e.toString())!==null&&i!==void 0?i:"",per_page:(s=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:""},xform:Sl});if(c.error)throw c.error;const f=yield c.json(),m=(a=c.headers.get("x-total-count"))!==null&&a!==void 0?a:0,y=(l=(o=c.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return y.length>0&&(y.forEach(b=>{const _=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),C=JSON.parse(b.split(";")[1].split("=")[1]);h[`${C}Page`]=_}),h.total=parseInt(m)),{data:Object.assign(Object.assign({},f),h),error:null}}catch(h){if(x(h))return{data:{users:[]},error:h};throw h}})}getUserById(t){return g(this,null,function*(){try{return yield L(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ae})}catch(e){if(x(e))return{data:{user:null},error:e};throw e}})}updateUserById(t,e){return g(this,null,function*(){try{return yield L(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:Ae})}catch(i){if(x(i))return{data:{user:null},error:i};throw i}})}deleteUser(t,e=!1){return g(this,null,function*(){try{return yield L(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:Ae})}catch(i){if(x(i))return{data:{user:null},error:i};throw i}})}_listFactors(t){return g(this,null,function*(){try{const{data:e,error:i}=yield L(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:e,error:i}}catch(e){if(x(e))return{data:null,error:e};throw e}})}_deleteFactor(t){return g(this,null,function*(){try{return{data:yield L(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(x(e))return{data:null,error:e};throw e}})}}const Il={getItem:n=>ft()?globalThis.localStorage.getItem(n):null,setItem:(n,t)=>{ft()&&globalThis.localStorage.setItem(n,t)},removeItem:n=>{ft()&&globalThis.localStorage.removeItem(n)}};function lr(n={}){return{getItem:t=>n[t]||null,setItem:(t,e)=>{n[t]=e},removeItem:t=>{delete n[t]}}}function Al(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(n){typeof self!="undefined"&&(self.globalThis=self)}}const tt={debug:!!(globalThis&&ft()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class cr extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Ol extends cr{}function xl(n,t,e){return g(this,null,function*(){tt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,t);const i=new globalThis.AbortController;return t>0&&setTimeout(()=>{i.abort(),tt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},t),yield globalThis.navigator.locks.request(n,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},r=>g(this,null,function*(){if(r){tt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,r.name);try{return yield e()}finally{tt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,r.name)}}else{if(t===0)throw tt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Ol(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(tt.debug)try{const s=yield globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),yield e()}}))})}Al();const Pl={url:Zo,storageKey:el,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:tl,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},pt=30*1e3,ur=3;function hr(n,t,e){return g(this,null,function*(){return yield e()})}class mt{constructor(t){var e,i;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=mt.nextInstanceID,mt.nextInstanceID+=1,this.instanceID>0&&pe()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},Pl),t);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new Dl({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=er(r.fetch),this.lock=r.lock||hr,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:pe()&&(!((e=globalThis==null?void 0:globalThis.navigator)===null||e===void 0)&&e.locks)?this.lock=xl:this.lock=hr,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:ft()?this.storage=Il:(this.memoryStorage={},this.storage=lr(this.memoryStorage)):(this.memoryStorage={},this.storage=lr(this.memoryStorage)),pe()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",s=>g(this,null,function*(){this._debug("received broadcast notification from other tab or client",s),yield this._notifyAllSubscribers(s.data.event,s.data.session,!1)}))}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Qi}) ${new Date().toISOString()}`,...t),this}initialize(){return g(this,null,function*(){return this.initializePromise?yield this.initializePromise:(this.initializePromise=(()=>g(this,null,function*(){return yield this._acquireLock(-1,()=>g(this,null,function*(){return yield this._initialize()}))}))(),yield this.initializePromise)})}_initialize(){return g(this,null,function*(){try{const t=pe()?yield this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",t),t||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:e,error:i}=yield this._getSessionFromURL(t);if(i)return this._debug("#_initialize()","error detecting session from URL",i),(i==null?void 0:i.code)==="identity_already_exists"?{error:i}:(yield this._removeSession(),{error:i});const{session:r,redirectType:s}=e;return this._debug("#_initialize()","detected session in URL",r,"redirect type",s),yield this._saveSession(r),setTimeout(()=>g(this,null,function*(){s==="recovery"?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",r):yield this._notifyAllSubscribers("SIGNED_IN",r)}),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(t){return x(t)?{error:t}:{error:new ir("Unexpected error during initialization",t)}}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}})}signInAnonymously(t){return g(this,null,function*(){var e,i,r;try{const s=yield L(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(e=t==null?void 0:t.options)===null||e===void 0?void 0:e.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.captchaToken}},xform:Ie}),{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,h=a.user;return a.session&&(yield this._saveSession(a.session),yield this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:h,session:l},error:null}}catch(s){if(x(s))return{data:{user:null,session:null},error:s};throw s}})}signUp(t){return g(this,null,function*(){var e,i,r;try{let s;if("email"in t){const{email:c,password:f,options:m}=t;let y=null,b=null;this.flowType==="pkce"&&([y,b]=yield et(this.storage,this.storageKey)),s=yield L(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:c,password:f,data:(e=m==null?void 0:m.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:y,code_challenge_method:b},xform:Ie})}else if("phone"in t){const{phone:c,password:f,options:m}=t;s=yield L(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:f,data:(i=m==null?void 0:m.data)!==null&&i!==void 0?i:{},channel:(r=m==null?void 0:m.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:Ie})}else throw new Ut("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,h=a.user;return a.session&&(yield this._saveSession(a.session),yield this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:h,session:l},error:null}}catch(s){if(x(s))return{data:{user:null,session:null},error:s};throw s}})}signInWithPassword(t){return g(this,null,function*(){try{let e;if("email"in t){const{email:s,password:a,options:o}=t;e=yield L(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:or})}else if("phone"in t){const{phone:s,password:a,options:o}=t;e=yield L(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:or})}else throw new Ut("You must provide either an email or phone number and a password");const{data:i,error:r}=e;return r?{data:{user:null,session:null},error:r}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new An}:(i.session&&(yield this._saveSession(i.session),yield this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:r})}catch(e){if(x(e))return{data:{user:null,session:null},error:e};throw e}})}signInWithOAuth(t){return g(this,null,function*(){var e,i,r,s;return yield this._handleProviderSignIn(t.provider,{redirectTo:(e=t.options)===null||e===void 0?void 0:e.redirectTo,scopes:(i=t.options)===null||i===void 0?void 0:i.scopes,queryParams:(r=t.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})})}exchangeCodeForSession(t){return g(this,null,function*(){return yield this.initializePromise,this._acquireLock(-1,()=>g(this,null,function*(){return this._exchangeCodeForSession(t)}))})}_exchangeCodeForSession(t){return g(this,null,function*(){const e=yield Nt(this.storage,`${this.storageKey}-code-verifier`),[i,r]=(e!=null?e:"").split("/");try{const{data:s,error:a}=yield L(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:i},xform:Ie});if(yield Ft(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new An}:(s.session&&(yield this._saveSession(s.session),yield this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:r!=null?r:null}),error:a})}catch(s){if(x(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}})}signInWithIdToken(t){return g(this,null,function*(){try{const{options:e,provider:i,token:r,access_token:s,nonce:a}=t,o=yield L(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:r,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:e==null?void 0:e.captchaToken}},xform:Ie}),{data:l,error:h}=o;return h?{data:{user:null,session:null},error:h}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new An}:(l.session&&(yield this._saveSession(l.session),yield this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:h})}catch(e){if(x(e))return{data:{user:null,session:null},error:e};throw e}})}signInWithOtp(t){return g(this,null,function*(){var e,i,r,s,a;try{if("email"in t){const{email:o,options:l}=t;let h=null,c=null;this.flowType==="pkce"&&([h,c]=yield et(this.storage,this.storageKey));const{error:f}=yield L(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(e=l==null?void 0:l.data)!==null&&e!==void 0?e:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:h,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:o,options:l}=t,{data:h,error:c}=yield L(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:c}}throw new Ut("You must provide either an email or phone number.")}catch(o){if(x(o))return{data:{user:null,session:null},error:o};throw o}})}verifyOtp(t){return g(this,null,function*(){var e,i;try{let r,s;"options"in t&&(r=(e=t.options)===null||e===void 0?void 0:e.redirectTo,s=(i=t.options)===null||i===void 0?void 0:i.captchaToken);const{data:a,error:o}=yield L(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:r,xform:Ie});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,h=a.user;return l!=null&&l.access_token&&(yield this._saveSession(l),yield this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:h,session:l},error:null}}catch(r){if(x(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithSSO(t){return g(this,null,function*(){var e,i,r;try{let s=null,a=null;return this.flowType==="pkce"&&([s,a]=yield et(this.storage,this.storageKey)),yield L(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(i=(e=t.options)===null||e===void 0?void 0:e.redirectTo)!==null&&i!==void 0?i:void 0}),!((r=t==null?void 0:t.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:El})}catch(s){if(x(s))return{data:null,error:s};throw s}})}reauthenticate(){return g(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){return yield this._reauthenticate()}))})}_reauthenticate(){return g(this,null,function*(){try{return yield this._useSession(t=>g(this,null,function*(){const{data:{session:e},error:i}=t;if(i)throw i;if(!e)throw new De;const{error:r}=yield L(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return{data:{user:null,session:null},error:r}}))}catch(t){if(x(t))return{data:{user:null,session:null},error:t};throw t}})}resend(t){return g(this,null,function*(){try{const e=`${this.url}/resend`;if("email"in t){const{email:i,type:r,options:s}=t,{error:a}=yield L(this.fetch,"POST",e,{headers:this.headers,body:{email:i,type:r,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in t){const{phone:i,type:r,options:s}=t,{data:a,error:o}=yield L(this.fetch,"POST",e,{headers:this.headers,body:{phone:i,type:r,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new Ut("You must provide either an email or phone number and a type")}catch(e){if(x(e))return{data:{user:null,session:null},error:e};throw e}})}getSession(){return g(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){return this._useSession(e=>g(this,null,function*(){return e}))}))})}_acquireLock(t,e){return g(this,null,function*(){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(()=>g(this,null,function*(){return yield i,yield e()}))();return this.pendingInLock.push((()=>g(this,null,function*(){try{yield r}catch(s){}}))()),r}return yield this.lock(`lock:${this.storageKey}`,t,()=>g(this,null,function*(){this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=e();for(this.pendingInLock.push((()=>g(this,null,function*(){try{yield i}catch(r){}}))()),yield i;this.pendingInLock.length;){const r=[...this.pendingInLock];yield Promise.all(r),this.pendingInLock.splice(0,r.length)}return yield i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}})}_useSession(t){return g(this,null,function*(){this._debug("#_useSession","begin");try{const e=yield this.__loadSession();return yield t(e)}finally{this._debug("#_useSession","end")}})}__loadSession(){return g(this,null,function*(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const e=yield Nt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",e),e!==null&&(this._isValidSession(e)?t=e:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession())),!t)return{data:{session:null},error:null};const i=t.expires_at?t.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",t.expires_at),!i){if(this.storage.isServer){let a=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,h,c)=>(!a&&h==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,h,c))})}return{data:{session:t},error:null}}const{session:r,error:s}=yield this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}})}getUser(t){return g(this,null,function*(){return t?yield this._getUser(t):(yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){return yield this._getUser()})))})}_getUser(t){return g(this,null,function*(){try{return t?yield L(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ae}):yield this._useSession(e=>g(this,null,function*(){var i,r,s;const{data:a,error:o}=e;if(o)throw o;return!(!((i=a.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new De}:yield L(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0,xform:Ae})}))}catch(e){if(x(e))return vl(e)&&(yield this._removeSession(),yield Ft(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}})}updateUser(i){return g(this,arguments,function*(t,e={}){return yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){return yield this._updateUser(t,e)}))})}_updateUser(i){return g(this,arguments,function*(t,e={}){try{return yield this._useSession(r=>g(this,null,function*(){const{data:s,error:a}=r;if(a)throw a;if(!s.session)throw new De;const o=s.session;let l=null,h=null;this.flowType==="pkce"&&t.email!=null&&([l,h]=yield et(this.storage,this.storageKey));const{data:c,error:f}=yield L(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e==null?void 0:e.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:h}),jwt:o.access_token,xform:Ae});if(f)throw f;return o.user=c.user,yield this._saveSession(o),yield this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}}))}catch(r){if(x(r))return{data:{user:null},error:r};throw r}})}_decodeJWT(t){return nr(t)}setSession(t){return g(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){return yield this._setSession(t)}))})}_setSession(t){return g(this,null,function*(){try{if(!t.access_token||!t.refresh_token)throw new De;const e=Date.now()/1e3;let i=e,r=!0,s=null;const a=nr(t.access_token);if(a.exp&&(i=a.exp,r=i<=e),r){const{session:o,error:l}=yield this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=yield this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:i-e,expires_at:i},yield this._saveSession(s),yield this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(e){if(x(e))return{data:{session:null,user:null},error:e};throw e}})}refreshSession(t){return g(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){return yield this._refreshSession(t)}))})}_refreshSession(t){return g(this,null,function*(){try{return yield this._useSession(e=>g(this,null,function*(){var i;if(!t){const{data:a,error:o}=e;if(o)throw o;t=(i=a.session)!==null&&i!==void 0?i:void 0}if(!(t!=null&&t.refresh_token))throw new De;const{session:r,error:s}=yield this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}))}catch(e){if(x(e))return{data:{user:null,session:null},error:e};throw e}})}_getSessionFromURL(t){return g(this,null,function*(){try{if(!pe())throw new Ht("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Ht("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!t)throw new rr("Not a valid PKCE flow url.");const e=Dn(window.location.href);if(t){if(!e.code)throw new rr("No code detected.");const{data:j,error:R}=yield this._exchangeCodeForSession(e.code);if(R)throw R;const $=new URL(window.location.href);return $.searchParams.delete("code"),window.history.replaceState(window.history.state,"",$.toString()),{data:{session:j.session,redirectType:null},error:null}}if(e.error||e.error_description||e.error_code)throw new Ht(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});const{provider_token:i,provider_refresh_token:r,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:h}=e;if(!s||!o||!a||!h)throw new Ht("No session defined in URL");const c=Math.round(Date.now()/1e3),f=parseInt(o);let m=c+f;l&&(m=parseInt(l));const y=m-c;y*1e3<=pt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${f}s`);const b=m-f;c-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,m,c):c-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,m,c);const{data:_,error:C}=yield this._getUser(s);if(C)throw C;const T={provider_token:i,provider_refresh_token:r,access_token:s,expires_in:f,expires_at:m,refresh_token:a,token_type:h,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:T,redirectType:e.type},error:null}}catch(e){if(x(e))return{data:{session:null,redirectType:null},error:e};throw e}})}_isImplicitGrantFlow(){const t=Dn(window.location.href);return!!(pe()&&(t.access_token||t.error_description))}_isPKCEFlow(){return g(this,null,function*(){const t=Dn(window.location.href),e=yield Nt(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&e)})}signOut(){return g(this,arguments,function*(t={scope:"global"}){return yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){return yield this._signOut(t)}))})}_signOut(){return g(this,arguments,function*({scope:t}={scope:"global"}){return yield this._useSession(e=>g(this,null,function*(){var i;const{data:r,error:s}=e;if(s)return{error:s};const a=(i=r.session)===null||i===void 0?void 0:i.access_token;if(a){const{error:o}=yield this.admin.signOut(a,t);if(o&&!(gl(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(yield this._removeSession(),yield Ft(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))})}onAuthStateChange(t){const e=il(),i={id:e,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",e),this.stateChangeEmitters.delete(e)}};return this._debug("#onAuthStateChange()","registered callback with id",e),this.stateChangeEmitters.set(e,i),g(this,null,function*(){yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){this._emitInitialSession(e)}))}),{data:{subscription:i}}}_emitInitialSession(t){return g(this,null,function*(){return yield this._useSession(e=>g(this,null,function*(){var i,r;try{const{data:{session:s},error:a}=e;if(a)throw a;yield(i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",s),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){yield(r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}}))})}resetPasswordForEmail(i){return g(this,arguments,function*(t,e={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=yield et(this.storage,this.storageKey,!0));try{return yield L(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(a){if(x(a))return{data:null,error:a};throw a}})}getUserIdentities(){return g(this,null,function*(){var t;try{const{data:e,error:i}=yield this.getUser();if(i)throw i;return{data:{identities:(t=e.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(e){if(x(e))return{data:null,error:e};throw e}})}linkIdentity(t){return g(this,null,function*(){var e;try{const{data:i,error:r}=yield this._useSession(s=>g(this,null,function*(){var a,o,l,h,c;const{data:f,error:m}=s;if(m)throw m;const y=yield this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return yield L(this.fetch,"GET",y,{headers:this.headers,jwt:(c=(h=f.session)===null||h===void 0?void 0:h.access_token)!==null&&c!==void 0?c:void 0})}));if(r)throw r;return pe()&&!(!((e=t.options)===null||e===void 0)&&e.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),{data:{provider:t.provider,url:i==null?void 0:i.url},error:null}}catch(i){if(x(i))return{data:{provider:t.provider,url:null},error:i};throw i}})}unlinkIdentity(t){return g(this,null,function*(){try{return yield this._useSession(e=>g(this,null,function*(){var i,r;const{data:s,error:a}=e;if(a)throw a;return yield L(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(r=(i=s.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0})}))}catch(e){if(x(e))return{data:null,error:e};throw e}})}_refreshAccessToken(t){return g(this,null,function*(){const e=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(e,"begin");try{const i=Date.now();return yield ol(r=>g(this,null,function*(){return r>0&&(yield al(200*Math.pow(2,r-1))),this._debug(e,"refreshing attempt",r),yield L(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ie})}),(r,s)=>{const a=200*Math.pow(2,r);return s&&xn(s)&&Date.now()+a-i<pt})}catch(i){if(this._debug(e,"error",i),x(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(e,"end")}})}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}_handleProviderSignIn(t,e){return g(this,null,function*(){const i=yield this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",e,"url",i),pe()&&!e.skipBrowserRedirect&&window.location.assign(i),{data:{provider:t,url:i},error:null}})}_recoverAndRefresh(){return g(this,null,function*(){var t;const e="#_recoverAndRefresh()";this._debug(e,"begin");try{const i=yield Nt(this.storage,this.storageKey);if(this._debug(e,"session from storage",i),!this._isValidSession(i)){this._debug(e,"session is not valid"),i!==null&&(yield this._removeSession());return}const r=Math.round(Date.now()/1e3),s=((t=i.expires_at)!==null&&t!==void 0?t:1/0)<r+Xi;if(this._debug(e,`session has${s?"":" not"} expired with margin of ${Xi}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=yield this._callRefreshToken(i.refresh_token);a&&(console.error(a),xn(a)||(this._debug(e,"refresh failed with a non-retryable error, removing the session",a),yield this._removeSession()))}}else yield this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(e,"error",i),console.error(i);return}finally{this._debug(e,"end")}})}_callRefreshToken(t){return g(this,null,function*(){var e,i;if(!t)throw new De;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new $t;const{data:s,error:a}=yield this._refreshAccessToken(t);if(a)throw a;if(!s.session)throw new De;yield this._saveSession(s.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(r,"error",s),x(s)){const a={session:null,error:s};return xn(s)||(yield this._removeSession()),(e=this.refreshingDeferred)===null||e===void 0||e.resolve(a),a}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(s),s}finally{this.refreshingDeferred=null,this._debug(r,"end")}})}_notifyAllSubscribers(t,e,i=!0){return g(this,null,function*(){const r=`#_notifyAllSubscribers(${t})`;this._debug(r,"begin",e,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:t,session:e});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(o=>g(this,null,function*(){try{yield o.callback(t,e)}catch(l){s.push(l)}}));if(yield Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(r,"end")}})}_saveSession(t){return g(this,null,function*(){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,yield tr(this.storage,this.storageKey,t)})}_removeSession(){return g(this,null,function*(){this._debug("#_removeSession()"),yield Ft(this.storage,this.storageKey),yield this._notifyAllSubscribers("SIGNED_OUT",null)})}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&pe()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(e){console.error("removing visibilitychange callback failed",e)}}_startAutoRefresh(){return g(this,null,function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),pt);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno!="undefined"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(()=>g(this,null,function*(){yield this.initializePromise,yield this._autoRefreshTokenTick()}),0)})}_stopAutoRefresh(){return g(this,null,function*(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)})}startAutoRefresh(){return g(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return g(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return g(this,null,function*(){this._debug("#_autoRefreshTokenTick()","begin");try{yield this._acquireLock(0,()=>g(this,null,function*(){try{const t=Date.now();try{return yield this._useSession(e=>g(this,null,function*(){const{data:{session:i}}=e;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((i.expires_at*1e3-t)/pt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${pt}ms, refresh threshold is ${ur} ticks`),r<=ur&&(yield this._callRefreshToken(i.refresh_token))}))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(t){if(t.isAcquireTimeout||t instanceof cr)this._debug("auto refresh token tick lock not available");else throw t}})}_handleVisibilityChange(){return g(this,null,function*(){if(this._debug("#_handleVisibilityChange()"),!pe()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>g(this,null,function*(){return yield this._onVisibilityChanged(!1)}),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}})}_onVisibilityChanged(t){return g(this,null,function*(){const e=`#_onVisibilityChanged(${t})`;this._debug(e,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){if(document.visibilityState!=="visible"){this._debug(e,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}yield this._recoverAndRefresh()})))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(t,e,i){return g(this,null,function*(){const r=[`provider=${encodeURIComponent(e)}`];if(i!=null&&i.redirectTo&&r.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&r.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[s,a]=yield et(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});r.push(o.toString())}if(i!=null&&i.queryParams){const s=new URLSearchParams(i.queryParams);r.push(s.toString())}return i!=null&&i.skipBrowserRedirect&&r.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${t}?${r.join("&")}`})}_unenroll(t){return g(this,null,function*(){try{return yield this._useSession(e=>g(this,null,function*(){var i;const{data:r,error:s}=e;return s?{data:null,error:s}:yield L(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})}))}catch(e){if(x(e))return{data:null,error:e};throw e}})}_enroll(t){return g(this,null,function*(){try{return yield this._useSession(e=>g(this,null,function*(){var i,r;const{data:s,error:a}=e;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:h}=yield L(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(i=s==null?void 0:s.session)===null||i===void 0?void 0:i.access_token});return h?{data:null,error:h}:(t.factorType==="totp"&&(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})}))}catch(e){if(x(e))return{data:null,error:e};throw e}})}_verify(t){return g(this,null,function*(){return this._acquireLock(-1,()=>g(this,null,function*(){try{return yield this._useSession(e=>g(this,null,function*(){var i;const{data:r,error:s}=e;if(s)return{data:null,error:s};const{data:a,error:o}=yield L(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token});return o?{data:null,error:o}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})}))}catch(e){if(x(e))return{data:null,error:e};throw e}}))})}_challenge(t){return g(this,null,function*(){return this._acquireLock(-1,()=>g(this,null,function*(){try{return yield this._useSession(e=>g(this,null,function*(){var i;const{data:r,error:s}=e;return s?{data:null,error:s}:yield L(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})}))}catch(e){if(x(e))return{data:null,error:e};throw e}}))})}_challengeAndVerify(t){return g(this,null,function*(){const{data:e,error:i}=yield this._challenge({factorId:t.factorId});return i?{data:null,error:i}:yield this._verify({factorId:t.factorId,challengeId:e.id,code:t.code})})}_listFactors(){return g(this,null,function*(){const{data:{user:t},error:e}=yield this.getUser();if(e)return{data:null,error:e};const i=(t==null?void 0:t.factors)||[],r=i.filter(a=>a.factor_type==="totp"&&a.status==="verified"),s=i.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:i,totp:r,phone:s},error:null}})}_getAuthenticatorAssuranceLevel(){return g(this,null,function*(){return this._acquireLock(-1,()=>g(this,null,function*(){return yield this._useSession(t=>g(this,null,function*(){var e,i;const{data:{session:r},error:s}=t;if(s)return{data:null,error:s};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(r.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((i=(e=r.user.factors)===null||e===void 0?void 0:e.filter(f=>f.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(l="aal2");const c=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}))})}}mt.nextInstanceID=0;const Ml=mt;class Ll extends Ml{constructor(t){super(t)}}var jl=globalThis&&globalThis.__awaiter||function(n,t,e,i){function r(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(c){try{h(i.next(c))}catch(f){a(f)}}function l(c){try{h(i.throw(c))}catch(f){a(f)}}function h(c){c.done?s(c.value):r(c.value).then(o,l)}h((i=i.apply(n,t||[])).next())})};class Rl{constructor(t,e,i){var r,s,a;if(this.supabaseUrl=t,this.supabaseKey=e,!t)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");const o=Qo(t);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,h={db:qo,realtime:Wo,auth:Object.assign(Object.assign({},Ko),{storageKey:l}),global:Bo},c=Xo(i!=null?i:{},h);this.storageKey=(r=c.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(s=c.global.headers)!==null&&s!==void 0?s:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(f,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=c.auth)!==null&&a!==void 0?a:{},this.headers,c.global.fetch),this.fetch=zo(e,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},c.realtime)),this.rest=new fo(`${o}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),c.accessToken||this._listenForAuthEvents()}get functions(){return new Ua(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Uo(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},i={}){return this.rest.rpc(t,e,i)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,e;return jl(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:i}=yield this.auth.getSession();return(e=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:i,storage:r,storageKey:s,flowType:a,lock:o,debug:l},h,c){var f;const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Ll({url:this.authUrl,headers:Object.assign(Object.assign({},m),h),storageKey:s,autoRefreshToken:t,persistSession:e,detectSessionInUrl:i,storage:r,flowType:a,lock:o,debug:l,fetch:c,hasCustomAuthorizationHeader:(f="Authorization"in this.headers)!==null&&f!==void 0?f:!1})}_initRealtimeClient(t){return new Do(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,i)=>{this._handleTokenChanged(e,"CLIENT",i==null?void 0:i.access_token)})}_handleTokenChanged(t,e,i){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==i?(this.realtime.setAuth(i!=null?i:null),this.changedAccessToken=i):t==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Nl=(n,t,e)=>new Rl(n,t,e),Fl="https://fsymfimuqnfpnkljsczl.supabase.co",Pn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZzeW1maW11cW5mcG5rbGpzY3psIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczMjA0MzcwMSwiZXhwIjoyMDQ3NjE5NzAxfQ.HS09LwonCcgmMR79OK02CIP3dod2jSWWhKlm2amtbNk",Mn=Nl(Fl,Pn,{auth:{autoRefreshToken:!0,persistSession:!0},global:{headers:{apikey:Pn,Authorization:`Bearer ${Pn}`}}});class $l{createBooking(t){return g(this,null,function*(){try{const{data:e,error:i}=yield Mn.from("bookings").insert([t]).select();if(i)throw i;return e[0]}catch(e){throw console.error("Error creating booking:",e),e}})}getBooking(t){return g(this,null,function*(){try{const{data:e,error:i}=yield Mn.from("bookings").select("*").eq("id",t).single();if(i)throw i;return e}catch(e){throw console.error("Error fetching booking:",e),e}})}checkVehicleAvailability(t,e,i){return g(this,null,function*(){try{const r=new Date(e).toISOString(),s=new Date(i).toISOString(),{data:a,error:o}=yield Mn.from("bookings").select("*").eq("vehicle_id",t).neq("status","cancelled").or(`pickup_date.lte.${s},return_date.gte.${r}`);if(o)throw o;return a.length===0}catch(r){throw console.error("Error checking availability:",r),r}})}}const Ul=new $l,Hl=()=>g(this,null,function*(){try{const n=document.querySelector("#booking_form");if(!n)throw new Error("Booking form not found");n.classList.add("loading"),yield xa(),yield Promise.all([Nr(),Br(),$r(),Vr()]),Bl(),St(),n.classList.remove("loading")}catch(n){console.error("Error initializing booking form:",n),Ln("There was an error loading the booking form. Please refresh the page.")}}),Bl=()=>{const n=document.querySelector("#wf-form-Booking-form");n&&n.addEventListener("submit",t=>g(this,null,function*(){t.preventDefault();try{if(n.classList.add("submitting"),!Kl(n))throw new Error("Please fill in all required fields");const e=new FormData(n);yield ql(e),dr("Booking submitted successfully!")}catch(e){console.error("Form submission error:",e),Ln(e.message)}finally{n.classList.remove("submitting")}}))},ql=n=>g(this,null,function*(){try{const t={email_address:n.get("email-address"),pickup_date:new Date(n.get("pickup-date")).toISOString(),return_date:new Date(n.get("return-date")).toISOString(),pickup_location:n.get("pickup-location"),return_location:n.get("return-location"),vehicle_id:n.get("vehicle"),nad_45000_excess_waiver:n.get("NAD-45-000.00-Excess-Waiver")==="true",tyre_glass_waiver:n.get("Tyre-Glass-Waiver")==="true",cross_border_charge:n.get("Cross-Border-Charge")==="true",satellite_phone_high_excess:n.get("Satellite-Phone-N-6000-Excess")==="true",satellite_phone_zero_excess:n.get("Satellite-Phone-Zero-Excess")==="true",camping_equipment_double_cab:n.get("Camping-Equipment---Double-Cab")==="true",roof_tents_required:n.get("Roof-Tents-Required")==="true",engel_fridge_freezer:n.get("Engel-40L-Fridge-Freezer")==="true",bedding:n.get("Bedding-incl.-1x-sleeping-bag-1x-pillow")==="true",gps_system:n.get("GPS-System")==="true",sat_phone_minutes:parseInt(n.get("SAT-Phone-Minutes")||"0"),kitchen_wash_up_kit:n.get("Kitchen-wash-up-kit-small-dish-wash-liquid-2x-drying-cloth-2x-sponge-2x-cleaning-cloth-extras")==="true",ground_tent:n.get("Ground-Tent")==="true",jerry_can:n.get("Jerry-Can")==="true",baby_seat:n.get("Baby-Seat")==="true",first_name:n.get("first-name"),last_name:n.get("last-name"),phone_number:n.get("phone-number"),street_address:n.get("street-address"),city:n.get("city"),street:n.get("street"),zip:n.get("zip"),country:n.get("country"),date_of_birth:n.get("date-of-birth"),number_of_people:parseInt(n.get("number-of-people")||"0"),passport_number:n.get("passport-number"),expiration_date:n.get("expiration-date"),driver_license:n.get("driver-license"),total_amount:parseFloat(document.querySelector("#v-calc-total").textContent),currency:document.querySelector('input[name="currency-group"]:checked').value},e=yield Ul.createBooking(t);return console.log("Booking created:",e),dr("Booking submitted successfully!"),e}catch(t){throw console.error("Error submitting form:",t),Ln(t.message),t}}),Kl=n=>{const t=n.querySelectorAll("[required]");return Array.from(t).every(e=>e.value.trim()!=="")},Ln=n=>{const t=document.querySelector(".error-alert-bg");t&&(t.querySelector(".error-alert-text").textContent=n,t.classList.remove("is-hidden"),setTimeout(()=>t.classList.add("is-hidden"),5e3))},dr=n=>{const t=document.querySelector(".success-alert-bg");t&&(t.querySelector(".success-alert-text").textContent=n,t.classList.remove("is-hidden"),setTimeout(()=>t.classList.add("is-hidden"),5e3))};Hl();var fr=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")};const Wl=re({__proto__:null,default:Ha(fr)},[fr])})();
//# sourceMappingURL=index.js.map
